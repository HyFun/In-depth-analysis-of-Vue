<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶ | æ·±å…¥å‰–æVueæºç </title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/blog-vue-source/æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶ | æ·±å…¥å‰–æVueæºç "><meta data-react-helmet="true" name="description" content="è¿™ä¸ªç³»åˆ—è®²åˆ°è¿™é‡Œï¼ŒVueåŸºæœ¬æ ¸å¿ƒçš„ä¸œè¥¿å·²ç»åˆ†æå®Œï¼Œä½†æ˜¯Vueä¹‹æ‰€ä»¥å¼ºå¤§ï¼Œç¦»ä¸å¼€å®ƒæä¾›ç»™ç”¨æˆ·çš„ä¸€äº›å®ç”¨åŠŸèƒ½ï¼Œå¼€å‘è€…å¯ä»¥æ›´åå‘äºä¸šåŠ¡é€»è¾‘è€ŒéåŸºæœ¬åŠŸèƒ½çš„å®ç°ã€‚ä¾‹å¦‚ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å°†`@click=*`ç”¨å¾—é£èµ·ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯å¦æ€è€ƒï¼ŒVueå¦‚ä½•åœ¨åé¢ä¸ºæˆ‘ä»¬çš„æ¨¡æ¿åšäº‹ä»¶ç›¸å…³çš„å¤„ç†ï¼Œå¹¶ä¸”æˆ‘ä»¬ç»å¸¸åˆ©ç”¨ç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶å»å®ç°çˆ¶å­é—´çš„é€šä¿¡ï¼Œé‚£è¿™ä¸ªäº‹ä»¶å’Œå’ŒåŸç”Ÿdomäº‹ä»¶åˆæœ‰ä¸åŒçš„åœ°æ–¹å—ï¼Œèƒ½å¤Ÿå®ç°é€šä¿¡çš„åŸç†åˆæ˜¯ä»€ä¹ˆï¼Œå¸¦ç€ç–‘æƒ‘ï¼Œæˆ‘ä»¬æ·±å…¥æºç å±•å¼€åˆ†æã€‚"><meta data-react-helmet="true" property="og:description" content="è¿™ä¸ªç³»åˆ—è®²åˆ°è¿™é‡Œï¼ŒVueåŸºæœ¬æ ¸å¿ƒçš„ä¸œè¥¿å·²ç»åˆ†æå®Œï¼Œä½†æ˜¯Vueä¹‹æ‰€ä»¥å¼ºå¤§ï¼Œç¦»ä¸å¼€å®ƒæä¾›ç»™ç”¨æˆ·çš„ä¸€äº›å®ç”¨åŠŸèƒ½ï¼Œå¼€å‘è€…å¯ä»¥æ›´åå‘äºä¸šåŠ¡é€»è¾‘è€ŒéåŸºæœ¬åŠŸèƒ½çš„å®ç°ã€‚ä¾‹å¦‚ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å°†`@click=*`ç”¨å¾—é£èµ·ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯å¦æ€è€ƒï¼ŒVueå¦‚ä½•åœ¨åé¢ä¸ºæˆ‘ä»¬çš„æ¨¡æ¿åšäº‹ä»¶ç›¸å…³çš„å¤„ç†ï¼Œå¹¶ä¸”æˆ‘ä»¬ç»å¸¸åˆ©ç”¨ç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶å»å®ç°çˆ¶å­é—´çš„é€šä¿¡ï¼Œé‚£è¿™ä¸ªäº‹ä»¶å’Œå’ŒåŸç”Ÿdomäº‹ä»¶åˆæœ‰ä¸åŒçš„åœ°æ–¹å—ï¼Œèƒ½å¤Ÿå®ç°é€šä¿¡çš„åŸç†åˆæ˜¯ä»€ä¹ˆï¼Œå¸¦ç€ç–‘æƒ‘ï¼Œæˆ‘ä»¬æ·±å…¥æºç å±•å¼€åˆ†æã€‚"><link data-react-helmet="true" rel="shortcut icon" href="/blog-vue-source/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/blog-vue-source/æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/blog-vue-source/æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/blog-vue-source/æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶" hreflang="x-default"><link rel="stylesheet" href="/blog-vue-source/assets/css/styles.6d09dbb1.css">
<link rel="preload" href="/blog-vue-source/assets/js/runtime~main.0ee6c1f0.js" as="script">
<link rel="preload" href="/blog-vue-source/assets/js/main.d722cc53.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/blog-vue-source/"><img src="/blog-vue-source/img/logo.svg" alt="æ·±å…¥å‰–æVueæºç " class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/blog-vue-source/img/logo.svg" alt="æ·±å…¥å‰–æVueæºç " class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">æ·±å…¥å‰–æVueæºç </b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Ocean1509/In-depth-analysis-of-Vue" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ç›®å½•">ç›®å½•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ä¸°å¯Œçš„é€‰é¡¹åˆå¹¶ç­–ç•¥">ä¸°å¯Œçš„é€‰é¡¹åˆå¹¶ç­–ç•¥</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/åŸºç¡€çš„æ•°æ®ä»£ç†æ£€æµ‹">åŸºç¡€çš„æ•°æ®ä»£ç†æ£€æµ‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/å®ä¾‹æŒ‚è½½æµç¨‹å’Œæ¨¡æ¿ç¼–è¯‘">å®ä¾‹æŒ‚è½½æµç¨‹å’Œæ¨¡æ¿ç¼–è¯‘</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/å®Œæ•´æ¸²æŸ“æµç¨‹">å®Œæ•´æ¸²æŸ“æµç¨‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ç»„ä»¶åŸºç¡€å‰–æ">ç»„ä»¶åŸºç¡€å‰–æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ç»„ä»¶é«˜çº§ç”¨æ³•">ç»„ä»¶é«˜çº§ç”¨æ³•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•">æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/blog-vue-source/æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶">æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ">vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ä½ çœŸçš„äº†è§£v-modelçš„è¯­æ³•ç³–äº†å—">ä½ çœŸçš„äº†è§£v-modelçš„è¯­æ³•ç³–äº†å—</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ">åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶</h1></header><blockquote><p>è¿™ä¸ªç³»åˆ—è®²åˆ°è¿™é‡Œï¼ŒVueåŸºæœ¬æ ¸å¿ƒçš„ä¸œè¥¿å·²ç»åˆ†æå®Œï¼Œä½†æ˜¯Vueä¹‹æ‰€ä»¥å¼ºå¤§ï¼Œç¦»ä¸å¼€å®ƒæä¾›ç»™ç”¨æˆ·çš„ä¸€äº›å®ç”¨åŠŸèƒ½ï¼Œå¼€å‘è€…å¯ä»¥æ›´åå‘äºä¸šåŠ¡é€»è¾‘è€ŒéåŸºæœ¬åŠŸèƒ½çš„å®ç°ã€‚ä¾‹å¦‚ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å°†<code>@click=***</code>ç”¨å¾—é£èµ·ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯å¦æ€è€ƒï¼ŒVueå¦‚ä½•åœ¨åé¢ä¸ºæˆ‘ä»¬çš„æ¨¡æ¿åšäº‹ä»¶ç›¸å…³çš„å¤„ç†ï¼Œå¹¶ä¸”æˆ‘ä»¬ç»å¸¸åˆ©ç”¨ç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶å»å®ç°çˆ¶å­é—´çš„é€šä¿¡ï¼Œé‚£è¿™ä¸ªäº‹ä»¶å’Œå’ŒåŸç”Ÿdomäº‹ä»¶åˆæœ‰ä¸åŒçš„åœ°æ–¹å—ï¼Œèƒ½å¤Ÿå®ç°é€šä¿¡çš„åŸç†åˆæ˜¯ä»€ä¹ˆï¼Œå¸¦ç€ç–‘æƒ‘ï¼Œæˆ‘ä»¬æ·±å…¥æºç å±•å¼€åˆ†æã€‚</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="91-æ¨¡æ¿ç¼–è¯‘"></a>9.1. æ¨¡æ¿ç¼–è¯‘<a class="hash-link" href="#91-æ¨¡æ¿ç¼–è¯‘" title="Direct link to heading">#</a></h2><p><code>Vue</code>åœ¨æŒ‚è½½å®ä¾‹å‰ï¼Œæœ‰ç›¸å½“å¤šçš„å·¥ä½œæ˜¯è¿›è¡Œæ¨¡æ¿çš„ç¼–è¯‘ï¼Œå°†<code>template</code>æ¨¡æ¿è¿›è¡Œç¼–è¯‘ï¼Œè§£ææˆ<code>AST</code>æ ‘ï¼Œå†è½¬æ¢æˆ<code>render</code>å‡½æ•°ï¼Œè€Œæœ‰äº†<code>render</code>å‡½æ•°åæ‰ä¼šè¿›å…¥å®ä¾‹æŒ‚è½½è¿‡ç¨‹ã€‚å¯¹äºäº‹ä»¶è€Œè¨€ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨<code>v-on</code>æˆ–è€…<code>@</code>åœ¨æ¨¡æ¿ä¸Šç»‘å®šäº‹ä»¶ã€‚å› æ­¤å¯¹äº‹ä»¶çš„ç¬¬ä¸€æ­¥å¤„ç†ï¼Œå°±æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå¯¹äº‹ä»¶æŒ‡ä»¤åšæ”¶é›†å¤„ç†ã€‚</p><p>ä»ä¸€ä¸ªç®€å•çš„ç”¨æ³•åˆ†æç¼–è¯‘é˜¶æ®µæ”¶é›†çš„ä¿¡æ¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">app</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">v-on:</span><span class="token tag attr-name" style="color:#00a4db">click.stop</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">doThis</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">ç‚¹å‡»</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">{{count}}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    el</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;#app&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            count</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    methods</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">doThis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">++</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">count</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æˆ‘ä»¬ä¹‹å‰åœ¨å°†æ¨¡æ¿ç¼–è¯‘çš„æ—¶å€™å¤§è‡´è¯´è¿‡ç¼–è¯‘çš„æµç¨‹ï¼Œæ¨¡æ¿ç¼–è¯‘çš„å…¥å£æ˜¯åœ¨<code>var ast = parse(template.trim(), options);</code>ä¸­ï¼Œ<code>parse</code>é€šè¿‡æ‹†åˆ†æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå°†å…¶è§£æä¸ºä¸€ä¸ª<code>AST</code>æ ‘ï¼Œå…¶ä¸­å¯¹äºå±æ€§çš„å¤„ç†ï¼Œåœ¨<code>processAttr</code>ä¸­,ç”±äºåˆ†æ”¯è¾ƒå¤šï¼Œæˆ‘ä»¬åªåˆ†æä¾‹å­ä¸­çš„æµç¨‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> dirRE </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">^v-|^@|^:</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processAttrs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">el</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">attrsList</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rawName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> modifiers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> syncGen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> isDynamic</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rawName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// v-on:click</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// doThis</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dirRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// åŒ¹é…v-æˆ–è€…@å¼€å¤´çš„æŒ‡ä»¤</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hasBindings</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifiers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseModifiers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dirRE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">// parseModifiers(&#x27;on:click&#x27;)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifiers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifierRE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bindRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// v-bindåˆ†æ”¯</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// ...ç•™åˆ°v-bindæŒ‡ä»¤æ—¶åˆ†æ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">onRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// v-onåˆ†æ”¯</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">onRE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// æ‹¿åˆ°çœŸæ­£çš„äº‹ä»¶click</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          isDynamic </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dynamicArgRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">// åŠ¨æ€äº‹ä»¶ç»‘å®š</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isDynamic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">addHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> modifiers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> warn$</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> isDynamic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// normal directives</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// å…¶ä»–æŒ‡ä»¤ç›¸å…³é€»è¾‘</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>processAttrs</code>çš„é€»è¾‘è™½ç„¶è¾ƒå¤šï¼Œä½†æ˜¯ç†è§£èµ·æ¥è¾ƒä¸ºç®€å•ï¼Œ<code>var dirRE = /^v-|^@|^:/;</code>æ˜¯åŒ¹é…äº‹ä»¶ç›¸å…³çš„æ­£åˆ™ï¼Œå‘½ä¸­åŒ¹é…çš„è®°è¿‡ä¼šå¾—åˆ°äº‹ä»¶æŒ‡ä»¤ç›¸å…³å†…å®¹ï¼ŒåŒ…æ‹¬äº‹ä»¶æœ¬èº«ï¼Œäº‹ä»¶å›è°ƒä»¥åŠäº‹ä»¶ä¿®é¥°ç¬¦ã€‚æœ€ç»ˆé€šè¿‡<code>addHandler</code>æ–¹æ³•ï¼Œä¸º<code>AST</code>æ ‘æ·»åŠ äº‹ä»¶ç›¸å…³çš„å±æ€§ã€‚è€Œ<code>addHandler</code>è¿˜æœ‰ä¸€ä¸ªé‡è¦åŠŸèƒ½æ˜¯å¯¹äº‹ä»¶ä¿®é¥°ç¬¦è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// elæ˜¯å½“å‰è§£æçš„ASTæ ‘</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addHandler</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">el</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">name</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">value</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">modifiers</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">important</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">warn</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">range</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">dynamic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifiers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> modifiers </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> emptyObject</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// passive å’Œ preventä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œå¯ä»¥å‚ç…§å®˜æ–¹æ–‡æ¡£è¯´æ˜</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      warn </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prevent</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">passive</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;passive and prevent can\&#x27;t be used together. &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;Passive handler can\&#x27;t prevent default event.&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        range</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// è¿™éƒ¨åˆ†çš„é€»è¾‘ä¼šå¯¹ç‰¹æ®Šçš„ä¿®é¥°ç¬¦åšå­—ç¬¦ä¸²æ‹¼æ¥çš„å¤„ç†ï¼Œä»¥å¤‡åç»­çš„ä½¿ç”¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">right</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dynamic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)===&#x27;click&#x27;?&#x27;contextmenu&#x27;:(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;click&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;contextmenu&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">delete</span><span class="token plain"> modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">right</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">middle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dynamic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)===&#x27;click&#x27;?&#x27;mouseup&#x27;:(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;click&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;mouseup&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">capture</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">delete</span><span class="token plain"> modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">capture</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">prependModifierMarker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;!&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dynamic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">once</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">delete</span><span class="token plain"> modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">once</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">prependModifierMarker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;~&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dynamic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* istanbul ignore if */</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">passive</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">delete</span><span class="token plain"> modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">passive</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">prependModifierMarker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&amp;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dynamic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// events ç”¨æ¥è®°å½•ç»‘å®šçš„äº‹ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> events</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">native</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">delete</span><span class="token plain"> modifiers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">native</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      events </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">nativeEvents</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">nativeEvents</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      events </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">events</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">events</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> newHandler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rangeSetItem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">trim</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dynamic</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> dynamic </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> range</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifiers </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> emptyObject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      newHandler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">modifiers</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> modifiers</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> handlers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* istanbul ignore if */</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ç»‘å®šçš„äº‹ä»¶å¯ä»¥å¤šä¸ªï¼Œå›è°ƒä¹Ÿå¯ä»¥å¤šä¸ªï¼Œæœ€ç»ˆä¼šåˆå¹¶åˆ°æ•°ç»„ä¸­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handlers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      important </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> handlers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">unshift</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">newHandler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> handlers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">newHandler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handlers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> important </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">newHandler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handlers</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">handlers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> newHandler</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> newHandler</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">plain</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ä¿®é¥°ç¬¦çš„å¤„ç†ä¼šæ”¹å˜æœ€ç»ˆå­—ç¬¦ä¸²çš„æ‹¼æ¥ç»“æœï¼Œæˆ‘ä»¬çœ‹æœ€ç»ˆè½¬æ¢çš„<code>AST</code>æ ‘ï¼š</p><p><img src="/blog-vue-source/assets/images/9.1-15321cb4a1e7b8ac8d352e2ec37ffad8.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="92-ä»£ç ç”Ÿæˆ"></a>9.2. ä»£ç ç”Ÿæˆ<a class="hash-link" href="#92-ä»£ç ç”Ÿæˆ" title="Direct link to heading">#</a></h2><p>æ¨¡æ¿ç¼–è¯‘çš„æœ€åä¸€æ­¥æ˜¯æ ¹æ®è§£æå®Œçš„<code>AST</code>æ ‘ç”Ÿæˆå¯¹åº”å¹³å°çš„æ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯<code>render</code>å‡½æ•°çš„ç”Ÿæˆè¿‡ç¨‹, å¯¹åº”<code>var code = generate(ast, options);</code>ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">ast</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">CodegenState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> code </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ast </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ast</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;_c(&quot;div&quot;)&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      render</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;with(this){return &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> code </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;}&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// withå‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      staticRenderFns</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">staticRenderFns</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å…¶ä¸­æ ¸å¿ƒå¤„ç†åœ¨<code>getElement</code>ä¸­,<code>getElement</code>å‡½æ•°ä¼šæ ¹æ®ä¸åŒæŒ‡ä»¤ç±»å‹å¤„ç†ä¸åŒçš„åˆ†æ”¯ï¼Œå¯¹äºæ™®é€šæ¨¡æ¿çš„ç¼–è¯‘ä¼šè¿›å…¥<code>genData</code>å‡½æ•°ä¸­å¤„ç†ï¼ŒåŒæ ·åˆ†æåªé’ˆå¯¹äº‹ä»¶ç›¸å…³çš„å¤„ç†ï¼Œä»å‰é¢è§£æå‡ºçš„<code>AST</code>æ ‘æ˜æ˜¾çœ‹å‡ºï¼Œ<code>AST</code>æ ‘ä¸­å¤šäº†<code>events</code>çš„å±æ€§,<code>genHandlers</code>å‡½æ•°ä¼šä¸º<code>event</code>å±æ€§åšé€»è¾‘å¤„ç†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genData</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">el</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// directives first.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// directives may mutate the el&#x27;s other properties before they are generated.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> dirs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genDirectives</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dirs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> dirs </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//å…¶ä»–å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// event handlers</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">events</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      data </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">genHandlers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">events</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> data</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>genHandlers</code>çš„é€»è¾‘ï¼Œä¼šéå†è§£æå¥½çš„<code>AST</code>æ ‘ï¼Œæ‹¿åˆ°<code>event</code>å¯¹è±¡å±æ€§ï¼Œå¹¶æ ¹æ®å±æ€§ä¸Šçš„äº‹ä»¶å¯¹è±¡æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genHandlers</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">events</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">isNative</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> prefix </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> isNative </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;nativeOn:&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;on:&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> staticHandlers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> dynamicHandlers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// éå†astæ ‘è§£æå¥½çš„eventå¯¹è±¡</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> name </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> events</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//genHandleræœ¬è´¨ä¸Šæ˜¯å°†äº‹ä»¶å¯¹è±¡è½¬æ¢æˆå¯æ‹¼æ¥çš„å­—ç¬¦ä¸²</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> handlerCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dynamic</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        dynamicHandlers </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> handlerCode </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        staticHandlers </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot;:&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> handlerCode </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    staticHandlers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">staticHandlers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;}&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dynamicHandlers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> prefix </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;_d(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> staticHandlers </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,[&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dynamicHandlers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;])&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> prefix </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> staticHandlers</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// äº‹ä»¶æ¨¡æ¿ä¹¦å†™åŒ¹é…</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> isMethodPath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> simplePathRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// doThis</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> isFunctionExpression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fnExpRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// () =&gt; {} or function() {}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> isFunctionInvocation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> simplePathRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fnInvokeRE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// doThis($event)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genHandler</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;function(){}&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// äº‹ä»¶ç»‘å®šå¯ä»¥å¤šä¸ªï¼Œå¤šä¸ªåœ¨è§£æastæ ‘æ—¶ä¼šä»¥æ•°ç»„çš„å½¢å¼å­˜åœ¨ï¼Œå¦‚æœæœ‰å¤šä¸ªåˆ™ä¼šé€’å½’è°ƒç”¨getHandleræ–¹æ³•è¿”å›æ•°ç»„ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;[&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;]&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// valueï¼š doThis å¯ä»¥æœ‰ä¸‰ç§æ–¹å¼</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> isMethodPath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> simplePathRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// doThis</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> isFunctionExpression </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fnExpRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// () =&gt; {} or function() {}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> isFunctionInvocation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> simplePathRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fnInvokeRE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// doThis($event)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ²¡æœ‰ä»»ä½•ä¿®é¥°ç¬¦</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">modifiers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ç¬¦åˆå‡½æ•°å®šä¹‰è§„èŒƒï¼Œåˆ™ç›´æ¥è¿”å›è°ƒç”¨å‡½æ•°å doThis</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isMethodPath </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> isFunctionExpression</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ä¸ç¬¦åˆåˆ™é€šè¿‡functionå‡½æ•°å°è£…è¿”å›</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;function($event){&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isFunctionInvocation </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;return &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;}&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// inline statement</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// åŒ…å«ä¿®é¥°ç¬¦çš„åœºæ™¯</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ¨¡æ¿ä¸­äº‹ä»¶çš„å†™æ³•æœ‰ä¸‰ç§,åˆ†åˆ«å¯¹åº”ä¸Šè¯‰ä¸Šä¸ªæ­£åˆ™åŒ¹é…çš„å†…å®¹ã€‚</p><ol><li><code>&lt;div @click=&quot;doThis&quot;&gt;&lt;/div&gt;</code></li><li><code>&lt;div @click=&quot;doThis($event)&quot;&gt;&lt;/div&gt;</code></li><li><code>&lt;div @click=&quot;()=&gt;{}&quot;&gt;&lt;/div&gt; &lt;div @click=&quot;function(){}&quot;&gt;&lt;/div&gt;</code></li></ol><p>ä¸Šè¿°å¯¹äº‹ä»¶å¯¹è±¡çš„è½¬æ¢ï¼Œå¦‚æœäº‹ä»¶ä¸å¸¦ä»»ä½•ä¿®é¥°ç¬¦ï¼Œå¹¶ä¸”æ»¡è¶³æ­£ç¡®çš„æ¨¡æ¿å†™æ³•ï¼Œåˆ™ç›´æ¥è¿”å›è°ƒç”¨äº‹ä»¶åï¼Œå¦‚æœä¸æ»¡è¶³ï¼Œåˆ™æœ‰å¯èƒ½æ˜¯<code>&lt;div @click=&quot;console.log(11)&quot;&gt;&lt;/div&gt;</code>çš„å†™æ³•ï¼Œæ­¤æ—¶ä¼šå°è£…åˆ°<code>function($event){}</code>ä¸­ã€‚</p><p>åŒ…å«ä¿®é¥°ç¬¦çš„åœºæ™¯è¾ƒå¤šï¼Œæˆ‘ä»¬å•ç‹¬åˆ—å‡ºåˆ†æã€‚ä»¥ä¸Šæ–‡ä¸­çš„ä¾‹å­è¯´æ˜ï¼Œ<code>modifiers: { stop: true }</code>ä¼šæ‹¿åˆ°<code>stop</code>å¯¹åº”éœ€è¦æ·»åŠ çš„é€»è¾‘è„šæœ¬<code>&#x27;$event.stopPropagation();&#x27;</code>,å¹¶å°†å®ƒæ·»åŠ åˆ°å‡½æ•°å­—ç¬¦ä¸²ä¸­è¿”å›ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Â·Â·Â·</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> code </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> genModifierCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// éå†modifiersä¸Šè®°å½•çš„ä¿®é¥°ç¬¦</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> key </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">modifiers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modifierCode</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// æ ¹æ®ä¿®é¥°ç¬¦æ·»åŠ å¯¹åº”jsçš„ä»£ç </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        genModifierCode </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> modifierCode</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// left/right</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keyCodes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// é’ˆå¯¹exactçš„å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;exact&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> modifiers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">modifiers</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        genModifierCode </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genGuard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;ctrl&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;shift&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;alt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;meta&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">keyModifier</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">modifiers</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">keyModifier</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">keyModifier</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;$event.&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> keyModifier </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Key&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;||&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      code </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genKeyFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Make sure modifiers like prevent and stop get executed after key filtering</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">genModifierCode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      code </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> genModifierCode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ ¹æ®ä¸‰ç§ä¸åŒçš„ä¹¦å†™æ¨¡æ¿è¿”å›ä¸åŒçš„å­—ç¬¦ä¸²</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> handlerCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> isMethodPath</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;return &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;($event)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> isFunctionExpression</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;return (&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)($event)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> isFunctionInvocation</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;return &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;function($event){&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> code </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> handlerCode </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;}&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> modifierCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  stop</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$event.stopPropagation();&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  prevent</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$event.preventDefault();&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  self</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genGuard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;$event.target !== $event.currentTarget&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ctrl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genGuard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;!$event.ctrlKey&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  shift</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genGuard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;!$event.shiftKey&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  alt</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genGuard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;!$event.altKey&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  meta</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genGuard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;!$event.metaKey&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  left</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genGuard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&#x27;button&#x27; in $event &amp;&amp; $event.button !== 0&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  middle</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genGuard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&#x27;button&#x27; in $event &amp;&amp; $event.button !== 1&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  right</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genGuard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&#x27;button&#x27; in $event &amp;&amp; $event.button !== 2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç»è¿‡è¿™ä¸€è½¬æ¢åï¼Œç”Ÿæˆ<code>with</code>å°è£…çš„<code>render</code>å‡½æ•°å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;_c(&#x27;div&#x27;,{attrs:{&quot;</span><span class="token plain">id</span><span class="token string" style="color:#e3116c">&quot;:&quot;</span><span class="token plain">app</span><span class="token string" style="color:#e3116c">&quot;}},[_c(&#x27;div&#x27;,{on:{&quot;</span><span class="token plain">click</span><span class="token string" style="color:#e3116c">&quot;:function($event){$event.stopPropagation();return doThis($event)}}},[_v(&quot;</span><span class="token plain">ç‚¹å‡»</span><span class="token string" style="color:#e3116c">&quot;)]),_v(&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;),_c(&#x27;span&#x27;,[_v(_s(count))])])&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="93-äº‹ä»¶ç»‘å®š"></a>9.3. äº‹ä»¶ç»‘å®š<a class="hash-link" href="#93-äº‹ä»¶ç»‘å®š" title="Direct link to heading">#</a></h2><p>å‰é¢èŠ±äº†å¤§é‡çš„ç¯‡å¹…ä»‹ç»äº†æ¨¡æ¿ä¸Šçš„äº‹ä»¶æ ‡è®°åœ¨æ„å»º<code>AST</code>æ ‘ä¸Šæ˜¯æ€ä¹ˆå¤„ç†ï¼Œå¹¶ä¸”å¦‚ä½•æ ¹æ®æ„å»ºçš„<code>AST</code>æ ‘è¿”å›æ­£ç¡®çš„<code>render</code>æ¸²æŸ“å‡½æ•°ï¼Œ<strong>ä½†æ˜¯çœŸæ­£äº‹ä»¶ç»‘å®šè¿˜æ˜¯ç¦»ä¸å¼€ç»‘å®šæ³¨å†Œäº‹ä»¶</strong>ã€‚è¿™ä¸€ä¸ªé˜¶æ®µå°±æ˜¯å‘ç”Ÿåœ¨ç»„ä»¶æŒ‚è½½çš„é˜¶æ®µã€‚
æœ‰äº†<code>render</code>å‡½æ•°ï¼Œè‡ªç„¶å¯ä»¥ç”Ÿæˆå®ä¾‹æŒ‚è½½éœ€è¦çš„<code>Vnode</code>æ ‘ï¼Œå¹¶ä¸”ä¼šè¿›è¡Œ<code>patchVnode</code>çš„ç¯èŠ‚è¿›è¡ŒçœŸå®èŠ‚ç‚¹çš„æ„å»ºï¼Œå¦‚æœå‘ç°è¿‡ç¨‹å·²ç»é—å¿˜ï¼Œå¯ä»¥å›é¡¾ä»¥å¾€ç« èŠ‚ã€‚
<code>Vnode</code>æ ‘çš„æ„å»ºè¿‡ç¨‹å’Œä¹‹å‰ä»‹ç»çš„å†…å®¹æ²¡æœ‰æ˜æ˜¾çš„åŒºåˆ«ï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹å°±ä¸åšèµ˜è¿°ï¼Œæœ€ç»ˆç”Ÿæˆçš„<code>vnode</code>å¦‚ä¸‹ï¼š</p><p><img src="/blog-vue-source/assets/images/9.2-5c62bc66bc4973899ad63a18a91ce2e1.png"></p><p>æœ‰äº†<code>Vnode</code>,æ¥ä¸‹æ¥ä¼šéå†å­èŠ‚ç‚¹é€’å½’è°ƒç”¨<code>createElm</code>ä¸ºæ¯ä¸ªå­èŠ‚ç‚¹åˆ›å»ºçœŸå®çš„<code>DOM</code>,ç”±äº<code>Vnode</code>ä¸­æœ‰<code>data</code>å±æ€§ï¼Œåœ¨åˆ›å»ºçœŸå®<code>DOM</code>æ—¶ä¼šè¿›è¡Œæ³¨å†Œç›¸å…³é’©å­çš„è¿‡ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªå°±æ˜¯æ³¨å†Œäº‹ä»¶ç›¸å…³å¤„ç†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createElm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// é’ˆå¯¹æŒ‡ä»¤çš„å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">invokeCreateHooks</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invokeCreateHooks</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> cbs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">create</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">++</span><span class="token plain">i$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    cbs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">create</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">emptyNode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hook</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Reuse variable</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">create</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">emptyNode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">insert</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> events </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  create</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> updateDOMListeners</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  update</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> updateDOMListeners</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æˆ‘ä»¬ç»å¸¸ä¼šåœ¨<code>template</code>æ¨¡æ¿ä¸­å®šä¹‰<code>v-on</code>äº‹ä»¶ï¼Œ<code>v-bind</code>åŠ¨æ€å±æ€§ï¼Œ<code>v-text</code>åŠ¨æ€æŒ‡ä»¤ç­‰ï¼Œå’Œ<code>v-on</code>äº‹ä»¶æŒ‡ä»¤ä¸€æ ·ï¼Œä»–ä»¬éƒ½ä¼šåœ¨ç¼–è¯‘é˜¶æ®µå’Œ<code>Vnode</code>ç”Ÿæˆé˜¶æ®µåˆ›å»º<code>data</code>å±æ€§ï¼Œå› æ­¤<code>invokeCreateHooks</code>å°±æ˜¯ä¸€ä¸ªæ¨¡æ¿æŒ‡ä»¤å¤„ç†çš„ä»»åŠ¡ï¼Œä»–åˆ†åˆ«é’ˆå¯¹ä¸åŒçš„æŒ‡ä»¤ä¸ºçœŸå®é˜¶æ®µåˆ›å»ºä¸åŒçš„ä»»åŠ¡ã€‚é’ˆå¯¹äº‹ä»¶ï¼Œè¿™é‡Œä¼šè°ƒç”¨<code>updateDOMListeners</code>å¯¹çœŸå®çš„<code>DOM</code>èŠ‚ç‚¹æ³¨å†Œäº‹ä»¶ä»»åŠ¡ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateDOMListeners</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">oldVnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// onæ˜¯äº‹ä»¶æŒ‡ä»¤çš„æ ‡å¿—</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isUndef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oldVnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">on</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isUndef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">on</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ–°æ—§èŠ‚ç‚¹ä¸åŒçš„äº‹ä»¶ç»‘å®šè§£ç»‘</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> on </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">on</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> oldOn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> oldVnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">on</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ‹¿åˆ°éœ€è¦æ·»åŠ äº‹ä»¶çš„çœŸå®DOMèŠ‚ç‚¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  target$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">elm</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// normalizeEventsæ˜¯å¯¹äº‹ä»¶å…¼å®¹æ€§çš„å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">normalizeEvents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">on</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">updateListeners</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">on</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> oldOn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> add$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> remove$</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> createOnceHandler$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  target$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å…¶ä¸­<code>normalizeEvents</code>æ˜¯é’ˆå¯¹<code>v-model</code>çš„å¤„ç†,ä¾‹å¦‚åœ¨IEä¸‹ä¸æ”¯æŒ<code>change</code>äº‹ä»¶ï¼Œåªèƒ½ç”¨<code>input</code>äº‹ä»¶ä»£æ›¿ã€‚</p><p><code>updateListeners</code>çš„é€»è¾‘ä¹Ÿå¾ˆç®€å•ï¼Œå®ƒä¼šéå†<code>on</code>äº‹ä»¶å¯¹æ–°èŠ‚ç‚¹äº‹ä»¶ç»‘å®šæ³¨å†Œäº‹ä»¶ï¼Œå¯¹æ—§èŠ‚ç‚¹ç§»é™¤äº‹ä»¶ç›‘å¬ï¼Œå®ƒå³è¦å¤„ç†åŸç”Ÿ<code>DOM</code>äº‹ä»¶çš„æ·»åŠ å’Œç§»é™¤ï¼Œä¹Ÿè¦å¤„ç†è‡ªå®šä¹‰äº‹ä»¶çš„æ·»åŠ å’Œç§»é™¤ï¼Œå…³äºè‡ªå®šä¹‰äº‹ä»¶ï¼Œåç»­å†…å®¹å†åˆ†æã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateListeners</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">on</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">oldOn</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">add</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">remove###</span><span class="token parameter number" style="color:#36acaa">1</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">createOnceHandler</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> def###</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cur</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> old</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// éå†äº‹ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> on</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      def###</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cur </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> on</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      old </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> oldOn</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      event </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">normalizeEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isUndef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cur</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// äº‹ä»¶åéæ³•çš„æŠ¥é”™å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;Invalid handler for event \&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot;: got &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cur</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isUndef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">old</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// æ—§èŠ‚ç‚¹ä¸å­˜åœ¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isUndef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cur</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// createFunInvokerè¿”å›äº‹ä»¶æœ€ç»ˆæ‰§è¡Œçš„å›è°ƒå‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          cur </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> on</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createFnInvoker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cur</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// åªè§¦å‘ä¸€æ¬¡çš„äº‹ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isTrue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">once</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          cur </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> on</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createOnceHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cur</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">capture</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰§è¡ŒçœŸæ­£æ³¨å†Œäº‹ä»¶çš„æ‰§è¡Œå‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cur</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">capture</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">passive</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">params</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cur </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> old</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        old</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fns</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cur</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        on</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> old</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ—§èŠ‚ç‚¹å­˜åœ¨ï¼Œæ¥è§¦æ—§èŠ‚ç‚¹ä¸Šçš„ç»‘å®šäº‹ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> oldOn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isUndef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">on</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        event </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">normalizeEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        remove###</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> oldOn</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">capture</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>åœ¨åˆå§‹æ„å»ºå®ä¾‹æ—¶ï¼Œæ—§èŠ‚ç‚¹æ˜¯ä¸å­˜åœ¨çš„,æ­¤æ—¶ä¼šè°ƒç”¨<code>createFnInvoker</code>å‡½æ•°å¯¹äº‹ä»¶å›è°ƒå‡½æ•°åšä¸€å±‚å°è£…ï¼Œç”±äºå•ä¸ªäº‹ä»¶çš„å›è°ƒå¯ä»¥æœ‰å¤šä¸ªï¼Œå› æ­¤<code>createFnInvoker</code>çš„ä½œç”¨æ˜¯å¯¹å•ä¸ªï¼Œå¤šä¸ªå›è°ƒäº‹ä»¶ç»Ÿä¸€å°è£…å¤„ç†ï¼Œè¿”å›ä¸€ä¸ªå½“äº‹ä»¶è§¦å‘æ—¶çœŸæ­£æ‰§è¡Œçš„åŒ¿åå‡½æ•°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createFnInvoker</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">fns</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å½“äº‹ä»¶è§¦å‘æ—¶ï¼Œæ‰§è¡Œinvokeræ–¹æ³•ï¼Œæ–¹æ³•æ‰§è¡Œfns</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invoker</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> arguments$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> arguments</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> fns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> invoker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fns</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// fnsæ˜¯å¤šä¸ªå›è°ƒå‡½æ•°ç»„æˆçš„æ•°ç»„</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fns</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cloned </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> cloned</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// éå†æ‰§è¡ŒçœŸæ­£çš„å›è°ƒå‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">invokeWithErrorHandling</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cloned</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arguments$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;v-on handler&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// return handler return value for single handlers</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invokeWithErrorHandling</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fns</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arguments</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;v-on handler&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  invoker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fns</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fns</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// è¿”å›æœ€ç»ˆäº‹ä»¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> invoker</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å…¶ä¸­<code>invokeWithErrorHandling</code>ä¼šæ‰§è¡Œå®šä¹‰å¥½çš„å›è°ƒå‡½æ•°ï¼Œè¿™é‡Œåšäº†åŒæ­¥å¼‚æ­¥å›è°ƒçš„é”™è¯¯å¤„ç†ã€‚<code>try-catch</code>ç”¨äºåŒæ­¥å›è°ƒæ•è·å¼‚å¸¸é”™è¯¯ï¼Œ<code>Promise.catch</code>ç”¨äºæ•è·å¼‚æ­¥ä»»åŠ¡è¿”å›é”™è¯¯ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invokeWithErrorHandling</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">handler</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">args</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">vm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">info</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> args </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_isVue</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isPromise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// issue #9511</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// reassign to res to avoid catch triggering multiple times when nested calls</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// å½“ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°å†…éƒ¨æ‰§è¡Œè¿”å›promiseå¯¹è±¡æ˜¯ï¼Œå¦‚æœæ•è·å¼‚å¸¸ï¼Œåˆ™ä¼šå¯¹å¼‚å¸¸ä¿¡æ¯åšä¸€å±‚åŒ…è£…è¿”å›</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handleError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> info </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; (Promise/async)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">handleError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> res</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å¦‚æœäº‹ä»¶åªè§¦å‘ä¸€æ¬¡(å³ä½¿ç”¨äº†<code>once</code>ä¿®é¥°ç¬¦)ï¼Œåˆ™è°ƒç”¨<code>createOnceHandler</code>åŒ¿åï¼Œåœ¨æ‰§è¡Œå®Œå›è°ƒä¹‹åï¼Œç§»é™¤äº‹ä»¶ç»‘å®šã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createOnceHandler</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> handler</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> capture</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> _target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> target$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onceHandler</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">//è°ƒç”¨äº‹ä»¶å›è°ƒ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arguments</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ç§»é™¤äº‹ä»¶ç»‘å®š</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">remove$2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> onceHandler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> capture</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong><code>add</code>å’Œ<code>remove</code>æ˜¯çœŸæ­£åœ¨<code>DOM</code>ä¸Šç»‘å®šäº‹ä»¶å’Œè§£ç»‘äº‹ä»¶çš„è¿‡ç¨‹ï¼Œå®ƒçš„å®ç°ä¹Ÿæ˜¯åˆ©ç”¨äº†åŸç”Ÿ<code>DOM</code>çš„<code>addEventListener,removeEventListener api</code>ã€‚</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">name</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">handler</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">capture</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">passive</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  target$</span><span class="token number" style="color:#36acaa">1.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      supportsPassive</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> capture</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> capture</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> passive</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> passive </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> capture</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">remove</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">name</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">handler</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">capture</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">_target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_target </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> target$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">removeEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_wrapper</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    capture</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å¦å¤–äº‹ä»¶çš„è§£ç»‘é™¤äº†å‘ç”Ÿåœ¨åªè§¦å‘ä¸€æ¬¡çš„äº‹ä»¶ï¼Œä¹Ÿå‘ç”Ÿåœ¨ç»„ä»¶æ›´æ–°<code>patchVnode</code>è¿‡ç¨‹ï¼Œå…·ä½“ä¸å±•å¼€åˆ†æï¼Œå¯ä»¥å‚è€ƒä¹‹å‰ä»‹ç»ç»„ä»¶æ›´æ–°çš„å†…å®¹ç ”ç©¶<code>updateListeners</code>çš„è¿‡ç¨‹ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="94-è‡ªå®šä¹‰äº‹ä»¶"></a>9.4. è‡ªå®šä¹‰äº‹ä»¶<a class="hash-link" href="#94-è‡ªå®šä¹‰äº‹ä»¶" title="Direct link to heading">#</a></h2><p><code>Vue</code>å¦‚ä½•å¤„ç†åŸç”Ÿçš„<code>Dom</code>äº‹ä»¶åŸºæœ¬æµç¨‹å·²ç»è®²å®Œï¼Œç„¶è€Œé’ˆå¯¹äº‹ä»¶è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µä¸å¯å¿½ç•¥ï¼Œé‚£å°±æ˜¯ç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶ã€‚æˆ‘ä»¬çŸ¥é“çˆ¶å­ç»„ä»¶å¯ä»¥åˆ©ç”¨äº‹ä»¶è¿›è¡Œé€šä¿¡ï¼Œå­ç»„ä»¶é€šè¿‡<code>vm.$emit</code>å‘çˆ¶ç»„ä»¶åˆ†å‘äº‹ä»¶ï¼Œçˆ¶ç»„ä»¶é€šè¿‡<code>v-on:(event)</code>æ¥æ”¶ä¿¡æ¯å¹¶å¤„ç†å›è°ƒã€‚å› æ­¤é’ˆå¯¹è‡ªå®šä¹‰äº‹ä»¶åœ¨æºç ä¸­è‡ªç„¶æœ‰ä¸åŒçš„å¤„ç†é€»è¾‘ã€‚æˆ‘ä»¬å…ˆé€šè¿‡ç®€å•çš„ä¾‹å­å±•å¼€ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> child </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      template</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">&lt;div @click=&quot;emitToParent&quot;&gt;ç‚¹å‡»ä¼ é€’ä¿¡æ¯ç»™çˆ¶ç»„ä»¶&lt;/div&gt;</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      methods</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">emitToParent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$emit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;myevent&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      el</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;#app&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      components</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        child</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      template</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">&lt;div id=&quot;app&quot;&gt;&lt;child @myevent=&quot;myevent&quot; @click.native=&quot;nativeClick&quot;&gt;&lt;/child&gt;&lt;/div&gt;</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      methods</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">myevent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">num</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">nativeClick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;nativeClick&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">script</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ä»ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ™®é€šèŠ‚ç‚¹åªèƒ½ä½¿ç”¨åŸç”Ÿ<code>DOM</code>äº‹ä»¶ï¼Œè€Œç»„ä»¶ä¸Šå´å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„äº‹ä»¶å’ŒåŸç”Ÿçš„<code>DOM</code>äº‹ä»¶ï¼Œå¹¶ä¸”é€šè¿‡<code>native</code>ä¿®é¥°ç¬¦åŒºåˆ†ï¼Œæœ‰äº†åŸç”Ÿ<code>DOM</code>å¯¹äºäº‹ä»¶å¤„ç†çš„åŸºç¡€ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹è‡ªå®šä¹‰äº‹ä»¶æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="941-æ¨¡æ¿ç¼–è¯‘"></a>9.4.1 æ¨¡æ¿ç¼–è¯‘<a class="hash-link" href="#941-æ¨¡æ¿ç¼–è¯‘" title="Direct link to heading">#</a></h3><p>å›è¿‡å¤´æ¥çœ‹çœ‹äº‹ä»¶çš„æ¨¡æ¿ç¼–è¯‘ï¼Œåœ¨ç”Ÿæˆ<code>AST</code>æ ‘é˜¶æ®µï¼Œä¹‹å‰åˆ†æè¯´è¿‡<code>addHandler</code>æ–¹æ³•ä¼šå¯¹äº‹ä»¶çš„ä¿®é¥°ç¬¦åšä¸åŒçš„å¤„ç†ï¼Œå½“é‡åˆ°<code>native</code>ä¿®é¥°ç¬¦æ—¶ï¼Œäº‹ä»¶ç›¸å…³å±æ€§æ–¹æ³•ä¼šæ·»åŠ åˆ°<code>nativeEvents</code>å±æ€§ä¸­ã€‚
ä¸‹å›¾æ˜¯<code>child</code>ç”Ÿæˆçš„<code>AST</code>æ ‘:</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcgAAAFvCAMAAAD5ZquOAAACkVBMVEUNIqocAM8hISEiIiImJiYpKSkqPbQtLS0xMTE3Nzc5OTk8PDw9PT1AQEBBUrxDQ0NGL9hGRkZHR0dKSkpOTk5PT09QUFBRUVFSUlJTU1NWVlZYWFhZWVlaWlpbR9xeXl5fX19gYGBicMhjY2NkZGRnZ2dpaWltbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4Z+J4eHh6enp7e3t9fX1+idJ/f3+AgICEhISFhYWGhoaHh4eIE5GIiIiJiYmKioqLi4uMjIyNjY2Pj4+QgueRkZGSkpKTk5OVlZWWMJ6Xl5eYmJiajuqampqbm5ucnJydnZ2enp6fn5+hRaiiRqmiqt6jo6OkmeykpKSnp6epqamqVrCqqqqrV7Grq6usrKyupO6urq6vr6+wsLCyZriysrKzs7O0tLS2bbu2tra4cb24uLi5dL65sPC6urq7u7u8vLy+fcO+vr7AgcTAwMDBgsXBhMXBwcHCwsLDw8PDyOrEGhbFxcXGjsrHjsvHkMvIyMjKxPTKysrLNjLLy8vMmdDNzc3Ozs7Pz8/QS0fQ0NDRS0jRo9TRpNXR0dHU1NTVXFrW1tbX19fY2NjY2/HZa2jZs9zZ2dnb29vcu9/c2Pjc3Nzd3d3e3t7f39/ghYPg4ODh4eHixeTi4uLjkZDj5fXkyObk5OTmnJrnz+nn5Prop6Xo6Ojp6enq6urr6+vs2e3s2u7s7Ozs7vjt3O/t7e3uvbvu7Pvu7u7v7+/wxsXw8PDx4/Lx8fHy8vLz8/P06PT09PT19fX22tr229r27Pb29vb29vz37vf39v339/f45OT4+Pj59Pr5+fn67e369vv6+vr7ODj8+fz8/Pz99vb9/f3+/v7///+qvJw+AAAdvUlEQVR42u2di38cV3XHbclJk9oN6UtO1dYNcR84XpOQBNxCrG5C6jzcFgGNlAJdiikKINV9kMUNWASvcaFgecsr2qiBRGEpW1oFImpRi3VCTYREA7JlZMuav6b3nHPvnTuzM/uQ9u3f+Xy0Ozt3VlrNd8895975zblbPFhX2BacAoCEASQMIGEACZBsS7f3ZpyXU79y63dw/joI5JUP/8a263b/63oY5IO9vY/Hvefi39z6zzi37QXyyp/0km37YC0eOX9L4FBYG4B8ctsNH7/6wwO9v/5iCGQ5A8i2A/nze3rvX/e8b7yu9wkF8uN/duN1b/gPz0uxlzKsi4//Wu8N93yTO9R//O1t173hm6a195Z5nN+2Aal86wn19Oof9D6iQP4y8bn1Bw5I3fO+7mvqmLt5MwmQ7Qhyagf7nYKYVD83/v2VL+5gsqb7/Nwv/P6L3qt/3PuI532494b3/fTqlz+IrrX9Qf6D5y3vI2gW1iPa+25fUg1vu4IY2cZd66h0rX8hyc76AdV5+rCSFqRqTiHZaVuQCo8kO9syAvKV3+19bwDkgXV7JDyyjYcfqV41/PjBH6kUR5F6cv2nf7rtF7/iwBrtvWH053LkOyRGvmNJ0f6d3vsu4uS2FchX93HXeeOnyOV4auChKw5I3Uyb3/kt3cmqXPYBZK3tBtJ79V2vk4HilQ/85g291936iauB7vPVd/2qGVLSph5S/u+DNwJkm4GMs+d+accUzl9ng1x6x5ev/vQBNWuH89fhIDlabvvrdZy/zga5/sXf23bdrZ8Cx66IkTCAhDUG5N/COtwAsvPslSjbTNe62khDTxlr9QfZwA8LkAAJkAAJkAAJkAAJkAAJkAC54ZOdPTQLkHUG2QeQXQGyr68PILsAZF+fQ7ImkFc+M2jsnc/Iyb40MjAwkKXnoUXPPOXVPn6ZHXpZtY9c8mYPDYjlPadZqX527pwHyI2B7OtzSdbmkc+/NaHt4e/zyV4cYkppxYwZzR7K6s00OWCWIC8OpQMeyc2zT/F2pqcnA5AbAtnXFyBZG8j1J94oHN/8uXU+2VnteIsaF9FaHFIw5TFLzuql5SADMq29ER7Zwqx1eVBApi7yyb40ws6WZxdUfPh1noldGlG+KvBCILMDDknEyBYNP156G3G874dysheH/NA3eyjPP9SfssWBdGMkQLYK5HrmzkTi7q/rk609ko22swqe9kgnUw2DZJYVcliAbPSEwCvv3nfHhy6ak+3Gu+zQ9zg6csJTAaT0xoiRrZzZee4tD7xoT/bsIfJBscWhz76fsaYFUggk57bkuUf8fchaWwjy6ic/v+6fbB5HDgjN9EDaD4IcN12QMpbMexJYNX94ZOtANudkNx7kahMMIJsB0uvUPwGQAAmQ3Q2yo3WtANklBpAACZAACZAACZAACZAACZAAWcHmd/bsWYppG+3v7z+wXNNZXpscL65MnFyo4ycsjk+uzYxPlwV5qv9UTb/z3F7/DY0CWd+FBvL2Glgcx1iMZMsHagTpTY8X1ybrAHJtcnJNthZOTq4VOxDkm574URNBZrZPefUHObFSd5AzdQXZjK41cfd7nl/vXJAzyhun6wpyZWJawexAkIl9937CVvTMK8HHQJ6UcloSIE9ZfTE5zwJJeTLiZtJsqXZWUmrhFh+0tCcCmgZ5qn/UPqlup79/MAhycO8582L5gGoeleZUTyouE1mbnJkZn/zZhHKlaelp+WllYnx8vEjNDFueimofv5ymN1AvOjMuFvhGrMZBJDvlDe5+gT+qehrd++IBE94HVSN9+sHBU/20W/1nL+zu75eD6d9pHMhE4o73LlmPOjSbfvTIy0NZLT5nlQDJlfk1K5pFNOCLm5V2QG2KkMDxyKnt/mkPgzy3l/9r4nXuwDk6OYMxIPnIF3YPylfDT5RKQY5PL3zhC8WZiRXuF9mxlGdNE7cZQlXkbtNsMuZpgsz7HI+sAJI/GnmkfBnP7R3kLG1UtrzBU7RPHTPYf+DFvW8ePSUERzXIF3Y3FGQicf9XlzXINGEjvTIzYaEdyyS1WJK4sprZFzeL8iev7yewIMt5pPxj8q/L6RGApSBHaUs/lvfIkwuETXW1wqTIpJgOPTJX7ohXJoTzDAdYg7BakNKp0qN8VgY1ykwH5UN6snOw/xR9CXUnbECqYxoLMnHvN2yMU75FqBgXgxFm/Jo1dnl2UCtuFt1dCcgoW9qjXeqF3aP6JDjf8wiQywcGo2PSakSMI98iVPTDYIQZv+ZAujY5rQlLOwfX2kDKV4o/D8GRDyyYHJDU8+49R1/UIMhze0e9xoJ8+zPLYZDsfWlytrQOfYSOdtCPI26uGuT8Tt9HyQXFDSXmxIDkACoxqXqQkq4UqSeV0EfoaAfvNPFwYyAHfZDE6YXdp7wASP2BY0DS97dZMdIHqQDJjSBZR/6ap37X9LliG/FI8sZze/kkuN1SnEdWnnZxQRKgGWKkPVIfoPpd2+fqscumQNK27vktSBUDl8t4ZGNBBrJWB6TyvH8LZzB0d49w9cXNMSDLxkjqZOQkDDqPQZB8Uvz+qlKMdEAunPyfyZIMZmbix8xVkpvqQE5tD/8PTERl0qcYS+bAqBcA6YfQSJD0/zVnHBkAmdcDiUsjjsw8O3IkK/iMuNkFqdPaSlkr/WsHHhyVdJ3yhlDXSv++Sto5YfVHluWzVgekSmFlIMEzNJ4ZH377Syt6DqEUpE5rQyCVAjsZnqMZVJ/yQe5R7cd2QUoSGwOS2pszsxMA6QPkO3vkxewhvdOKm12QEjuzlT1SETJfUgop5J28pceUozTyGrTjSD1Gq9YjfYA8jtQvps3OIsfIYhAkx87wOFJ9dUIgeVB4SkKjHTU5MZLmiwep2QE52u+nAef2tmCule+tq69VmNmp16WJYol7bfBPpCJ6lU1O8LTg6kel+ba2BRkR8Db2J8rP8Vc/odhakOa+nfpexUo2AeR0Xa5rrapLbuX80UzStTnIrA51dTaVApW9kLV5kCos1mESvWLvrQaMbkLd1l1rOxsUAgAJkAAJkPU/y7g/EtZaA0iAhAEkDCBrttCsT6o+MwfXDMh6CJQLR89v/M3qCkMPT4XVALJuM31dBLIeAuXNgGQmU9uTNdEByFKrh0B5MyCT7HcZVUILIDcHMiD1iLTzR+cKY2MMa+7oebU5Nqc2L59WGzlqHROjnXNj+sAYy4Qv1E5tTxky6kdNqXNRtFQPWTLQ8/qbyR6xzoyhzRFfxYAcO33ZyxEgBUpvnj/KENUrxyP5mBwjjfG/nlDRs4xUsyNV1vzO16vGlClvJ17HVwS551WPRO6RKXhkLEhfoBwDknBdOF4gkDn2uzkvxwjnGJoBqVyXXZWbqvPIlL7SnNw5L5XtlvYkXZApBs+PSf87AJBxII1AOQZkgfnkDDhPYzVPBmTh+AXnqSoLgEz6QVPD0lglhKYQIyuCNALlsiCVo1mQsk+BzDkgcxpkDblPoGtNaqQ+LHWRXixjoilAbiZGFgyzsEdKU8gjczV4ZDDZ8RwNs+uRzpEAuZmstWACoAWpA+EcIzQg53Q6m6s+a9XcSJRlspuUC8sPjL5KHSA3OI5kkBeOEzkLUtIeTl3tk0LIWWuZnrUkaxW07G3aBc0BAktSVedLwFmrl6yXGu+amtmRkWLB9zl/71xoOzfG45PqPVKHwYxQ7nGU3drrePAoQ0b/SDkW40jXqphr1YlNk62Tu89WgPTaFaSb3ABkZ4KcTy45wRIgN2Bm3nTsox8zW2OF2kFeOG7f/Wm7VS52lnhjT5dejYRCACBhAAkDSBhAAiQMIGEACWs9yGyFhVkDxw5EVoYwBSNimmHtADLr1+xsKMif3HbbTwCykSCpOT9QtiREPUq4AGQzQFYgBZBtAjLtr8xrVqW369M7INO6OCTVosvLGr3uwr6RzbyY70Cg2LIXcWl5eIvYTWcU0f1nbtqyRWE9c9N+1fT09cPMWbUOdxHIJ8NWB5CPZj1dQJCXTyZ+WcIw+5QBmdVVk+QwKlGmDuIWLl1mPLK0metlp2VZZjrmKfH+UrGH75GE7JjCt98FeeYm1Ur7ALJMNkNu4td5zHPda/sykOxYUtRMDAVhCUjTLL+Ht6RYnRfjkQGQ1z8tLx2Qw8pVzSNAlouRDkiulzxgXmvHCpFKe4JGarmWgDTNDkjlptmqYqQfLH2QqrulHceUqwJkFSB1ReR8SYw0GVEJKfGzeJDStfKb3RhZK0gKmmwAWQ1It8C8J4sNmGZbv7NGkNwxW2dXLNOb8chuylobCTJc/1g62bIeaYrzxoB0amUHxinlY2QQ5DAlq/u7Jjo2B2SafSjvXTpiu1s/N412OdWcHxqJBWkHmHn7luisVQE7Fh5QEr5hHnU8fX13jTIbHCOpI0zz0h4cLRmCXzfZrCmQdUF6PAZ1lxwINPvDSPlF+disVcaSPI60zGgkctu3brLjyC1dQ7MRIBtpurp5tiHFQgGyeeYuowVrEMjVtjSArB1kc/pWMxPbRh8KIBtvAAmQAAmQAAmQAAmQAAmQAAmQANn5INVVxCxAdipIZ5G6siDz/srLFb8PVUzwAGQDQdblOIAESICMsiufGdS2+s5neE926OWRkEDZLkuf1dPeeQbB2ht5stosCzK6OT3y8tCAFh4MDPhvskIeqc8KkLV75PNv1cVZVx/+voD0L+r7AuWAp+ltUSlrTVVei+P84yKb0/QlCCq0XPUzr0SdAciNgFx/4o0a5OfW9WmNEChHgRTYpAwRNSs/6mQnH9PMIvOgitn9W/DITcTI5UENUpf1jBQoR4HkY1gXl9dCVUXGOS6qmX9tGKSvfkaM3Eyy89LbiON95pzFCZRLQZIsi6VZJuAFQUY1R4J0YyRAbhzkeubOROLur5eCdAXKUSDJ3bJ8iH8nXmC8WdocDdIz6meA3NTw45V377vjQxdLQboIo0CqBPd7HP6cG3Lc4yKaY0GaNyJGbmYc+dxbHnjRiwJpBMpWyBiEtTj02fcvyjAlHwEyotkBae/Nc9TPyFo3B/LqJz+/HgHSESjreOmnpdIRps1cXN4E08AUXWmzC5J/vQ3F+nsCj8TVD4AESIAESIAESIAESIAESIAESIAESIAESIBspxtZAXIDIHHHcneArMoLrPSKrLSubvUaumvM49oOpBeUVwFkV4CsrQ0gARIgNwbSapYHtWY5II+yGjrnFg/TzG2quhVLO1I9KYBsKUirWU5ozbJoNbSE2Pc6XWrOac6z/FiIq3WQK6/2CJCNBGk1y2/WmuVAteNSkH6zahPpHTyyLWKk0SynjGbZFZ2Wgsw6YubPHkrX9rdgjUx2tGb5h3pPujxIV5Ve1a2RANkskFqz7NUOMl9b5UeAbPDwQzTLkaOKUpDBGsuWJGJkO4wjWbNs7NIIl02Oy1r9Zm5LC0lkrW0BkjXLvmW1hNiXJ/sFkgPNeb/kPDyyvWd26moACZAACZAACZAACZAACZAACZAACZAACZAACZAACZBdC7IdlOS05iAtkm3t6etDOwCyfhbQ8lRh1RfRHo5aPXkYINsEZNXmLP4JkJ0MUlZTBshmgJRFdrPu2p5u7eWsro6VV/XoSMhj6jDb+sp27fpQrasQSDdWWpDDdlXeY7J8L0Bu2Oya2bpIHQmwnNrL2axWgFDVx/SjR14e0rhNgVB601NcBi1UfY4obhFTMIeHqZ/VAA3I/fR8bNiE0v1d4KgtAymdql3nXMojh2svUxU7KkyoimBreY9bstdYeY+UhPWYC9Jdz37YPgLkhkxKsOqFzA3NcO1laiF0ak8QpNTGrjpGPn39cNAjzWrnx3hHdGYEkNX3rGbB+qFFrnjtguQYKCE0AmTFJMmClFXqtwxHx8hh3QcDZF1A8g0f+QBIWZog1iOrBnnmJspkwh4pLFXLsa5JY1vXtTIRUbAqd8xKJV2niHa2XNcaKJ5cLkYKwiiQ/MI0AOSGTZYMGBkyqta855VUQ8/Hdq1Smzkuaw2AVL3msVDXeua2MyYw7o+aAALIWowGhVmdtOg1XtwYSULmERpzOCDd2svOmLJs1krjxNu+RWmpjofS1crYRLdv6QKaLZ7ZsVDTHqwLQGYjV3qAdRrIfPPWBQXIxll6oNZKHrB27VphAAkDSICEASQMIGEACZAwgNzEDEHsgsmwrgF5cOvWrYfliewgCFqQEda2IJ+9+a7XnJcntp4AwU4EeXbXYffla3cFsAJki0DamsppdQHZX4vXVlrO9CRD7zix62zg5dbDANh6kLzSdZouRPLlDxbpyAVm7ZHJnvCF/4NBDzwY5AqQLQEpIg9+TEv9OdLwiIfGeORrdx08rBIcQ/PZm+GQbQBSBMo+PtoScWtsjHztLupLz+7SjgiHbAuQWRFSDbggtXQnHuRBJ1eFQ7aTR/pZahUgdYzUBA/e/CzwtQFIRyvudK0kOzarRZRmrYe5Mz3BBJ+9GZMB7ZG1pq1Sx4KUVT8ePRKXtZ7ddVA/wCHbbBzJuisfJEXOocVsnEcqiDJDB4fsiJkdGEACJEACJAwgYQAJA0iAhAEkDCBhAAmQAAmQmzd9PTI/YK9LcgkPulZZfeHdaEv2bJ/yaD3D0oIuAFml/ffGQer6kZsHmWSMHqPMAOTG7P4PzF+tCaRv+ToVGZjfaRcWXdqTBMiN2X37HvqX5Y2BrFf1FoCsC8jEvj983ys+rbTqOl+WNXg5BEqXaQXKZq1eF6RbQdm2K/FPVu92qipHLusLkPUBmVAov2JBUoGyv8rmuUZyVheXCwiUdeFAI7cTmLbwrnp5aUTXOiMlHi/a7FdVjlxoGyDrBTKRuOfx765rkHk68QqMVrOS2wUEyn4FSKdrtWU+8+ZRygvmjVjd8+CRzQCZuPMj6yYQSp1AXaqVqAQFyuVAiqyHHdjPhFTPWz6lTdmkNbgNkBvxyJfCIP1aukFdazmQad3fBkAGYmTUGDLgo6rzzQBkHWJk2CPz1NfW5pERY5NLIwNpeGRTs1YLUuPLUmFzV6BcDqRDLzTINO9CjGzcOPJhdxzpg5RFInTq6giUy4HkFUHCIPNpzyrYkbU2a2bHAclSZQFjBcp6kYGBtAvSraCcNVuOR2YH/HEmPLL1c60NM4DsEgPIbrGkvS0og6sfnWwqBTLXI1MeQMIAEgaQMIAESBhAwgASBpAACZAAuXmrsOpgxUUJVZE6romlnrdeq7V4uwLkYSkZeXaXerxWi7h2A8hnb/5LrqUsFc6u0aKRbVBBOe3XifTv1lFllRdHuN1tVrPepVIbVRH7LIGU4pGqez0BkE2voDz7VMDlFkcWjVA1TXo4kRw7Hjm1vfSyxeGbn+Xq5lw18uyuv9t1GCCbWlTQF8KF+s400ZOag3yQ0xzhkcTPgjy764QuOgiQzfNI5/bHdAnieM4lHetrFqTi6AFky1YZcEiJvKoWkFy9VYP8c8UxvKYEQDbD8qKIs6RYGFmbR5o1ebbe9V+7OM05gWSnBcMP0TJaUs5NPNEgo7JW07/qgQeGH80FeenIrJ/xpLVwlTIcpWgNgbTN0VmrBcnR8VpdZql1HslDRqMlT8s2y5Lz2TBI01zBI7nA8rVaIRuT5gAJA8g622orDCAbAPIa+ZsACZAACZAACZAACZAACZAACZAACZDdCdIt/1itzd+yY3Vqxy3zVRy6MjFerO6wcXtgcXxiJdhc5DYGmepNesneFEBGWM1Fdpdu37E6f0s8yKIPrwLI4rgFWKwOZEaBTAFkPUHevlQFyPI2TQeuTa9UelMJyAxA1gOkl7xlden2zYOccY+rEuTUjpSCeW2D1Ff9+Wn2kF/VUYMUeYfUI3MiZ/SFZZ14zEz8bHJ8fHJN3Guc+kQOd2Qznrdwcnz85IJqW5vk3lKeinKgeiVvDIKcGTe/0D+S2xZW6Vci2dG154TX7JFLRncVBXL2UNocHiP1MCCJ18rENHEsUkRkXq5zzTBI7XwLJ2f05rTavXByOtKNLWDueRf+XdoWTq6uIGtlk5KBfkeqi+5GgGS9sn4s75HsJNM2OSkytgiQApterEzM8OsZddhMWZCM3bQtnJzE8MMYVwpMG9GOrQVZAnJxKGsPLz+mE0wOSKYRAZKPWZucNqwJViWQM86v/bbyXoD0x4w+JP8unVKQHEBt+cgqQerYGAdy4WSRfzgGjnMcrNS1ut+P8XGAdNMdVZpedKzErpJHVjHL4oNUXd9aOY8kb5zhQ/QOQh+V7ESDLKpOHCD9dOfQf46kbacaCZIyIL/+bsUYaUG6CKNAqo7yxxwd/cgnyUw8SHeKoKg8GSCddOep9896uhqyGmIEQLKuNTtgVwTRVj5rdUBOc7dZDLmaBbky8e0vrQTxybRPyYSAAbk2Se81Was3vToDkDbd0exonHholvIep0QyaZXVEi92HCk0q/RIjn3THAV1vJyx8XBCA5x25uUEGx1Av0J20ebapGxOu2NKBrm2Oj4NkPU2XP0ASIAESIAESIAESIAESIAEyGadVNyNhfsju8UAEiBhAAkDyHrY1Hb3EopaZykFkNVbPZYdvHz69OWNv3t+Z08Pr21WA8iOWQytZQuBNh8k48sQtCDIsgaQJXbfvofcpXmbDlKvGEmLZAPkpkAGF8uOtMLx/zs9NsawcqcvqM3jF9TmheNjY2MF1TomxjsLZiPGSpbm1UgIovrJ9PAChKpb7dH9rd/zshCBmnkPWQogXZCB5eujQRKwC8eJZM5uzhHEubGc65GXTyuIl08fPR/vf+HFsvV69fM7k4rT61Vj0ogNMjpwJnXPK1+C+eQSPDIOZCJxz+PfXS8HUjHz5ohPbmyO/PL4hcunc9xEOy1IPkRxzlXvkXo116U9e5amthNku1CvwEoyeHok1uhaK4BM3PmRciCZz/mjc4xQ9vEr/WRB5uQ5V0PIDIBMec4yywxLYyW/zTi6IICM9ciXqgBZcEDOjWmQBR+kec6Vi5JhF3W71pRG6sOisEimjkoB5KZjJINkdGGP5J0hj6wpiQ0mOxppiUc6yAFyE1krgywQQwtSB0LeackVdIwsVB8jNbeU6mEF5NT2jAPL+mdwmAmQEePIhyuOI5kPZ6lOr1mQrLUg23OaLmet8T1radYqaHU3SlnpTnOAwMr02BQnyS7KWat/FEDWMLPDI0UZUzjhb87u9IePl9Ugcyzn1TCOtKNDM3pMhbxORo1J2dPTI7mR7MU40rFq5loL8QPDBlrHdJ/tAdJrW5CpyDrpANlJIDMpPaUDkBtFNmbsnz5mN+dqB3n+qHnzR/3fU6jBGzsjAnaaR8IAEiABEiBhAAkDSBhAAiQMIFttrnCDZwA65HJGm4D8Th0+26Ym7PgKR6o2kKFDAVLZm574UUtBMhOeRa2BDkCWWuLu9zy/3kKQoomjC1QAuTmQiX33fuJi2UOUGKegrxgrdSPNotPVf3PF2M6G00730nKUOVf3xbRag8ioH7qinPFkhlxfOrY9r7+Z1GrkzoyhjQOZSNzx3qXyIElTnhN1h9k8f5QhsjTHemTOF7rG+J+5nu+TzQijPUvzO1+vGlPm4rF4HSs45PqViFwfmYJHxoJMJO7/6nI5kISLBVSiIyehnMjjRAJpQIqOrpxkrsQjzbViJWad30mQrYhVYKUYPD8m/e8AQMaBTNz7jXIgC8wnZ7WrVhcnTwZkQeQ7hdpFrAIy6QdNDUtjlRCaQoysCPLtzyxXBsm3d8y5+7QE0oDUOqxacp9A15rUSH1Y9u6cTED72Pkg+4w1N0YWDLOwR0pTyCNrkZUHkx3Pka26Hukc2S0eGeDYtKy1YAKgBakDodyjY0DO6XQ2V33Wqrll+N44yW5SLiw/MDrC5K7oWl2OTRpHMki5h86ClLSHU1f7pG+fy5XpWUuyVkGrhcjsguYAgSWpqvMl4KzVv9Oug2Okw7FJMzsyUiz4PufvnQttq5slx8rd5lHike5tq0k7eHS8TjTKe5YCR8qxnT6O7Gv2XKtObJpsndx9tiJr9doVZA31AwCyTUHSbTl+sATIDVikirh2kFwVQuzTdquGWyRpzrU7r0ZCIQCQMICEASQMIK9hkK/AOse+FmUAeQ2AfLLDDCABEiABEiABssEgHwPItrO+DYB8DCDbEGRfzSAfA8i2BNlXI8jHALJNQfbVBPIxgGxbkH2VQP4/nzgn7kkPCHUAAAAASUVORK5CYII="></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="942-ä»£ç ç”Ÿæˆ"></a>9.4.2 ä»£ç ç”Ÿæˆ<a class="hash-link" href="#942-ä»£ç ç”Ÿæˆ" title="Direct link to heading">#</a></h3><p>ä¸ç®¡æ˜¯ç»„ä»¶è¿˜æ˜¯æ™®é€šæ ‡ç­¾ï¼Œäº‹ä»¶å¤„ç†ä»£ç éƒ½åœ¨<code>genData</code>çš„è¿‡ç¨‹ä¸­ï¼Œå’Œä¹‹å‰åˆ†æåŸç”Ÿäº‹ä»¶ä¸€è‡´ï¼Œ<code>genHandlers</code>ç”¨æ¥å¤„ç†äº‹ä»¶å¯¹è±¡å¹¶æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">genData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">events</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">genHandlers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">events</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">nativeEvents</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">genHandlers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">nativeEvents</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>getHandlers</code>çš„é€»è¾‘å‰é¢å·²ç»è®²è¿‡ï¼Œå¤„ç†ç»„ä»¶åŸç”Ÿäº‹ä»¶å’Œè‡ªå®šä¹‰äº‹ä»¶çš„åŒºåˆ«åœ¨<code>isNative</code>é€‰é¡¹ä¸Šï¼Œæˆ‘ä»¬çœ‹æœ€ç»ˆç”Ÿæˆçš„ä»£ç ä¸ºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_c</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;div&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">attrs</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;app&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">_c</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;child&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">on</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;myevent&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">myevent</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">nativeOn</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;click&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">$event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nativeClick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">$event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æœ‰äº†<code>render</code>å‡½æ•°æ¥ä¸‹æ¥ä¼šæ ¹æ®å®ƒåˆ›å»º<code>Vnode</code>å®ä¾‹ï¼Œå…¶ä¸­é‡åˆ°ç»„ä»¶å ä½ç¬¦èŠ‚ç‚¹æ—¶ä¼šåˆ›å»ºå­ç»„ä»¶<code>Vnode</code>ï¼Œ æ­¤æ—¶ä¸º<code>on,nativeOn</code>åšäº†ä¸€å±‚ç‰¹æ®Šçš„è½¬æ¢ï¼Œå°†<code>nativeOn</code>èµ‹å€¼ç»™<code>on</code>,è¿™æ ·åç»­çš„å¤„ç†æ–¹å¼å’Œæ™®é€šèŠ‚ç‚¹ä¸€è‡´ã€‚å¦å¤–ï¼Œå°†<code>on</code>èµ‹å€¼ç»™<code>listeners</code>,åœ¨åˆ›å»º<code>VNode</code>æ—¶ä»¥ç»„ä»¶é…ç½®<code>componentOptions</code>ä¼ å…¥ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// åˆ›å»ºå­ç»„ä»¶è¿‡ç¨‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createComponent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> listeners </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">on</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// replace with listeners with .native modifier</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// so it gets processed during parent component patch.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">on</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">nativeOn</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vnode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">VNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;vue-component-&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Ctor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;-&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">Ctor</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Ctor</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> propsData</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> propsData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> listeners</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> listeners</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tag</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> tag</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> children</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> children </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    asyncFactory</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vnode</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="943-å­ç»„ä»¶å®ä¾‹"></a>9.4.3 å­ç»„ä»¶å®ä¾‹<a class="hash-link" href="#943-å­ç»„ä»¶å®ä¾‹" title="Direct link to heading">#</a></h3><p>æ¥ä¸‹æ¥æ˜¯é€šè¿‡<code>Vnode</code>ç”ŸæˆçœŸå®èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹é‡åˆ°å­<code>Vnode</code>ä¼šå®ä¾‹åŒ–å­ç»„ä»¶å®ä¾‹ã€‚å®ä¾‹åŒ–å­ç±»æ„é€ å™¨çš„è¿‡ç¨‹åˆå›åˆ°ä¹‹å‰æ–‡ç« åˆ†æçš„åˆå§‹åŒ–é€‰é¡¹é…ç½®çš„è¿‡ç¨‹ï¼Œåœ¨ç³»åˆ—æœ€å¼€å§‹çš„æ—¶å€™åˆ†æ<code>Vue.prototype.init</code>çš„è¿‡ç¨‹ï¼Œè·³è¿‡äº†ç»„ä»¶åˆå§‹åŒ–çš„æµç¨‹ï¼Œå…¶ä¸­é’ˆå¯¹è‡ªå®šä¹‰äº‹ä»¶çš„å¤„ç†çš„å…³é”®å¦‚ä¸‹</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">_init</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// é’ˆå¯¹å­ç»„ä»¶çš„äº‹ä»¶å¤„ç†é€»è¾‘</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_isComponent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// åˆå§‹åŒ–å†…éƒ¨ç»„ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">initInternalComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// é€‰é¡¹åˆå¹¶ï¼Œå°†åˆå¹¶åçš„é€‰é¡¹èµ‹å€¼ç»™å®ä¾‹çš„$optionså±æ€§</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$options</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mergeOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">resolveConstructorOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">constructor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      options </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// åˆå§‹åŒ–äº‹ä»¶å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">initEvents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initInternalComponent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> opts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$options</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">constructor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  opts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_parentListeners</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnodeComponentOptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">listeners</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>æ­¤æ—¶ï¼Œå­ç»„ä»¶æ‹¿åˆ°äº†çˆ¶å ä½ç¬¦èŠ‚ç‚¹å®šä¹‰çš„<code>@myevent=&quot;myevent&quot;</code>äº‹ä»¶</strong>ã€‚æ¥ä¸‹æ¥è¿›è¡Œå­ç»„ä»¶çš„åˆå§‹åŒ–äº‹ä»¶å¤„ç†ï¼Œæ­¤æ—¶<code>vm.$options._parentListeners</code>ä¼šæ‹¿åˆ°çˆ¶ç»„ä»¶è‡ªå®šä¹‰çš„äº‹ä»¶ã€‚è€Œå¸¦æœ‰è‡ªå®šä¹‰äº‹ä»¶çš„ç»„ä»¶ä¼šæ‰§è¡Œ<code>updateComponentListeners</code>å‡½æ•°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initEvents</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_events</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_hasHookEvent</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// init parent attached events</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> listeners </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_parentListeners</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">listeners</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// å¸¦æœ‰è‡ªå®šä¹‰äº‹ä»¶å±æ€§çš„å®ä¾‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">updateComponentListeners</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> listeners</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ä¹‹ååˆå›åˆ°äº†ä¹‹å‰åˆ†æçš„<code>updateListeners</code>è¿‡ç¨‹ï¼Œå’ŒåŸç”Ÿ<code>DOM</code>äº‹ä»¶ä¸åŒçš„æ˜¯ï¼Œè‡ªå®šä¹‰äº‹ä»¶çš„æ·»åŠ ç§»é™¤çš„æ–¹æ³•ä¸åŒã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">remove$1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$off</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateComponentListeners</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">listeners</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">oldListeners</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">updateListeners</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">listeners</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> oldListeners </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> add</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> remove$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> createOnceHandler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="944-äº‹ä»¶api"></a>9.4.4 äº‹ä»¶API<a class="hash-link" href="#944-äº‹ä»¶api" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬å›å¤´æ¥çœ‹çœ‹<code>Vue</code>åœ¨å¼•å…¥é˜¶æ®µå¯¹äº‹ä»¶çš„å¤„ç†è¿˜åšäº†å“ªäº›åˆå§‹åŒ–æ“ä½œã€‚<code>Vue</code>åœ¨å®ä¾‹ä¸Šç”¨ä¸€ä¸ª<code>_events</code>å±æ€§å­˜è´®ç®¡ç†äº‹ä»¶çš„æ´¾å‘å’Œæ›´æ–°ï¼Œæš´éœ²å‡º<code>$on, $once, $off, $emit</code>æ–¹æ³•ç»™å¤–éƒ¨ç®¡ç†äº‹ä»¶å’Œæ´¾å‘æ‰§è¡Œäº‹ä»¶ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">eventsMixin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Vue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// å®šä¹‰äº‹ä»¶ç›¸å…³å‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">eventsMixin</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">Vue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> hookRE </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">^hook:</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// $onæ–¹æ³•ç”¨æ¥ç›‘å¬äº‹ä»¶ï¼Œæ‰§è¡Œå›è°ƒ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">$on</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// eventæ”¯æŒæ•°ç»„å½¢å¼ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// _eventsæ•°ç»„ä¸­è®°å½•éœ€è¦ç›‘å¬çš„äº‹ä»¶ä»¥åŠäº‹ä»¶è§¦å‘çš„å›è°ƒ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hookRE</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_hasHookEvent</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// $onceæ–¹æ³•ç”¨æ¥ç›‘å¬ä¸€æ¬¡äº‹ä»¶ï¼Œæ‰§è¡Œå›è°ƒ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">$once</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// å¯¹fnåšä¸€å±‚åŒ…è£…ï¼Œå…ˆè§£é™¤ç»‘å®šå†æ‰§è¡Œfnå›è°ƒ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">on</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$off</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> on</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        fn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arguments</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      on</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fn</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fn</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> on</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// $offæ–¹æ³•ç”¨æ¥è§£é™¤äº‹ä»¶ç›‘å¬</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">$off</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// å¦‚æœ$offæ–¹æ³•æ²¡æœ‰ä¼ é€’ä»»ä½•å‚æ•°æ—¶ï¼Œå°†_eventså±æ€§æ¸…ç©ºã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">arguments</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_events</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æ•°ç»„å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i$</span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$off</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cbs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">cbs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// specific handler</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cbs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token operator" style="color:#393A34">--</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        cb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cbs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cb </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> fn </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> cb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">fn</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// å°†ç›‘å¬çš„äº‹ä»¶å›è°ƒç§»é™¤</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          cbs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">splice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">break</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// $emitæ–¹æ³•ç”¨æ¥è§¦å‘äº‹ä»¶ï¼Œæ‰§è¡Œå›è°ƒ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">$emit</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> lowerCaseEvent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toLowerCase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lowerCaseEvent </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> event </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">lowerCaseEvent</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">tip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;Event \&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> lowerCaseEvent </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot; is emitted in component &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">formatComponentName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; but the handler is registered for \&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> event </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot;. &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;Note that HTML attributes are case-insensitive and you cannot use &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;v-on to listen to camelCase events when using in-DOM templates. &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;You should probably use \&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">hyphenate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot; instead of \&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> event </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot;.&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cbs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_events</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰¾åˆ°å·²ç»ç›‘å¬äº‹ä»¶çš„å›è°ƒï¼Œæ‰§è¡Œ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cbs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        cbs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cbs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">toArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cbs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> cbs</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> args </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">toArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arguments</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> info </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;event handler for \&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> event </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cbs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">invokeWithErrorHandling</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cbs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vm</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æœ‰äº†è¿™äº›äº‹ä»¶apiï¼Œè‡ªå®šä¹‰äº‹ä»¶çš„æ·»åŠ ç§»é™¤ç†è§£èµ·æ¥ä¹Ÿç®€å•å¾ˆå¤šã€‚ç»„ä»¶é€šè¿‡<code>this.$emit</code>åœ¨ç»„ä»¶å®ä¾‹ä¸­æ´¾å‘äº†äº‹ä»¶ï¼Œè€Œåœ¨è¿™ä¹‹å‰ï¼Œç»„ä»¶å·²ç»å°†éœ€è¦ç›‘å¬çš„äº‹ä»¶ä»¥åŠå›è°ƒæ·»åŠ åˆ°å®ä¾‹çš„<code>_events</code>å±æ€§ä¸­ï¼Œè§¦å‘äº‹ä»¶æ—¶ä¾¿å¯ä»¥ç›´æ¥æ‰§è¡Œç›‘å¬äº‹ä»¶çš„å›è°ƒã€‚</p><p><strong>æœ€åï¼Œæˆ‘ä»¬æ¢ä¸€ä¸ªè§’åº¦ç†è§£çˆ¶å­ç»„ä»¶é€šä¿¡ï¼Œç»„ä»¶è‡ªå®šä¹‰äº‹ä»¶çš„è§¦å‘å’Œç›‘å¬æœ¬è´¨ä¸Šéƒ½æ˜¯åœ¨å½“å‰çš„ç»„ä»¶å®ä¾‹ä¸­è¿›è¡Œï¼Œä¹‹æ‰€ä»¥èƒ½äº§ç”Ÿçˆ¶å­ç»„ä»¶é€šä¿¡çš„æ•ˆæœæ˜¯å› ä¸ºäº‹ä»¶ç›‘å¬çš„å›è°ƒå‡½æ•°å†™åœ¨äº†çˆ¶ç»„ä»¶ä¸­ã€‚</strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="95-å°ç»“"></a>9.5 å°ç»“<a class="hash-link" href="#95-å°ç»“" title="Direct link to heading">#</a></h2><p>äº‹ä»¶æ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­å¿…ä¸å¯å°‘çš„åŠŸèƒ½ç‚¹ï¼Œ<code>Vue</code>åœ¨åº”ç”¨å±‚æš´éœ²äº†<code>@,v-on</code>çš„æŒ‡ä»¤ä¾›å¼€å‘è€…åœ¨æ¨¡æ¿ä¸­ç»‘å®šäº‹ä»¶ã€‚äº‹ä»¶æŒ‡ä»¤åœ¨æ¨¡æ¿ç¼–è¯‘é˜¶æ®µä¼šä»¥å±æ€§çš„å½¢å¼å­˜åœ¨ï¼Œè€Œåœ¨çœŸå®èŠ‚ç‚¹æ¸²æŸ“é˜¶æ®µä¼šæ ¹æ®äº‹ä»¶å±æ€§å»ç»‘å®šç›¸å…³çš„äº‹ä»¶ã€‚å¯¹äºç»„ä»¶çš„äº‹ä»¶è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨äº‹ä»¶è¿›è¡Œå­çˆ¶ç»„ä»¶é—´çš„é€šä¿¡ï¼Œä»–æœ¬è´¨ä¸Šæ˜¯åœ¨åŒä¸ªå­ç»„ä»¶å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªäº‹ä»¶æ€»çº¿ï¼Œä»åˆ†æç»“æœå¯ä»¥çœ‹å‡ºï¼Œä¹‹æ‰€ä»¥æœ‰å­çˆ¶ç»„ä»¶é€šä¿¡çš„æ•ˆæœï¼ŒåŸå› ä»…ä»…æ˜¯å› ä¸ºå›è°ƒå‡½æ•°å†™åœ¨äº†çˆ¶ç»„ä»¶ä¸­ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated on <b><time datetime="2022-10-24T06:26:17.000Z">10/24/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog-vue-source/æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog-vue-source/vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#91-æ¨¡æ¿ç¼–è¯‘" class="table-of-contents__link">9.1. æ¨¡æ¿ç¼–è¯‘</a></li><li><a href="#92-ä»£ç ç”Ÿæˆ" class="table-of-contents__link">9.2. ä»£ç ç”Ÿæˆ</a></li><li><a href="#93-äº‹ä»¶ç»‘å®š" class="table-of-contents__link">9.3. äº‹ä»¶ç»‘å®š</a></li><li><a href="#94-è‡ªå®šä¹‰äº‹ä»¶" class="table-of-contents__link">9.4. è‡ªå®šä¹‰äº‹ä»¶</a><ul><li><a href="#941-æ¨¡æ¿ç¼–è¯‘" class="table-of-contents__link">9.4.1 æ¨¡æ¿ç¼–è¯‘</a></li><li><a href="#942-ä»£ç ç”Ÿæˆ" class="table-of-contents__link">9.4.2 ä»£ç ç”Ÿæˆ</a></li><li><a href="#943-å­ç»„ä»¶å®ä¾‹" class="table-of-contents__link">9.4.3 å­ç»„ä»¶å®ä¾‹</a></li><li><a href="#944-äº‹ä»¶api" class="table-of-contents__link">9.4.4 äº‹ä»¶API</a></li></ul></li><li><a href="#95-å°ç»“" class="table-of-contents__link">9.5 å°ç»“</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022, Power By <a href="https://www.docusaurus.cn/">Docusaurus</a>.</div></div></div></footer></div>
<script src="/blog-vue-source/assets/js/runtime~main.0ee6c1f0.js"></script>
<script src="/blog-vue-source/assets/js/main.d722cc53.js"></script>
</body>
</html>