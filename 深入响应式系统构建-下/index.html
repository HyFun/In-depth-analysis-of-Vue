<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹ | æ·±å…¥å‰–æVueæºç </title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹ | æ·±å…¥å‰–æVueæºç "><meta data-react-helmet="true" name="description" content="ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬æ·±å…¥åˆ†æäº†ä»¥`data,computed`ä¸ºæ•°æ®åˆ›å»ºå“åº”å¼ç³»ç»Ÿçš„è¿‡ç¨‹ï¼Œå¹¶å¯¹å…¶ä¸­ä¾èµ–æ”¶é›†å’Œæ´¾å‘æ›´æ–°çš„è¿‡ç¨‹è¿›è¡Œäº†è¯¦ç»†çš„åˆ†æã€‚ç„¶è€Œåœ¨ä½¿ç”¨å’Œåˆ†æè¿‡ç¨‹ä¸­ä¾ç„¶å­˜åœ¨æˆ–å¤šæˆ–å°‘çš„é—®é¢˜ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬å°†é’ˆå¯¹è¿™äº›é—®é¢˜å±•å¼€åˆ†æï¼Œæœ€åæˆ‘ä»¬ä¹Ÿä¼šåˆ†æä¸€ä¸‹`watch`çš„å“åº”å¼è¿‡ç¨‹ã€‚è¿™ç¯‡æ–‡ç« å°†ä½œä¸ºå“åº”å¼ç³»ç»Ÿåˆ†æçš„å®Œç»“ç¯‡ã€‚"><meta data-react-helmet="true" property="og:description" content="ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬æ·±å…¥åˆ†æäº†ä»¥`data,computed`ä¸ºæ•°æ®åˆ›å»ºå“åº”å¼ç³»ç»Ÿçš„è¿‡ç¨‹ï¼Œå¹¶å¯¹å…¶ä¸­ä¾èµ–æ”¶é›†å’Œæ´¾å‘æ›´æ–°çš„è¿‡ç¨‹è¿›è¡Œäº†è¯¦ç»†çš„åˆ†æã€‚ç„¶è€Œåœ¨ä½¿ç”¨å’Œåˆ†æè¿‡ç¨‹ä¸­ä¾ç„¶å­˜åœ¨æˆ–å¤šæˆ–å°‘çš„é—®é¢˜ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬å°†é’ˆå¯¹è¿™äº›é—®é¢˜å±•å¼€åˆ†æï¼Œæœ€åæˆ‘ä»¬ä¹Ÿä¼šåˆ†æä¸€ä¸‹`watch`çš„å“åº”å¼è¿‡ç¨‹ã€‚è¿™ç¯‡æ–‡ç« å°†ä½œä¸ºå“åº”å¼ç³»ç»Ÿåˆ†æçš„å®Œç»“ç¯‡ã€‚"><link data-react-helmet="true" rel="shortcut icon" href="/blog-vue-source/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹" hreflang="x-default"><link rel="stylesheet" href="/blog-vue-source/assets/css/styles.6d09dbb1.css">
<link rel="preload" href="/blog-vue-source/assets/js/runtime~main.0ee6c1f0.js" as="script">
<link rel="preload" href="/blog-vue-source/assets/js/main.d722cc53.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/blog-vue-source/"><img src="/blog-vue-source/img/logo.svg" alt="æ·±å…¥å‰–æVueæºç " class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/blog-vue-source/img/logo.svg" alt="æ·±å…¥å‰–æVueæºç " class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">æ·±å…¥å‰–æVueæºç </b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Ocean1509/In-depth-analysis-of-Vue" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ç›®å½•">ç›®å½•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ä¸°å¯Œçš„é€‰é¡¹åˆå¹¶ç­–ç•¥">ä¸°å¯Œçš„é€‰é¡¹åˆå¹¶ç­–ç•¥</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/åŸºç¡€çš„æ•°æ®ä»£ç†æ£€æµ‹">åŸºç¡€çš„æ•°æ®ä»£ç†æ£€æµ‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/å®ä¾‹æŒ‚è½½æµç¨‹å’Œæ¨¡æ¿ç¼–è¯‘">å®ä¾‹æŒ‚è½½æµç¨‹å’Œæ¨¡æ¿ç¼–è¯‘</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/å®Œæ•´æ¸²æŸ“æµç¨‹">å®Œæ•´æ¸²æŸ“æµç¨‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ç»„ä»¶åŸºç¡€å‰–æ">ç»„ä»¶åŸºç¡€å‰–æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ç»„ä»¶é«˜çº§ç”¨æ³•">ç»„ä»¶é«˜çº§ç”¨æ³•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•">æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶">æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ">vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/ä½ çœŸçš„äº†è§£v-modelçš„è¯­æ³•ç³–äº†å—">ä½ çœŸçš„äº†è§£v-modelçš„è¯­æ³•ç³–äº†å—</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ">åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/blog-vue-source/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹</h1></header><blockquote><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬æ·±å…¥åˆ†æäº†ä»¥<code>data,computed</code>ä¸ºæ•°æ®åˆ›å»ºå“åº”å¼ç³»ç»Ÿçš„è¿‡ç¨‹ï¼Œå¹¶å¯¹å…¶ä¸­ä¾èµ–æ”¶é›†å’Œæ´¾å‘æ›´æ–°çš„è¿‡ç¨‹è¿›è¡Œäº†è¯¦ç»†çš„åˆ†æã€‚ç„¶è€Œåœ¨ä½¿ç”¨å’Œåˆ†æè¿‡ç¨‹ä¸­ä¾ç„¶å­˜åœ¨æˆ–å¤šæˆ–å°‘çš„é—®é¢˜ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬å°†é’ˆå¯¹è¿™äº›é—®é¢˜å±•å¼€åˆ†æï¼Œæœ€åæˆ‘ä»¬ä¹Ÿä¼šåˆ†æä¸€ä¸‹<code>watch</code>çš„å“åº”å¼è¿‡ç¨‹ã€‚è¿™ç¯‡æ–‡ç« å°†ä½œä¸ºå“åº”å¼ç³»ç»Ÿåˆ†æçš„å®Œç»“ç¯‡ã€‚</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="712-æ•°ç»„æ£€æµ‹"></a>7.12 æ•°ç»„æ£€æµ‹<a class="hash-link" href="#712-æ•°ç»„æ£€æµ‹" title="Direct link to heading">#</a></h2><p>åœ¨ä¹‹å‰ä»‹ç»æ•°æ®ä»£ç†ç« èŠ‚ï¼Œæˆ‘ä»¬å·²ç»è¯¦ç»†ä»‹ç»è¿‡<code>Vue</code>æ•°æ®ä»£ç†çš„æŠ€æœ¯æ˜¯åˆ©ç”¨äº†<code>Object.defineProperty</code>,<code>Object.defineProperty</code>è®©æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„åˆ©ç”¨å­˜å–æè¿°ç¬¦ä¸­çš„<code>getter/setter</code>æ¥è¿›è¡Œæ•°æ®çš„ç›‘å¬,åœ¨<code>get,set</code>é’©å­ä¸­åˆ†åˆ«åšä¸åŒçš„æ“ä½œï¼Œè¾¾åˆ°æ•°æ®æ‹¦æˆªçš„ç›®çš„ã€‚ç„¶è€Œ<code>Object.defineProperty</code>çš„<code>get,set</code>æ–¹æ³•åªèƒ½æ£€æµ‹åˆ°å¯¹è±¡å±æ€§çš„å˜åŒ–ï¼Œå¯¹äºæ•°ç»„çš„å˜åŒ–(ä¾‹å¦‚æ’å…¥åˆ é™¤æ•°ç»„å…ƒç´ ç­‰æ“ä½œ)ï¼Œ<code>Object.defineProperty</code>å´æ— æ³•è¾¾åˆ°ç›®çš„,è¿™ä¹Ÿæ˜¯åˆ©ç”¨<code>Object.defineProperty</code>è¿›è¡Œæ•°æ®ç›‘æ§çš„ç¼ºé™·ï¼Œè™½ç„¶<code>es6</code>ä¸­çš„<code>proxy</code>å¯ä»¥å®Œç¾è§£å†³è¿™ä¸€é—®é¢˜ï¼Œä½†æ¯•ç«Ÿæœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ç ”ç©¶<code>Vue</code>åœ¨<code>Object.defineProperty</code>çš„åŸºç¡€ä¸Šå¦‚ä½•å¯¹æ•°ç»„è¿›è¡Œç›‘å¬æ£€æµ‹ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="7121-æ•°ç»„æ–¹æ³•çš„é‡å†™"></a>7.12.1 æ•°ç»„æ–¹æ³•çš„é‡å†™<a class="hash-link" href="#7121-æ•°ç»„æ–¹æ³•çš„é‡å†™" title="Direct link to heading">#</a></h3><p>æ—¢ç„¶æ•°ç»„å·²ç»ä¸èƒ½å†é€šè¿‡æ•°æ®çš„<code>getter,setter</code>æ–¹æ³•å»ç›‘å¬å˜åŒ–äº†ï¼Œ<code>Vue</code>çš„åšæ³•æ˜¯å¯¹æ•°ç»„æ–¹æ³•è¿›è¡Œé‡å†™ï¼Œåœ¨ä¿ç•™åŸæ•°ç»„åŠŸèƒ½çš„å‰æä¸‹ï¼Œå¯¹æ•°ç»„è¿›è¡Œé¢å¤–çš„æ“ä½œå¤„ç†ã€‚ä¹Ÿå°±æ˜¯é‡æ–°å®šä¹‰äº†æ•°ç»„æ–¹æ³•ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> arrayProto </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// æ–°å»ºä¸€ä¸ªç»§æ‰¿äºArrayçš„å¯¹è±¡</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> arrayMethods </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arrayProto</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// æ•°ç»„æ‹¥æœ‰çš„æ–¹æ³•</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> methodsToPatch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;push&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;pop&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;shift&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;unshift&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;splice&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;sort&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;reverse&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>arrayMethods</code>æ˜¯åŸºäºåŸå§‹<code>Array</code>ç±»ä¸ºåŸå‹ç»§æ‰¿çš„ä¸€ä¸ªå¯¹è±¡ç±»ï¼Œç”±äºåŸå‹é“¾çš„ç»§æ‰¿ï¼Œ<code>arrayMethod</code>æ‹¥æœ‰æ•°ç»„çš„æ‰€æœ‰æ–¹æ³•ï¼Œæ¥ä¸‹æ¥å¯¹è¿™ä¸ªæ–°çš„æ•°ç»„ç±»çš„æ–¹æ³•è¿›è¡Œæ”¹å†™ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">methodsToPatch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ç¼“å†²åŸå§‹æ•°ç»„çš„æ–¹æ³•</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> original </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> arrayProto</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// åˆ©ç”¨Object.definePropertyå¯¹æ–¹æ³•çš„æ‰§è¡Œè¿›è¡Œæ”¹å†™</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">def</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arrayMethods</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mutator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">def</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">obj</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> key</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> val</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> enumerable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">defineProperty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      enumerable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">enumerable</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      writable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      configurable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¿™é‡Œå¯¹æ•°ç»„æ–¹æ³•è®¾ç½®äº†ä»£ç†ï¼Œå½“æ‰§è¡Œ<code>arrayMethods</code>çš„æ•°ç»„æ–¹æ³•æ—¶ï¼Œä¼šä»£ç†æ‰§è¡Œ<code>mutator</code>å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„å…·ä½“å®ç°ï¼Œæˆ‘ä»¬æ”¾åˆ°æ•°ç»„çš„æ´¾å‘æ›´æ–°ä¸­ä»‹ç»ã€‚</p><p><strong>ä»…ä»…åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„æ–¹æ³•åˆé›†æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬åœ¨è®¿é—®æ•°ç»„æ—¶ï¼Œå¦‚ä½•ä¸è°ƒç”¨åŸç”Ÿçš„æ•°ç»„æ–¹æ³•ï¼Œè€Œæ˜¯å°†è¿‡ç¨‹æŒ‡å‘è¿™ä¸ªæ–°çš„ç±»ï¼Œè¿™æ˜¯ä¸‹ä¸€æ­¥çš„é‡ç‚¹ã€‚</strong></p><p>å›åˆ°æ•°æ®åˆå§‹åŒ–è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œ<code>initData</code>é˜¶æ®µï¼Œä¸Šä¸€ç¯‡å†…å®¹èŠ±äº†å¤§ç¯‡å¹…ä»‹ç»è¿‡æ•°æ®åˆå§‹åŒ–ä¼šä¸º<code>data</code>æ•°æ®åˆ›å»ºä¸€ä¸ª<code>Observer</code>ç±»ï¼Œå½“æ—¶æˆ‘ä»¬åªè®²è¿°äº†<code>Observer</code>ç±»ä¼šä¸ºæ¯ä¸ªéæ•°ç»„çš„å±æ€§è¿›è¡Œæ•°æ®æ‹¦æˆªï¼Œé‡æ–°å®šä¹‰<code>getter,setter</code>æ–¹æ³•,é™¤æ­¤ä¹‹å¤–å¯¹äºæ•°ç»„ç±»å‹çš„æ•°æ®ï¼Œæˆ‘ä»¬æœ‰æ„è·³è¿‡åˆ†æäº†ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é‡ç‚¹çœ‹çœ‹å¯¹äºæ•°ç»„æ‹¦æˆªçš„å¤„ç†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">Observer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Observer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dep</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Dep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">vmCount</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å°†__ob__å±æ€§è®¾ç½®æˆä¸å¯æšä¸¾å±æ€§ã€‚å¤–éƒ¨æ— æ³•é€šè¿‡éå†è·å–ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">def</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__ob__&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ•°ç»„å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hasProto</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">protoAugment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arrayMethods</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">copyAugment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arrayMethods</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arrayKeys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">observeArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å¯¹è±¡å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">walk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ•°ç»„å¤„ç†çš„åˆ†æ”¯åˆ†ä¸ºä¸¤ä¸ªï¼Œ<code>hasProto</code>çš„åˆ¤æ–­æ¡ä»¶ï¼Œ<code>hasProto</code>ç”¨æ¥åˆ¤æ–­å½“å‰ç¯å¢ƒä¸‹æ˜¯å¦æ”¯æŒ<code>__proto__</code>å±æ€§ã€‚è€Œæ•°ç»„çš„å¤„ç†ä¼šæ ¹æ®æ˜¯å¦æ”¯æŒè¿™ä¸€å±æ€§æ¥å†³å®šæ‰§è¡Œ<code>protoAugment, copyAugment</code>è¿‡ç¨‹ï¼Œ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// __proto__å±æ€§çš„åˆ¤æ–­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> hasProto </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__proto__&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>å½“æ”¯æŒ<code>__proto__</code>æ—¶ï¼Œæ‰§è¡Œ<code>protoAugment</code>ä¼šå°†å½“å‰æ•°ç»„çš„åŸå‹æŒ‡å‘æ–°çš„æ•°ç»„ç±»<code>arrayMethods</code>,å¦‚æœä¸æ”¯æŒ<code>__proto__</code>ï¼Œåˆ™é€šè¿‡ä»£ç†è®¾ç½®ï¼Œåœ¨è®¿é—®æ•°ç»„æ–¹æ³•æ—¶ä»£ç†è®¿é—®æ–°æ•°ç»„ç±»ä¸­çš„æ•°ç»„æ–¹æ³•ã€‚</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//ç›´æ¥é€šè¿‡åŸå‹æŒ‡å‘çš„æ–¹å¼</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">protoAugment</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">target</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> src</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">__proto__</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// é€šè¿‡æ•°æ®ä»£ç†çš„æ–¹å¼</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">copyAugment</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">target</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> src</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">def</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> src</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æœ‰äº†è¿™ä¸¤æ­¥çš„å¤„ç†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨å®ä¾‹å†…éƒ¨è°ƒç”¨<code>push, unshift</code>ç­‰æ•°ç»„çš„æ–¹æ³•æ—¶ï¼Œä¼šæ‰§è¡Œ<code>arrayMethods</code>ç±»çš„æ–¹æ³•ã€‚è¿™ä¹Ÿæ˜¯æ•°ç»„è¿›è¡Œä¾èµ–æ”¶é›†å’Œæ´¾å‘æ›´æ–°çš„å‰æã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="7122-ä¾èµ–æ”¶é›†"></a>7.12.2 ä¾èµ–æ”¶é›†<a class="hash-link" href="#7122-ä¾èµ–æ”¶é›†" title="Direct link to heading">#</a></h3><p>ç”±äºæ•°æ®åˆå§‹åŒ–é˜¶æ®µä¼šåˆ©ç”¨<code>Object.definePrototype</code>è¿›è¡Œæ•°æ®è®¿é—®çš„æ”¹å†™ï¼Œæ•°ç»„çš„è®¿é—®åŒæ ·ä¼šè¢«<code>getter</code>æ‰€æ‹¦æˆªã€‚ç”±äºæ˜¯æ•°ç»„ï¼Œæ‹¦æˆªè¿‡ç¨‹ä¼šåšç‰¹æ®Šå¤„ç†ï¼Œåé¢æˆ‘ä»¬å†çœ‹çœ‹<code>dependArray</code>çš„åŸç†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> defineReactive###</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> childOb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">shallow </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">val</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">defineProperty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        enumerable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        configurable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function-variable function" style="color:#d73a49">get</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">reactiveGetter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> getter </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> getter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Dep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            dep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">depend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">childOb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">              childOb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">depend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">dependArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> value</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>childOb</code>æ˜¯æ ‡å¿—å±æ€§å€¼æ˜¯å¦ä¸ºåŸºç¡€ç±»å‹çš„æ ‡å¿—ï¼Œ<code>observe</code>å¦‚æœé‡åˆ°åŸºæœ¬ç±»å‹æ•°æ®ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œä¸åšä»»ä½•å¤„ç†ï¼Œå¦‚æœé‡åˆ°å¯¹è±¡æˆ–è€…æ•°ç»„åˆ™ä¼šé€’å½’å®ä¾‹åŒ–<code>Observer</code>ï¼Œä¼šä¸ºæ¯ä¸ªå­å±æ€§è®¾ç½®å“åº”å¼æ•°æ®ï¼Œæœ€ç»ˆè¿”å›<code>Observer</code>å®ä¾‹ã€‚è€Œå®ä¾‹åŒ–<code>Observer</code>åˆå›åˆ°ä¹‹å‰çš„è€æµç¨‹ï¼š
<strong>æ·»åŠ <code>__ob__</code>å±æ€§ï¼Œå¦‚æœé‡åˆ°æ•°ç»„åˆ™è¿›è¡ŒåŸå‹é‡æŒ‡å‘ï¼Œé‡åˆ°å¯¹è±¡åˆ™å®šä¹‰<code>getter,setter</code>ï¼Œè¿™ä¸€è¿‡ç¨‹å‰é¢åˆ†æè¿‡ï¼Œå°±ä¸å†é˜è¿°ã€‚</strong></p><p>åœ¨è®¿é—®åˆ°æ•°ç»„æ—¶ï¼Œç”±äº<code>childOb</code>çš„å­˜åœ¨ï¼Œä¼šæ‰§è¡Œ<code>childOb.dep.depend();</code>è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œè¯¥<code>Observer</code>å®ä¾‹çš„<code>dep</code>å±æ€§ä¼šæ”¶é›†å½“å‰çš„<code>watcher</code>ä½œä¸ºä¾èµ–ä¿å­˜ï¼Œ<code>dependArray</code>ä¿è¯äº†å¦‚æœæ•°ç»„å…ƒç´ æ˜¯æ•°ç»„æˆ–è€…å¯¹è±¡ï¼Œéœ€è¦é€’å½’å»ä¸ºå†…éƒ¨çš„å…ƒç´ æ”¶é›†ç›¸å…³çš„ä¾èµ–ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dependArray</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> e </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      e </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      e </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">__ob__</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">__ob__</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">depend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">dependArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æˆªå›¾çœ‹æœ€ç»ˆä¾èµ–æ”¶é›†çš„ç»“æœã€‚</p><p>æ”¶é›†å‰</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUkAAAD+CAMAAACA7AfjAAABxVBMVEUfHx8gICAlAMc7OztISEhNL9FOTk5PT09QUFBcXFxdXV1hRtZiR9dpaWlqampra2tsbGxtbW1ubm5vb29wWNpxcXFzc3N0dHR1dXV2dnZ3d3d4eHh5eXl7DoZ7e3t8fHx9Z95+fn5/f3+BgYGDg4OFhYWGhoaHh4eIiIiJdeGJiYmKioqLK5WMjIyOjo6Pj4+QkJCRkZGSkpKTk5OUguSWlpaXQaCXQqCcnJyenp6hVKmlpaWnp6eomemoqKipqamqY7Gqqqqvr6+wbrawsLCxcbixpOuzs7O1tbW2tra5fr66gL+6urq7u7u8vLy+h8O/v7/AjMXAwMDBjcXBjcbGl8vHmMvIyMjLy8vModDMotDNxPLOzs7Pz8/RqtTS0tLTr9fT09PU1NTVstjY2NjZudza2trb29vdwODd3d3ew+He2Pbe3t7hx+Ph4eHi4uLlz+fm5ubn5+fq2Ozq6urr2+3t7e3u7u7v7Pvv7+/w8PDx8fHy6PPz6fTz8/P17Pb19fX29vb39v339/f4+Pj59Pn5+fn69vr6+vr7ODj7TEz7+/v8YGD8c3P8+fz8/Pz9h4f9m5v9s7P9/f3+z8/+/v7///9vZwGIAAAMO0lEQVR42u3dgV8bZxkH8AQYUlZolblqSyautuKk05tB1nWamFim6eystiMEt7XGWZMWu4kY2uKQBsqOQQcM3r/X53neu8vd5S4kEGg5fs/ncyS5hK18P8/zvndvLk9ij75WiDbE17GvgNCeiIEAkpCEJAKSkIya5HBPBU77k1wciMcHFiG5b8nFgYFF3iC5X8m7nRNKpTrvDvdQbvLdeDw+zLvlJjXwSWc8dbczpdQEPTtBT6YIP5WKd96FpDcmmISUhomI8lLQlKr0pBTfTXUOU7Z+PsDlP7DI6vTSxYFv/a7SMwzJEEmqbkrNSk9c74hL+qU4TeVFbJuSvSR5fEeCRpJxu7pFktMx3lOZ0IJ6Dw+mqQn7eT20QjJwxuFSJclKjxaSItd3LTsaL38wzOrDkAwPykEGGo7LwRDPNJyPfEuKtmSlR+5w0fdUIImAJCQheTTDtDbXQ/fjuh1mwNO+XwmT/G20w3R+BD2s32EGPe/d5YrjlpN2Rpk69K07AWsZZ9bCnYxm1Kp7e8u+t76mb7c2nCc3adswzXXP60zlpTE9uKa/+k0PrOmNCEmumz7JTdO0JTeZcGOVntlwvy5sGDTdjxwpv3t0Z5z1Lf+eDScnt0jS3KZ8JIO1rcAcU67iNk1H0p2sQcW+a31HT3Jrle+sbvkkTdcMbDqPHDrTXeG+nPRxR0ByQ/9p61urJuddraotyXXasa42peTXNkjSlNfZSKaDYsGZniR0S/pyMmqSG2vabJ14Ntfduahv12nfmluS/m56YBmYrrLdVdI3Qdnj554kC7kX71Bmu1bdWwGS/PyWJyeVx07ZxarHSReh6bwq9ED+4CQzsVis91BXdbdN1VBSnq+Nk5tacnXbGijdDl4a01RuyfqjnpYkn779859x/OLznSYlDdoOl1L+jO0GOWnN3TTZ1OZuz/FjrXhVfXX70tD0T/ZNSu588r0+iv7LiyxZSCQSJDkzkkiU1UL6tjxSlV7DK1kdzNPOWCyjlPF+74GnKI+D22vhknQMqVZp/+aqFDePmTK21h+Ju+cg5dnvOeCsL/ZmqvtpaqCv79SFyjcMmV7hnFxIL/C2MJZeWXhnJkBSGZnqxZLizeiiLXPASblmmqsyg29v87S9yamyqad0mcVpSteH5vocZ2NTXu+asYOOHVV90tZK2tyDpPrirVP9r/6VIVfSZanuMmVmYmRGFHPlgOomu1IXjZexvCjmjRd6Kcj0HuB4aNwF7jkIN83gJG4kuXP3tYHfyyDpSOqhMlySqrt0sSoPj4CkClw0M1X9tK3C1tiaWVWj+Cp/yXoPJsf5mKNhsmxLzryzEFDdxmC10puxJXnUxEqvprTfzFoYS6Q/pYTk8qYxcoxrvG7GoaLmh1zeNNUYMZl4INkopLp3C+OYM0ISkkdSEgFJSEISkohDkiwnyi3M4pDco+R4R0cSiq1Wd4BkcugJDJuUXEnrs2779Ntz9j03NAfC5nNSUnFhrKzq13unhn7S0TEOxVYky7SOXl/dUx1Tau6Ve2DcvyQNk0+GpsDYguTML2dW0vXjJOXjvVcwVjYlyTMNTzX0fuOnV/2SVN4dL6G4cY4DSUhCEgFJSEISkghIvuiSf/sy5PW5QqP/WkZf4mIcx0tbQiRfG330zV4k7TNJA5JWnPn2+Y+eQrIdkn39Z979j6QlX7FWkAUh3nK3xxJjdAlgzrqALUMX80KyoWRf36vvcufZlauyKOlIkh/l5czVFcsOkk3nZC5RcEvSA7rYd2FsZAbV3fI4WaALfH2S8k5ZGZKtzt1Uy/yOmFXZch06AxdQ3a0cT9rvztKa+S0aMnMy/1gXTkPywM5xIAnJF04SZ4sISEISkghIPh/Jf+Frc9okeeGP/9s50P9v6bTdoaDUlYmy5JnvXvl3C2n5bHK26dca8uHbxpJH8RPOoatqp35U+nLnACQzg1XeapJBESnJvr5zfwjIyuJnN7M3l9X8x//IZqeVms1ms7Nqmn5mr80TaDY7+azud/KxmkvldEl+lC5e4ROh6qA0f5BMJWL5uHhGPjwe8yyNHHHJ6wFfe1cksOK0mr9G24fLs4z653krJ59Nkm2x2FBScpHbPnQZdoUb9GwmI1upK39sqrvIiVhkRX40Pa0rW0suT9LO2YCk9M80LEm33NRFS0pq0im7vQISJcmwGWe/kk51eyX1vShKXvhTyFEQSTKbJcnVzZsAS3VLhTeobmUYsrFkfrBqV7eh75ZOWIPjEVyVa/XIvJiVmcaS5LmGBk56fI1vl29ms/XDpFeSC5nYrE4ktqQ98+StziT0dERmnNAoTrf7XxCV7jjPX9Kp6KhLXuNjxewHH2T1MWMTknJ0mc0W9G/eXG7I2BWLRaRhE9aCIAlJSCIgeciSpS/CXpJLBFxLVR8P3nxcu395yXtoHtPnMAcR97//sOnX7uHUiY4ummub60i+9cY/w85r7EuqGsbjH99Ramn07NnXH9Cj61c8ktpx7mRHwEfBk0E9Segzus12KmlKUq/W7e0ktPFSar3kpdNnf/1oH5JXrlt3BHFp9E6d5L2Xp07WS04lSTjos/bN9jJoRrLSm5ftcCT7+r/z04+e7uiWF9IFla9LKzuSfOUkb3TRGl8e7T2bdtW2Jr0zulSXkyFklJZBrTR2/wT+aHd3/0N1/9JvurvfCzgJdQ0ossZEP+wW14ZeSLbOC/ReOdfif2lGVgSqF9/v0mNS65LUO/qHf5cm3Dmnn7lcBe2R5MtQ5VJUr+QdXc4PXj+rCR+/+aBpyaDso5rfrSnE6KhS752v3j8xGpSXHknJRfpXWC2ure7ClcGKbAY3dc3Ii2jjdsO08e/rJYG95yS33pary7mtOaefR5ITVV866Ynr1517Qrl0uWnJJ0OB3V3CEtihunRfSpsV5f5uMw1L6sbMlV5ZaMpbb3JYNU++4sp7bcW9jZPnnHEyV+ZcpNYXutWxVzJ4zKxJPh593JJkCCS1xxpvm6RT3XaLa1rFyzvNri1JWm7mPYb/DZBWJd1z98yNAnmVKR9zrpzkjtIFVZBBMqy6nZzUnsGSefc1gXMnLbCMbylDXlwdDD8E4eoe1ZX9l/PVhtXNYyBvrhbXrneN7Hkon3m75HwHw94l3ceTK+m0DI+JxA0q9HRCZh767oL0rYKyr48OnHFomDyrSQNmHDoI0v1H+N2wWubRzo6Tcz7fpN2pxAhf8K2e7+4mwfsnZOJpKCmFnFd2i+t8TB/gWre2pNUsRb9o75L7DecoSCLoKMj1R2ZCjlTqI9/73L/G+rAl5ci8NmwGHZnbg1bgBb9G0Dplpff5Qx66pOcM8UDOFh/2d3OceENufIeQDZ/cl2PLZ4sIrAVBEpIISEISkpD0hb1OGRiBXyfIJ4ZTkPSFPglXrUhyw9lj1743QNJeM8/dGsnlEmVZWFN6QUN/faD+CsEbvJDBX8koCxqeBQNu3zt13HpKx0LSjLbcWHmkkCuUdUqupAuysmZL0rcwirGVkx7J8aQaH/pVEpLWmnmuwIlZKGhJ/h5L7iBtS1p9MQKrezyZTDInxkm9Zm5JlvXSbiuSUtlJVLe9Zm5JrqRzdnXzRik6M+KStIrfU93SnPtlzDj2dG1JylTD3/Q7Jl/0Szdjt12S/Kx/xlH3Xjp+zblxZA5JSEISAUlIQhKSiLZIhl8d3a6IXuuLYMkGV0cHRrtbX8jHlSMh2eDq6P1KNtX6IkKStStRvbE8+Zl81ni2WOSeF/y5ZPosYrtbX8j1ny/ARUBtkXSujvZJ3px8tvzhPDUPmeWGAtznYprs2t364jjkJCmq4qzVluHZx/P6c/Ltbn0RpXHyXPA4uW/J5lpfREcydO5mSaazvLiUpZzb3PriyLce2P14kptbcK8LS9KZYtrd+iIflRknNKS62xtRaX3x/CWj0vpiV0lvH4v/NiF5TFtfYAUDkpCEJAKSkIQkApKQhCQkEZCEJCQhiYAkJCGJgCQkIQlJBCQhCUkEJCEJSUgiIAlJSEISAUlIQhIBSUhCEpIISEISkghIQhKSkERAEpKQREASkpCEJAKSkIQkJBGQhCQkEZCEJCQhiYAkJCGJgCQkIQlJBCQhCUlIIiAJSUgiIAlJSEISAUlIQhIBSUhCEpIISEISkghIQhKSkERAEpKQhCQCkpCEJAKSkIQkJBEtx/8BkM5NbaFY67AAAAAASUVORK5CYII="></p><p>æ”¶é›†å</p><p><img src="data:image/png;base64,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"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="7123-æ´¾å‘æ›´æ–°"></a>7.12.3 æ´¾å‘æ›´æ–°<a class="hash-link" href="#7123-æ´¾å‘æ›´æ–°" title="Direct link to heading">#</a></h3><p>å½“è°ƒç”¨æ•°ç»„çš„æ–¹æ³•å»æ·»åŠ æˆ–è€…åˆ é™¤æ•°æ®æ—¶ï¼Œæ•°æ®çš„<code>setter</code>æ–¹æ³•æ˜¯æ— æ³•æ‹¦æˆªçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å”¯ä¸€å¯ä»¥æ‹¦æˆªçš„è¿‡ç¨‹å°±æ˜¯è°ƒç”¨æ•°ç»„æ–¹æ³•çš„æ—¶å€™ï¼Œå‰é¢ä»‹ç»è¿‡ï¼Œæ•°ç»„æ–¹æ³•çš„è°ƒç”¨ä¼šä»£ç†åˆ°æ–°ç±»<code>arrayMethods</code>çš„æ–¹æ³•ä¸­,è€Œ<code>arrayMethods</code>çš„æ•°ç»„æ–¹æ³•æ˜¯è¿›è¡Œé‡å†™è¿‡çš„ã€‚å…·ä½“æˆ‘ä»¬çœ‹ä»–çš„å®šä¹‰ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"> methodsToPatch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> original </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> arrayProto</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">def</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arrayMethods</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mutator</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> args </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> len </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> arguments</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> len</span><span class="token operator" style="color:#393A34">--</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> len </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> arguments</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> len </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰§è¡ŒåŸæ•°ç»„æ–¹æ³•</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> original</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ob </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">__ob__</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> inserted</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;push&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;unshift&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          inserted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">break</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;splice&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          inserted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">break</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">inserted</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> ob</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">observeArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">inserted</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// notify change</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ob</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">notify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> result</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>mutator</code>æ˜¯é‡å†™çš„æ•°ç»„æ–¹æ³•ï¼Œé¦–å…ˆä¼šè°ƒç”¨åŸå§‹çš„æ•°ç»„æ–¹æ³•è¿›è¡Œè¿ç®—ï¼Œè¿™ä¿è¯äº†ä¸åŸå§‹æ•°ç»„ç±»å‹çš„æ–¹æ³•ä¸€è‡´æ€§ï¼Œ<code>args</code>ä¿å­˜äº†æ•°ç»„æ–¹æ³•è°ƒç”¨ä¼ é€’çš„å‚æ•°ã€‚ä¹‹åå–å‡ºæ•°ç»„çš„<code>__ob__</code>ä¹Ÿå°±æ˜¯ä¹‹å‰ä¿å­˜çš„<code>Observer</code>å®ä¾‹ï¼Œè°ƒç”¨<code>ob.dep.notify();</code>è¿›è¡Œä¾èµ–çš„æ´¾å‘æ›´æ–°ï¼Œå‰é¢çŸ¥é“äº†ã€‚<code>Observer</code>å®ä¾‹çš„<code>dep</code>æ˜¯<code>Dep</code>çš„å®ä¾‹ï¼Œä»–æ”¶é›†äº†éœ€è¦ç›‘å¬çš„<code>watcher</code>ä¾èµ–ï¼Œè€Œ<code>notify</code>ä¼šå¯¹ä¾èµ–è¿›è¡Œé‡æ–°è®¡ç®—å¹¶æ›´æ–°ã€‚å…·ä½“çœ‹<code>Dep.prototype.notify = function notify () {}</code>å‡½æ•°çš„åˆ†æï¼Œè¿™é‡Œä¹Ÿä¸é‡å¤èµ˜è¿°ã€‚</p><p>å›åˆ°ä»£ç ä¸­ï¼Œ<code>inserted</code>å˜é‡ç”¨æ¥æ ‡å¿—æ•°ç»„æ˜¯å¦æ˜¯å¢åŠ äº†å…ƒç´ ï¼Œå¦‚æœå¢åŠ çš„å…ƒç´ ä¸æ˜¯åŸå§‹ç±»å‹ï¼Œè€Œæ˜¯æ•°ç»„å¯¹è±¡ç±»å‹ï¼Œåˆ™éœ€è¦è§¦å‘<code>observeArray</code>æ–¹æ³•ï¼Œå¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œä¾èµ–æ”¶é›†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token class-name">Observer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">observeArray</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">observeArray</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">items</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> items</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> l</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">items</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>æ€»çš„æ¥è¯´ã€‚æ•°ç»„çš„æ”¹å˜ä¸ä¼šè§¦å‘<code>setter</code>è¿›è¡Œä¾èµ–æ›´æ–°ï¼Œæ‰€ä»¥<code>Vue</code>åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æ•°ç»„ç±»ï¼Œé‡å†™äº†æ•°ç»„çš„æ–¹æ³•ï¼Œå°†æ•°ç»„æ–¹æ³•æŒ‡å‘äº†æ–°çš„æ•°ç»„ç±»ã€‚åŒæ—¶åœ¨è®¿é—®åˆ°æ•°ç»„æ—¶ä¾æ—§è§¦å‘<code>getter</code>è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œåœ¨æ›´æ”¹æ•°ç»„æ—¶ï¼Œè§¦å‘æ•°ç»„æ–°æ–¹æ³•è¿ç®—ï¼Œå¹¶è¿›è¡Œä¾èµ–çš„æ´¾å‘ã€‚</strong></p><p>ç°åœ¨æˆ‘ä»¬å›è¿‡å¤´çœ‹çœ‹Vueçš„å®˜æ–¹æ–‡æ¡£å¯¹äºæ•°ç»„æ£€æµ‹æ—¶çš„æ³¨æ„äº‹é¡¹ï¼š</p><blockquote><p><code>Vue</code> ä¸èƒ½æ£€æµ‹ä»¥ä¸‹æ•°ç»„çš„å˜åŠ¨:</p><ul><li>å½“ä½ åˆ©ç”¨ç´¢å¼•ç›´æ¥è®¾ç½®ä¸€ä¸ªæ•°ç»„é¡¹æ—¶ï¼Œä¾‹å¦‚ï¼š<code>vm.items[indexOfItem] = newValue</code></li><li>å½“ä½ ä¿®æ”¹æ•°ç»„çš„é•¿åº¦æ—¶ï¼Œä¾‹å¦‚ï¼š<code>vm.items.length = newLength</code></li></ul></blockquote><p>æ˜¾ç„¶æœ‰äº†ä¸Šè¿°çš„åˆ†ææˆ‘ä»¬å¾ˆå®¹æ˜“ç†è§£æ•°ç»„æ£€æµ‹å¸¦æ¥çš„å¼Šç«¯ï¼Œå³ä½¿<code>Vue</code>é‡å†™äº†æ•°ç»„çš„æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨è®¾ç½®æ•°ç»„æ—¶è¿›è¡Œæ‹¦æˆªå¤„ç†ï¼Œä½†æ˜¯ä¸ç®¡æ˜¯é€šè¿‡ç´¢å¼•è¿˜æ˜¯ç›´æ¥ä¿®æ”¹é•¿åº¦ï¼Œéƒ½æ˜¯æ— æ³•è§¦å‘ä¾èµ–æ›´æ–°çš„ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="713-å¯¹è±¡æ£€æµ‹å¼‚å¸¸"></a>7.13 å¯¹è±¡æ£€æµ‹å¼‚å¸¸<a class="hash-link" href="#713-å¯¹è±¡æ£€æµ‹å¼‚å¸¸" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­ç»å¸¸é‡åˆ°ä¸€ç§åœºæ™¯ï¼Œå¯¹è±¡<code>test: { a: 1 }</code>è¦æ·»åŠ ä¸€ä¸ªå±æ€§<code>b</code>,è¿™æ—¶å¦‚æœæˆ‘ä»¬ä½¿ç”¨<code>test.b = 2</code>çš„æ–¹å¼å»æ·»åŠ ï¼Œè¿™ä¸ªè¿‡ç¨‹<code>Vue</code>æ˜¯æ— æ³•æ£€æµ‹åˆ°çš„ï¼Œç†ç”±ä¹Ÿå¾ˆç®€å•ã€‚æˆ‘ä»¬åœ¨å¯¹å¯¹è±¡è¿›è¡Œä¾èµ–æ”¶é›†çš„æ—¶å€™ï¼Œä¼šä¸ºå¯¹è±¡çš„æ¯ä¸ªå±æ€§éƒ½è¿›è¡Œæ”¶é›†ä¾èµ–ï¼Œè€Œç›´æ¥é€šè¿‡<code>test.b</code>æ·»åŠ çš„æ–°å±æ€§å¹¶æ²¡æœ‰ä¾èµ–æ”¶é›†çš„è¿‡ç¨‹ï¼Œå› æ­¤å½“ä¹‹åæ•°æ®<code>b</code>å‘ç”Ÿæ”¹å˜æ—¶ä¹Ÿä¸ä¼šè¿›è¡Œä¾èµ–çš„æ›´æ–°ã€‚</p><p>äº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<code>Vue</code>æä¾›äº†<code>Vue.set(object, propertyName, value)</code>çš„é™æ€æ–¹æ³•å’Œ<code>vm.$set(object, propertyName, value)</code>çš„å®ä¾‹æ–¹æ³•ï¼Œæˆ‘ä»¬çœ‹å…·ä½“æ€ä¹ˆå®Œæˆæ–°å±æ€§çš„ä¾èµ–æ”¶é›†è¿‡ç¨‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">set</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">target</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> key</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> val</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//targetå¿…é¡»ä¸ºéç©ºå¯¹è±¡</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isUndef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isPrimitive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Cannot set reactive property on undefined, null, or primitive value: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ•°ç»„åœºæ™¯ï¼Œè°ƒç”¨é‡å†™çš„spliceæ–¹æ³•ï¼Œå¯¹æ–°æ·»åŠ å±æ€§æ”¶é›†ä¾èµ–ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isValidArrayIndex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">splice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> val</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ–°å¢å¯¹è±¡çš„å±æ€§å­˜åœ¨æ—¶ï¼Œç›´æ¥è¿”å›æ–°å±æ€§ï¼Œè§¦å‘ä¾èµ–æ”¶é›†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> target </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      target</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> val</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ‹¿åˆ°ç›®æ ‡æºçš„Observer å®ä¾‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ob </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">__ob__</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_isVue</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ob </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> ob</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">vmCount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">warn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;Avoid adding reactive properties to a Vue instance or its root $data &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;at runtime - declare it upfront in the data option.&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> val</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ç›®æ ‡æºå¯¹è±¡æœ¬èº«ä¸æ˜¯ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œåˆ™ä¸éœ€è¦å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">ob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      target</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> val</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰‹åŠ¨è°ƒç”¨defineReactiveï¼Œä¸ºæ–°å±æ€§è®¾ç½®getter,setter</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    defineReactive###</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ob</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ob</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">notify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> val</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æŒ‰ç…§åˆ†æ”¯åˆ†ä¸ºä¸åŒçš„å››ä¸ªå¤„ç†é€»è¾‘ï¼š</p><ol><li>ç›®æ ‡å¯¹è±¡å¿…é¡»ä¸ºéç©ºçš„å¯¹è±¡ï¼Œå¯ä»¥æ˜¯æ•°ç»„ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li><li>å¦‚æœç›®æ ‡å¯¹è±¡æ˜¯æ•°ç»„æ—¶ï¼Œè°ƒç”¨æ•°ç»„çš„<code>splice</code>æ–¹æ³•ï¼Œè€Œå‰é¢åˆ†ææ•°ç»„æ£€æµ‹æ—¶ï¼Œé‡åˆ°æ•°ç»„æ–°å¢å…ƒç´ çš„åœºæ™¯ï¼Œä¼šè°ƒç”¨<code>ob.observeArray(inserted)</code>å¯¹æ•°ç»„æ–°å¢çš„å…ƒç´ æ”¶é›†ä¾èµ–ã€‚</li><li>æ–°å¢çš„å±æ€§å€¼åœ¨åŸå¯¹è±¡ä¸­å·²ç»å­˜åœ¨ï¼Œåˆ™æ‰‹åŠ¨è®¿é—®æ–°çš„å±æ€§å€¼ï¼Œè¿™ä¸€è¿‡ç¨‹ä¼šè§¦å‘ä¾èµ–æ”¶é›†ã€‚</li><li>æ‰‹åŠ¨å®šä¹‰æ–°å±æ€§çš„<code>getter,setter</code>æ–¹æ³•ï¼Œå¹¶é€šè¿‡<code>notify</code>è§¦å‘ä¾èµ–æ›´æ–°ã€‚</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="714-nexttick"></a>7.14 nextTick<a class="hash-link" href="#714-nexttick" title="Direct link to heading">#</a></h2><p>åœ¨ä¸Šä¸€èŠ‚çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬è¯´åˆ°æ•°æ®ä¿®æ”¹æ—¶ä¼šè§¦å‘<code>setter</code>æ–¹æ³•è¿›è¡Œä¾èµ–çš„æ´¾å‘æ›´æ–°ï¼Œè€Œæ›´æ–°æ—¶ä¼šå°†æ¯ä¸ª<code>watcher</code>æ¨åˆ°é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…ä¸‹ä¸€ä¸ª<code>tick</code>åˆ°æ¥æ—¶å†æ‰§è¡Œ<code>DOM</code>çš„æ¸²æŸ“æ›´æ–°æ“ä½œã€‚è¿™ä¸ªå°±æ˜¯å¼‚æ­¥æ›´æ–°çš„è¿‡ç¨‹ã€‚ä¸ºäº†è¯´æ˜å¼‚æ­¥æ›´æ–°çš„æ¦‚å¿µï¼Œéœ€è¦ç‰µæ‰¯åˆ°æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯æœºåˆ¶å’Œæœ€ä¼˜çš„æ¸²æŸ“æ—¶æœºé—®é¢˜ã€‚ç”±äºè¿™ä¸æ˜¯æ–‡ç« çš„ä¸»çº¿ï¼Œæˆ‘åªç”¨ç®€å•çš„è¯­è¨€æ¦‚è¿°ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="7141-äº‹ä»¶å¾ªç¯æœºåˆ¶"></a>7.14.1 äº‹ä»¶å¾ªç¯æœºåˆ¶<a class="hash-link" href="#7141-äº‹ä»¶å¾ªç¯æœºåˆ¶" title="Direct link to heading">#</a></h3><ol><li>å®Œæ•´çš„äº‹ä»¶å¾ªç¯æœºåˆ¶éœ€è¦äº†è§£ä¸¤ç§å¼‚æ­¥é˜Ÿåˆ—ï¼š<code>macro-task</code>å’Œ<code>micro-task</code></li><li><code>macro-task</code>å¸¸è§çš„æœ‰ <code>setTimeout, setInterval, setImmediate, scriptè„šæœ¬, I/Oæ“ä½œï¼ŒUIæ¸²æŸ“</code></li><li><code>micro-task</code>å¸¸è§çš„æœ‰ <code>promise, process.nextTick, MutationObserver</code>ç­‰</li><li>å®Œæ•´äº‹ä»¶å¾ªç¯æµç¨‹ä¸ºï¼š
4.1 <code>micro-task</code>ç©ºï¼Œ<code>macro-task</code>é˜Ÿåˆ—åªæœ‰<code>script</code>è„šæœ¬ï¼Œæ¨å‡º<code>macro-task</code>çš„<code>script</code>ä»»åŠ¡æ‰§è¡Œï¼Œè„šæœ¬æ‰§è¡ŒæœŸé—´äº§ç”Ÿçš„<code>macro-taskï¼Œmicro-task</code>æ¨åˆ°å¯¹åº”çš„é˜Ÿåˆ—ä¸­
4.2 æ‰§è¡Œå…¨éƒ¨<code>micro-task</code>é‡Œçš„å¾®ä»»åŠ¡äº‹ä»¶
4.3 æ‰§è¡Œ<code>DOM</code>æ“ä½œï¼Œæ¸²æŸ“æ›´æ–°é¡µé¢
4.4 æ‰§è¡Œ<code>web worker</code>ç­‰ç›¸å…³ä»»åŠ¡
4.5 å¾ªç¯ï¼Œå–å‡º<code>macro-task</code>ä¸­ä¸€ä¸ªå®ä»»åŠ¡äº‹ä»¶æ‰§è¡Œï¼Œé‡å¤4çš„æ“ä½œã€‚</li></ol><p>ä»ä¸Šé¢çš„æµç¨‹ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæœ€å¥½çš„æ¸²æŸ“è¿‡ç¨‹å‘ç”Ÿåœ¨å¾®ä»»åŠ¡é˜Ÿåˆ—çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ­¤æ—¶ä»–ç¦»é¡µé¢æ¸²æŸ“è¿‡ç¨‹æœ€è¿‘ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å€ŸåŠ©å¾®ä»»åŠ¡é˜Ÿåˆ—æ¥å®ç°å¼‚æ­¥æ›´æ–°ï¼Œå®ƒå¯ä»¥è®©å¤æ‚æ‰¹é‡çš„è¿ç®—æ“ä½œè¿è¡Œåœ¨JSå±‚é¢ï¼Œè€Œè§†å›¾çš„æ¸²æŸ“åªå…³å¿ƒæœ€ç»ˆçš„ç»“æœï¼Œè¿™å¤§å¤§é™ä½äº†æ€§èƒ½çš„æŸè€—ã€‚</p><p>ä¸¾ä¸€ä¸ªè¿™ä¸€åšæ³•å¥½å¤„çš„ä¾‹å­ï¼š
ç”±äº<code>Vue</code>æ˜¯æ•°æ®é©±åŠ¨è§†å›¾æ›´æ–°æ¸²æŸ“ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªæ“ä½œä¸­é‡å¤å¯¹ä¸€ä¸ªå“åº”å¼æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œä¾‹å¦‚ åœ¨ä¸€ä¸ªå¾ªç¯ä¸­æ‰§è¡Œ<code>this.num ++ </code>ä¸€åƒæ¬¡ï¼Œç”±äºå“åº”å¼ç³»ç»Ÿçš„å­˜åœ¨ï¼Œæ•°æ®å˜åŒ–è§¦å‘<code>setter</code>ï¼Œ<code>setter</code>è§¦å‘ä¾èµ–æ´¾å‘æ›´æ–°ï¼Œæ›´æ–°è°ƒç”¨<code>run</code>è¿›è¡Œè§†å›¾çš„é‡æ–°æ¸²æŸ“ã€‚è¿™ä¸€æ¬¡å¾ªç¯ï¼Œè§†å›¾æ¸²æŸ“è¦æ‰§è¡Œä¸€åƒæ¬¡ï¼Œå¾ˆæ˜æ˜¾è¿™æ˜¯å¾ˆæµªè´¹æ€§èƒ½çš„ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨æœ€åç¬¬ä¸€åƒæ¬¡åœ¨ç•Œé¢ä¸Šæ›´æ–°çš„ç»“æœè€Œå·²ã€‚æ‰€ä»¥åˆ©ç”¨å¼‚æ­¥æ›´æ–°æ˜¾å¾—æ ¼å¤–é‡è¦ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="7142-åŸºæœ¬å®ç°"></a>7.14.2 åŸºæœ¬å®ç°<a class="hash-link" href="#7142-åŸºæœ¬å®ç°" title="Direct link to heading">#</a></h3><p><code>Vue</code>ç”¨ä¸€ä¸ª<code>queue</code>æ”¶é›†ä¾èµ–çš„æ‰§è¡Œï¼Œåœ¨ä¸‹æ¬¡å¾®ä»»åŠ¡æ‰§è¡Œçš„æ—¶å€™ç»Ÿä¸€æ‰§è¡Œ<code>queue</code>ä¸­<code>Watcher</code>çš„<code>run</code>æ“ä½œ,ä¸æ­¤åŒæ—¶ï¼Œç›¸åŒ<code>id</code>çš„<code>watcher</code>ä¸ä¼šé‡å¤æ·»åŠ åˆ°<code>queue</code>ä¸­,å› æ­¤ä¹Ÿä¸ä¼šé‡å¤æ‰§è¡Œå¤šæ¬¡çš„è§†å›¾æ¸²æŸ“ã€‚æˆ‘ä»¬çœ‹<code>nextTick</code>çš„å®ç°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// åŸå‹ä¸Šå®šä¹‰çš„æ–¹æ³•</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">$nextTick</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">fn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nextTick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// æ„é€ å‡½æ•°ä¸Šå®šä¹‰çš„æ–¹æ³•</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">nextTick</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nextTick</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å®é™…çš„å®šä¹‰</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> callbacks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">nextTick</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">cb</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> ctx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> _resolve</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// callbacksæ˜¯ç»´æŠ¤å¾®ä»»åŠ¡çš„æ•°ç»„ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    callbacks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          cb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">handleError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;nextTick&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_resolve</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">_resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">pending</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      pending </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// å°†ç»´æŠ¤çš„é˜Ÿåˆ—æ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ç»´æŠ¤</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">timerFunc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// nextTickæ²¡æœ‰ä¼ é€’å‚æ•°ï¼Œä¸”æµè§ˆå™¨æ”¯æŒPromise,åˆ™è¿”å›ä¸€ä¸ªpromiseå¯¹è±¡</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">cb </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;undefined&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        _resolve </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> resolve</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>nextTick</code>å®šä¹‰ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨æ–¹å¼ä¸º<code>Vue.nextTick( [callback, context] )</code>,å½“<code>callback</code>ç»è¿‡<code>nextTick</code>å°è£…åï¼Œ<code>callback</code>ä¼šåœ¨ä¸‹ä¸€ä¸ª<code>tick</code>ä¸­æ‰§è¡Œè°ƒç”¨ã€‚ä»å®ç°ä¸Šï¼Œ<code>callbacks</code>æ˜¯ä¸€ä¸ªç»´æŠ¤äº†éœ€è¦åœ¨ä¸‹ä¸€ä¸ª<code>tick</code>ä¸­æ‰§è¡Œçš„ä»»åŠ¡çš„é˜Ÿåˆ—ï¼Œå®ƒçš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯éœ€è¦æ‰§è¡Œçš„å‡½æ•°ã€‚<code>pending</code>æ˜¯åˆ¤æ–­æ˜¯å¦åœ¨ç­‰å¾…æ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—çš„æ ‡å¿—ã€‚è€Œ<code>timerFunc</code>æ˜¯çœŸæ­£å°†ä»»åŠ¡é˜Ÿåˆ—æ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„å‡½æ•°ã€‚æˆ‘ä»¬çœ‹<code>timerFunc</code>çš„å®ç°ã€‚</p><p>1.å¦‚æœæµè§ˆå™¨æ‰§è¡Œ<code>Promise</code>,é‚£ä¹ˆé»˜è®¤ä»¥<code>Promsie</code>å°†æ‰§è¡Œè¿‡ç¨‹æ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> timerFunc</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;undefined&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isNative</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> p </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">timerFunc</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰‹æœºç«¯çš„å…¼å®¹ä»£ç </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isIOS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">noop</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ä½¿ç”¨å¾®ä»»åŠ¡é˜Ÿåˆ—çš„æ ‡å¿—</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  isUsingMicroTask </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>flushCallbacks</code>æ˜¯å¼‚æ­¥æ›´æ–°çš„å‡½æ•°ï¼Œä»–ä¼šå–å‡ºcallbacksæ•°ç»„çš„æ¯ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œä»»åŠ¡ï¼Œå…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">flushCallbacks</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  pending </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> copies </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> callbacks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å–å‡ºcallbacksæ•°ç»„çš„æ¯ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œä»»åŠ¡</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  callbacks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> copies</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    copies</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>2.ä¸æ”¯æŒ<code>promise</code>,æ”¯æŒ<code>MutataionObserver</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">isIE </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> </span><span class="token maybe-class-name">MutationObserver</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;undefined&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">isNative</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">MutationObserver</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// PhantomJS and iOS 7.x</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">MutationObserver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;[object MutationObserverConstructor]&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> observer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">MutationObserver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> textNode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createTextNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    observer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">textNode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      characterData</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">timerFunc</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      textNode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    isUsingMicroTask </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>3.å¦‚æœä¸æ”¯æŒå¾®ä»»åŠ¡æ–¹æ³•ï¼Œåˆ™ä¼šä½¿ç”¨å®ä»»åŠ¡æ–¹æ³•ï¼Œ<code>setImmediate</code>ä¼šå…ˆè¢«ä½¿ç”¨</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> setImmediate </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;undefined&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isNative</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">setImmediate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Fallback to setImmediate.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Techinically it leverages the (macro) task queue,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// but it is still a better choice than setTimeout.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">timerFunc</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">setImmediate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>4.æ‰€æœ‰æ–¹æ³•éƒ½ä¸é€‚åˆï¼Œä¼šä½¿ç”¨å®ä»»åŠ¡æ–¹æ³•ä¸­çš„<code>setTimeout</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">timerFunc</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flushCallbacks</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>å½“<code>nextTick</code>ä¸ä¼ é€’ä»»ä½•å‚æ•°æ—¶ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ª<code>promise</code>ç”¨</strong>ï¼Œä¾‹å¦‚ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">nextTick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="7143-ä½¿ç”¨åœºæ™¯"></a>7.14.3 ä½¿ç”¨åœºæ™¯<a class="hash-link" href="#7143-ä½¿ç”¨åœºæ™¯" title="Direct link to heading">#</a></h3><p>è¯´äº†è¿™ä¹ˆå¤šåŸç†æ€§çš„ä¸œè¥¿ï¼Œå›è¿‡å¤´æ¥çœ‹çœ‹<code>nextTick</code>çš„ä½¿ç”¨åœºæ™¯ï¼Œç”±äºå¼‚æ­¥æ›´æ–°çš„åŸç†ï¼Œæˆ‘ä»¬åœ¨æŸä¸€æ—¶é—´æ”¹å˜çš„æ•°æ®å¹¶ä¸ä¼šè§¦å‘è§†å›¾çš„æ›´æ–°ï¼Œè€Œæ˜¯éœ€è¦ç­‰ä¸‹ä¸€ä¸ª<code>tick</code>åˆ°æ¥æ—¶æ‰ä¼šæ›´æ–°è§†å›¾ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹åœºæ™¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">input v</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;show&quot;</span><span class="token plain"> type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"> ref</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;myInput&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// js</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  show</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mounted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">show</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$refs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">myInput</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">focus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">// æŠ¥é”™</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ•°æ®æ”¹å˜æ—¶ï¼Œè§†å›¾å¹¶ä¸ä¼šåŒæ—¶æ”¹å˜ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨<code>nextTick</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mounted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">show</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$nextTick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$refs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">myInput</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">focus</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">// æ­£å¸¸</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="715-watch"></a>7.15 watch<a class="hash-link" href="#715-watch" title="Direct link to heading">#</a></h2><p>åˆ°è¿™é‡Œï¼Œå…³äºå“åº”å¼ç³»ç»Ÿçš„åˆ†æå¤§éƒ¨åˆ†å†…å®¹å·²ç»åˆ†æå®Œæ¯•ï¼Œæˆ‘ä»¬ä¸Šä¸€èŠ‚è¿˜é—ç•™ç€ä¸€ä¸ªé—®é¢˜ï¼Œ<code>Vue</code>å¯¹ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ çš„<code>watch</code>å¦‚ä½•è¿›è¡Œæ•°æ®æ‹¦æˆªã€‚æˆ‘ä»¬å…ˆçœ‹çœ‹ä¸¤ç§åŸºæœ¬çš„ä½¿ç”¨å½¢å¼ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// watché€‰é¡¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  el</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;#app&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      num</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  watch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">num</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">num</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">111</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// $watch apiæ–¹å¼</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$watch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;num&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  deep</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  immediate</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="7151-ä¾èµ–æ”¶é›†"></a>7.15.1 ä¾èµ–æ”¶é›†<a class="hash-link" href="#7151-ä¾èµ–æ”¶é›†" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬ä»¥<code>watch</code>é€‰é¡¹çš„æ–¹å¼æ¥åˆ†æ<code>watch</code>çš„ç»†èŠ‚ï¼ŒåŒæ ·ä»åˆå§‹åŒ–è¯´èµ·ï¼Œåˆå§‹åŒ–æ•°æ®ä¼šæ‰§è¡Œ<code>initWatch</code>,<code>initWatch</code>çš„æ ¸å¿ƒæ˜¯<code>createWatcher</code>ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initWatch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> watch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> key </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> watch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> handler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> watch</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// handlerå¯ä»¥æ˜¯æ•°ç»„çš„å½¢å¼ï¼Œæ‰§è¡Œå¤šä¸ªå›è°ƒ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">createWatcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">createWatcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createWatcher</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">expOrFn</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">handler</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// é’ˆå¯¹watchæ˜¯å¯¹è±¡çš„å½¢å¼ï¼Œæ­¤æ—¶å›è°ƒå›é€‰é¡¹ä¸­çš„handler</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isPlainObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      handler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">handler</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> handler </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      handler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$watch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expOrFn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ— è®ºæ˜¯é€‰é¡¹çš„å½¢å¼ï¼Œè¿˜æ˜¯<code>api</code>çš„å½¢å¼ï¼Œæœ€ç»ˆéƒ½ä¼šè°ƒç”¨å®ä¾‹çš„<code>$watch</code>æ–¹æ³•ï¼Œå…¶ä¸­<code>expOrFn</code>æ˜¯ç›‘å¬çš„å­—ç¬¦ä¸²ï¼Œ<code>handler</code>æ˜¯ç›‘å¬çš„å›è°ƒå‡½æ•°ï¼Œ<code>options</code>æ˜¯ç›¸å…³é…ç½®ã€‚æˆ‘ä»¬é‡ç‚¹çœ‹çœ‹<code>$watch</code>çš„å®ç°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">$watch</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">expOrFn</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">cb</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isPlainObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createWatcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expOrFn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cb</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> options </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">user</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> watcher </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Watcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expOrFn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cb</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// å½“watchæœ‰immediateé€‰é¡¹æ—¶ï¼Œç«‹å³æ‰§è¡Œcbæ–¹æ³•ï¼Œå³ä¸éœ€è¦ç­‰å¾…å±æ€§å˜åŒ–ï¼Œç«‹åˆ»æ‰§è¡Œå›è°ƒã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">immediate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        cb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> watcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">handleError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;callback for immediate watcher \&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">watcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">expression</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;\&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">unwatchFn</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      watcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">teardown</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>$watch</code>çš„æ ¸å¿ƒæ˜¯åˆ›å»ºä¸€ä¸ª<code>user watcher</code>,<code>options.user</code>æ˜¯å½“å‰ç”¨æˆ·å®šä¹‰<code>watcher</code>çš„æ ‡å¿—ã€‚å¦‚æœæœ‰<code>immediate</code>å±æ€§ï¼Œåˆ™ç«‹å³æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚
è€Œå®ä¾‹åŒ–<code>watcher</code>æ—¶ä¼šæ‰§è¡Œä¸€æ¬¡<code>getter</code>æ±‚å€¼ï¼Œè¿™æ—¶ï¼Œ<code>user watcher</code>ä¼šä½œä¸ºä¾èµ–è¢«æ•°æ®æ‰€æ”¶é›†ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å‚è€ƒ<code>data</code>çš„åˆ†æã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">Watcher</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Watcher</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">lazy</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Watcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">get</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// getterå›è°ƒå‡½æ•°ï¼Œè§¦å‘ä¾èµ–æ”¶é›†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getter</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="7152-æ´¾å‘æ›´æ–°"></a>7.15.2 æ´¾å‘æ›´æ–°<a class="hash-link" href="#7152-æ´¾å‘æ›´æ–°" title="Direct link to heading">#</a></h3><p><code>watch</code>æ´¾å‘æ›´æ–°çš„è¿‡ç¨‹å¾ˆå¥½ç†è§£ï¼Œæ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œ<code>setter</code>æ‹¦æˆªå¯¹ä¾èµ–è¿›è¡Œæ›´æ–°ï¼Œè€Œæ­¤å‰<code>user watcher</code>å·²ç»è¢«å½“æˆä¾èµ–æ”¶é›†äº†ã€‚è¿™ä¸ªæ—¶å€™ä¾èµ–çš„æ›´æ–°å°±æ˜¯å›è°ƒå‡½æ•°çš„æ‰§è¡Œã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="716-å°ç»“"></a>7.16 å°ç»“<a class="hash-link" href="#716-å°ç»“" title="Direct link to heading">#</a></h2><p>è¿™ä¸€èŠ‚æ˜¯å“åº”å¼ç³»ç»Ÿæ„å»ºçš„å®Œç»“ç¯‡ï¼Œ<code>data,computed</code>å¦‚ä½•è¿›è¡Œå“åº”å¼ç³»ç»Ÿè®¾è®¡ï¼Œè¿™åœ¨ä¸Šä¸€èŠ‚å†…å®¹å·²ç»è¯¦ç»†åˆ†æï¼Œè¿™ä¸€èŠ‚é’ˆå¯¹ä¸€äº›ç‰¹æ®Šåœºæ™¯åšäº†åˆ†æã€‚ä¾‹å¦‚ç”±äº<code>Object.defineProperty</code>è‡ªèº«çš„ç¼ºé™·ï¼Œæ— æ³•å¯¹æ•°ç»„çš„æ–°å¢åˆ é™¤è¿›è¡Œæ‹¦æˆªæ£€æµ‹ï¼Œå› æ­¤<code>Vue</code>å¯¹æ•°ç»„è¿›è¡Œäº†ç‰¹æ®Šå¤„ç†ï¼Œé‡å†™äº†æ•°ç»„çš„æ–¹æ³•ï¼Œå¹¶åœ¨æ–¹æ³•ä¸­å¯¹æ•°æ®è¿›è¡Œæ‹¦æˆªã€‚æˆ‘ä»¬ä¹Ÿé‡ç‚¹ä»‹ç»äº†<code>nextTick</code>çš„åŸç†ï¼Œåˆ©ç”¨æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯æœºåˆ¶æ¥è¾¾åˆ°æœ€ä¼˜çš„æ¸²æŸ“æ—¶æœºã€‚æ–‡ç« çš„æœ€åè¡¥å……äº†<code>watch</code>åœ¨å“åº”å¼è®¾è®¡çš„åŸç†ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„<code>watch</code>ä¼šåˆ›å»ºä¸€ä¸ªä¾èµ–ï¼Œè¿™ä¸ªä¾èµ–åœ¨æ•°æ®æ”¹å˜æ—¶ä¼šæ‰§è¡Œå›è°ƒã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated on <b><time datetime="2022-10-24T06:26:17.000Z">10/24/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog-vue-source/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­ Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#712-æ•°ç»„æ£€æµ‹" class="table-of-contents__link">7.12 æ•°ç»„æ£€æµ‹</a><ul><li><a href="#7121-æ•°ç»„æ–¹æ³•çš„é‡å†™" class="table-of-contents__link">7.12.1 æ•°ç»„æ–¹æ³•çš„é‡å†™</a></li><li><a href="#7122-ä¾èµ–æ”¶é›†" class="table-of-contents__link">7.12.2 ä¾èµ–æ”¶é›†</a></li><li><a href="#7123-æ´¾å‘æ›´æ–°" class="table-of-contents__link">7.12.3 æ´¾å‘æ›´æ–°</a></li></ul></li><li><a href="#713-å¯¹è±¡æ£€æµ‹å¼‚å¸¸" class="table-of-contents__link">7.13 å¯¹è±¡æ£€æµ‹å¼‚å¸¸</a></li><li><a href="#714-nexttick" class="table-of-contents__link">7.14 nextTick</a><ul><li><a href="#7141-äº‹ä»¶å¾ªç¯æœºåˆ¶" class="table-of-contents__link">7.14.1 äº‹ä»¶å¾ªç¯æœºåˆ¶</a></li><li><a href="#7142-åŸºæœ¬å®ç°" class="table-of-contents__link">7.14.2 åŸºæœ¬å®ç°</a></li><li><a href="#7143-ä½¿ç”¨åœºæ™¯" class="table-of-contents__link">7.14.3 ä½¿ç”¨åœºæ™¯</a></li></ul></li><li><a href="#715-watch" class="table-of-contents__link">7.15 watch</a><ul><li><a href="#7151-ä¾èµ–æ”¶é›†" class="table-of-contents__link">7.15.1 ä¾èµ–æ”¶é›†</a></li><li><a href="#7152-æ´¾å‘æ›´æ–°" class="table-of-contents__link">7.15.2 æ´¾å‘æ›´æ–°</a></li></ul></li><li><a href="#716-å°ç»“" class="table-of-contents__link">7.16 å°ç»“</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022, Power By <a href="https://www.docusaurus.cn/">Docusaurus</a>.</div></div></div></footer></div>
<script src="/blog-vue-source/assets/js/runtime~main.0ee6c1f0.js"></script>
<script src="/blog-vue-source/assets/js/main.d722cc53.js"></script>
</body>
</html>