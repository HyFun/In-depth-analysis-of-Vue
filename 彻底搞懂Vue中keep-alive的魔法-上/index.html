<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š | æ·±å…¥å‰–æVueæºç </title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š | æ·±å…¥å‰–æVueæºç "><meta data-react-helmet="true" name="description" content="å‰è¨€ï¼šä¸Šä¸€èŠ‚æœ€åç¨å¾®æåˆ°äº†`Vue`å†…ç½®ç»„ä»¶çš„ç›¸å…³å†…å®¹ï¼Œä»è¿™ä¸€èŠ‚å¼€å§‹ï¼Œå°†ä¼šå¯¹æŸä¸ªå…·ä½“çš„å†…ç½®ç»„ä»¶è¿›è¡Œåˆ†æã€‚é¦–å…ˆæ˜¯`keep-alive`ï¼Œå®ƒæ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨çš„ç»„ä»¶ï¼Œæˆ‘ä»¬åœ¨ä¸åŒç»„ä»¶é—´åˆ‡æ¢æ—¶ï¼Œç»å¸¸è¦æ±‚ä¿æŒç»„ä»¶çš„çŠ¶æ€ï¼Œä»¥é¿å…é‡å¤æ¸²æŸ“ç»„ä»¶é€ æˆçš„æ€§èƒ½æŸè€—ï¼Œè€Œ`keep-alive`ç»å¸¸å’Œä¸Šä¸€èŠ‚ä»‹ç»çš„åŠ¨æ€ç»„ä»¶ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ç”±äºå†…å®¹è¿‡å¤šï¼Œ`keep-alive`çš„æºç åˆ†æå°†åˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œè¿™ä¸€èŠ‚ä¸»è¦å›´ç»•`keep-alive`çš„é¦–æ¬¡æ¸²æŸ“å±•å¼€ã€‚"><meta data-react-helmet="true" property="og:description" content="å‰è¨€ï¼šä¸Šä¸€èŠ‚æœ€åç¨å¾®æåˆ°äº†`Vue`å†…ç½®ç»„ä»¶çš„ç›¸å…³å†…å®¹ï¼Œä»è¿™ä¸€èŠ‚å¼€å§‹ï¼Œå°†ä¼šå¯¹æŸä¸ªå…·ä½“çš„å†…ç½®ç»„ä»¶è¿›è¡Œåˆ†æã€‚é¦–å…ˆæ˜¯`keep-alive`ï¼Œå®ƒæ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨çš„ç»„ä»¶ï¼Œæˆ‘ä»¬åœ¨ä¸åŒç»„ä»¶é—´åˆ‡æ¢æ—¶ï¼Œç»å¸¸è¦æ±‚ä¿æŒç»„ä»¶çš„çŠ¶æ€ï¼Œä»¥é¿å…é‡å¤æ¸²æŸ“ç»„ä»¶é€ æˆçš„æ€§èƒ½æŸè€—ï¼Œè€Œ`keep-alive`ç»å¸¸å’Œä¸Šä¸€èŠ‚ä»‹ç»çš„åŠ¨æ€ç»„ä»¶ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ç”±äºå†…å®¹è¿‡å¤šï¼Œ`keep-alive`çš„æºç åˆ†æå°†åˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œè¿™ä¸€èŠ‚ä¸»è¦å›´ç»•`keep-alive`çš„é¦–æ¬¡æ¸²æŸ“å±•å¼€ã€‚"><link data-react-helmet="true" rel="shortcut icon" href="/In-depth-analysis-of-Vue/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š" hreflang="x-default"><link rel="stylesheet" href="/In-depth-analysis-of-Vue/assets/css/styles.6d09dbb1.css">
<link rel="preload" href="/In-depth-analysis-of-Vue/assets/js/runtime~main.df0025c9.js" as="script">
<link rel="preload" href="/In-depth-analysis-of-Vue/assets/js/main.fe9c40e7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/In-depth-analysis-of-Vue/"><img src="/In-depth-analysis-of-Vue/img/logo.svg" alt="æ·±å…¥å‰–æVueæºç " class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/In-depth-analysis-of-Vue/img/logo.svg" alt="æ·±å…¥å‰–æVueæºç " class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">æ·±å…¥å‰–æVueæºç </b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Ocean1509/In-depth-analysis-of-Vue" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ç›®å½•">ç›®å½•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ä¸°å¯Œçš„é€‰é¡¹åˆå¹¶ç­–ç•¥">ä¸°å¯Œçš„é€‰é¡¹åˆå¹¶ç­–ç•¥</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/åŸºç¡€çš„æ•°æ®ä»£ç†æ£€æµ‹">åŸºç¡€çš„æ•°æ®ä»£ç†æ£€æµ‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/å®ä¾‹æŒ‚è½½æµç¨‹å’Œæ¨¡æ¿ç¼–è¯‘">å®ä¾‹æŒ‚è½½æµç¨‹å’Œæ¨¡æ¿ç¼–è¯‘</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/å®Œæ•´æ¸²æŸ“æµç¨‹">å®Œæ•´æ¸²æŸ“æµç¨‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ç»„ä»¶åŸºç¡€å‰–æ">ç»„ä»¶åŸºç¡€å‰–æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ç»„ä»¶é«˜çº§ç”¨æ³•">ç»„ä»¶é«˜çº§ç”¨æ³•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•">æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶">æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ">vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ä½ çœŸçš„äº†è§£v-modelçš„è¯­æ³•ç³–äº†å—">ä½ çœŸçš„äº†è§£v-modelçš„è¯­æ³•ç³–äº†å—</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ">åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š</h1></header><blockquote><p>å‰è¨€ï¼šä¸Šä¸€èŠ‚æœ€åç¨å¾®æåˆ°äº†<code>Vue</code>å†…ç½®ç»„ä»¶çš„ç›¸å…³å†…å®¹ï¼Œä»è¿™ä¸€èŠ‚å¼€å§‹ï¼Œå°†ä¼šå¯¹æŸä¸ªå…·ä½“çš„å†…ç½®ç»„ä»¶è¿›è¡Œåˆ†æã€‚é¦–å…ˆæ˜¯<code>keep-alive</code>ï¼Œå®ƒæ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨çš„ç»„ä»¶ï¼Œæˆ‘ä»¬åœ¨ä¸åŒç»„ä»¶é—´åˆ‡æ¢æ—¶ï¼Œç»å¸¸è¦æ±‚ä¿æŒç»„ä»¶çš„çŠ¶æ€ï¼Œä»¥é¿å…é‡å¤æ¸²æŸ“ç»„ä»¶é€ æˆçš„æ€§èƒ½æŸè€—ï¼Œè€Œ<code>keep-alive</code>ç»å¸¸å’Œä¸Šä¸€èŠ‚ä»‹ç»çš„åŠ¨æ€ç»„ä»¶ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ç”±äºå†…å®¹è¿‡å¤šï¼Œ<code>keep-alive</code>çš„æºç åˆ†æå°†åˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œè¿™ä¸€èŠ‚ä¸»è¦å›´ç»•<code>keep-alive</code>çš„é¦–æ¬¡æ¸²æŸ“å±•å¼€ã€‚</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="131-åŸºæœ¬ç”¨æ³•"></a>13.1 åŸºæœ¬ç”¨æ³•<a class="hash-link" href="#131-åŸºæœ¬ç”¨æ³•" title="Direct link to heading">#</a></h2><p><code>keep-alive</code>çš„ä½¿ç”¨åªéœ€è¦åœ¨åŠ¨æ€ç»„ä»¶çš„æœ€å¤–å±‚æ·»åŠ æ ‡ç­¾å³å¯ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">app</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">@click</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">changeTabs(</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">child1</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">)</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">child1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">@click</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">changeTabs(</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">child2</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">)</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">child2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">keep-alive</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">component</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">:is</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">chooseTabs</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">component</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">keep-alive</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> child1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    template</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;div&gt;&lt;button @click=&quot;add&quot;&gt;add&lt;/button&gt;&lt;p&gt;{{num}}&lt;/p&gt;&lt;/div&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            num</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    methods</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">num</span><span class="token operator" style="color:#393A34">++</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> child2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    template</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;div&gt;child2&lt;/div&gt;&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    el</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;#app&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    components</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        child1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        child2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            chooseTabs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;child1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    methods</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">changeTabs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">tab</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">chooseTabs</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tab</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç®€å•çš„ç»“æœå¦‚ä¸‹ï¼ŒåŠ¨æ€ç»„ä»¶åœ¨<code>child1,child2</code>ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œå½“ç¬¬äºŒæ¬¡åˆ‡åˆ°<code>child1</code>æ—¶ï¼Œ<code>child1</code>ä¿ç•™ç€åŸæ¥çš„æ•°æ®çŠ¶æ€ï¼Œ<code>num = 5</code>ã€‚</p><p><img src="/In-depth-analysis-of-Vue/assets/images/13.1-8a28c4a19c9108e9dbb753b970e6c978.gif"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="132-ä»æ¨¡æ¿ç¼–è¯‘åˆ°ç”Ÿæˆvnode"></a>13.2 ä»æ¨¡æ¿ç¼–è¯‘åˆ°ç”Ÿæˆvnode<a class="hash-link" href="#132-ä»æ¨¡æ¿ç¼–è¯‘åˆ°ç”Ÿæˆvnode" title="Direct link to heading">#</a></h2><p>æŒ‰ç…§ä»¥å¾€åˆ†æçš„ç»éªŒï¼Œæˆ‘ä»¬ä¼šä»æ¨¡æ¿çš„è§£æå¼€å§‹è¯´èµ·ï¼Œç¬¬ä¸€ä¸ªç–‘é—®ä¾¿æ˜¯ï¼šå†…ç½®ç»„ä»¶å’Œæ™®é€šç»„ä»¶åœ¨ç¼–è¯‘è¿‡ç¨‹æœ‰åŒºåˆ«å—ï¼Ÿç­”æ¡ˆæ˜¯æ²¡æœ‰çš„ï¼Œä¸ç®¡æ˜¯å†…ç½®çš„è¿˜æ˜¯ç”¨æˆ·å®šä¹‰ç»„ä»¶ï¼Œæœ¬è´¨ä¸Šç»„ä»¶åœ¨æ¨¡æ¿ç¼–è¯‘æˆ<code>render</code>å‡½æ•°çš„å¤„ç†æ–¹å¼æ˜¯ä¸€è‡´çš„ï¼Œè¿™é‡Œçš„ç»†èŠ‚ä¸å±•å¼€åˆ†æï¼Œæœ‰ç–‘æƒ‘çš„å¯ä»¥å‚è€ƒå‰å‡ èŠ‚çš„åŸç†åˆ†æã€‚æœ€ç»ˆé’ˆå¯¹<code>keep-alive</code>çš„<code>render</code>å‡½æ•°çš„ç»“æœå¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token function" style="color:#d73a49">Â·Â·Â·_c</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;keep-alive&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">attrs</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;include&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;child2&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">_c</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chooseTabs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">tag</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;component&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æœ‰äº†<code>render</code>å‡½æ•°ï¼Œæ¥ä¸‹æ¥ä»å­å¼€å§‹åˆ°çˆ¶ä¼šæ‰§è¡Œç”Ÿæˆ<code>Vnode</code>å¯¹è±¡çš„è¿‡ç¨‹ï¼Œ<code>_c(&#x27;keep-alive&#x27;Â·Â·Â·)</code>çš„å¤„ç†ï¼Œä¼šæ‰§è¡Œ<code>createElement</code>ç”Ÿæˆç»„ä»¶<code>Vnode</code>,å…¶ä¸­ç”±äº<code>keep-alive</code>æ˜¯ç»„ä»¶ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨<code>createComponent</code>å‡½æ•°å»åˆ›å»ºå­ç»„ä»¶<code>Vnode</code>,<code>createComponent</code>ä¹‹å‰ä¹Ÿæœ‰åˆ†æè¿‡ï¼Œè¿™ä¸ªç¯èŠ‚å’Œåˆ›å»ºæ™®é€šç»„ä»¶<code>Vnode</code>ä¸åŒä¹‹å¤„åœ¨äºï¼Œ<code>keep-alive</code>çš„<code>Vnode</code>ä¼šå‰”é™¤å¤šä½™çš„å±æ€§å†…å®¹ï¼Œ<strong>ç”±äº<code>keep-alive</code>é™¤äº†<code>slot</code>å±æ€§ä¹‹å¤–ï¼Œå…¶ä»–å±æ€§åœ¨ç»„ä»¶å†…éƒ¨å¹¶æ²¡æœ‰æ„ä¹‰ï¼Œä¾‹å¦‚<code>class</code>æ ·å¼ï¼Œ<code>&lt;keep-alive clas=&quot;test&quot;&gt;&lt;/keep-alive&gt;</code>ç­‰ï¼Œæ‰€ä»¥åœ¨<code>Vnode</code>å±‚å‰”é™¤æ‰å¤šä½™çš„å±æ€§æ˜¯æœ‰æ„ä¹‰çš„ã€‚è€Œ<code>&lt;keep-alive slot=&quot;test&quot;&gt;</code>çš„å†™æ³•åœ¨2.6ä»¥ä¸Šçš„ç‰ˆæœ¬ä¹Ÿå·²ç»è¢«åºŸå¼ƒã€‚</strong>(å…¶ä¸­<code>abstract</code>ä½œä¸ºæŠ½è±¡ç»„ä»¶çš„æ ‡å¿—ï¼Œä»¥åŠå…¶ä½œç”¨æˆ‘ä»¬åé¢ä¼šè®²åˆ°)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// åˆ›å»ºå­ç»„ä»¶Vnodeè¿‡ç¨‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">Ctordata</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">children</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">tag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// abstractæ˜¯å†…ç½®ç»„ä»¶(æŠ½è±¡ç»„ä»¶)çš„æ ‡å¿—</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isTrue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">Ctor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">abstract</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// åªä¿ç•™slotå±æ€§ï¼Œå…¶ä»–æ ‡ç­¾å±æ€§éƒ½è¢«ç§»é™¤ï¼Œåœ¨vnodeå¯¹è±¡ä¸Šä¸å†å­˜åœ¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> slot </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">slot</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">slot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">slot</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> slot</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="133-åˆæ¬¡æ¸²æŸ“"></a>13.3 åˆæ¬¡æ¸²æŸ“<a class="hash-link" href="#133-åˆæ¬¡æ¸²æŸ“" title="Direct link to heading">#</a></h2><p><code>keep-alive</code>ä¹‹æ‰€ä»¥ç‰¹åˆ«ï¼Œæ˜¯å› ä¸ºå®ƒä¸ä¼šé‡å¤æ¸²æŸ“ç›¸åŒçš„ç»„ä»¶ï¼Œåªä¼šåˆ©ç”¨åˆæ¬¡æ¸²æŸ“ä¿ç•™çš„ç¼“å­˜å»æ›´æ–°èŠ‚ç‚¹ã€‚æ‰€ä»¥ä¸ºäº†å…¨é¢äº†è§£å®ƒçš„å®ç°åŸç†ï¼Œæˆ‘ä»¬éœ€è¦ä»<code>keep-alive</code>çš„é¦–æ¬¡æ¸²æŸ“å¼€å§‹è¯´èµ·ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1331-æµç¨‹å›¾"></a>13.3.1 æµç¨‹å›¾<a class="hash-link" href="#1331-æµç¨‹å›¾" title="Direct link to heading">#</a></h3><p>ä¸ºäº†ç†æ¸…æ¥šæµç¨‹ï¼Œæˆ‘å¤§è‡´ç”»äº†ä¸€ä¸ªæµç¨‹å›¾ï¼Œæµç¨‹å›¾å¤§è‡´è¦†ç›–äº†åˆå§‹æ¸²æŸ“<code>keep-alive</code>æ‰€æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œæ¥ä¸‹æ¥ä¼šç…§ç€è¿™ä¸ªè¿‡ç¨‹è¿›è¡Œæºç åˆ†æã€‚</p><p><img src="/In-depth-analysis-of-Vue/assets/images/13.2-60e2a10368ed81ae482728d2f4f7fea4.png"></p><p>å’Œæ¸²æŸ“æ™®é€šç»„ä»¶ç›¸åŒçš„æ˜¯ï¼Œ<code>Vue</code>ä¼šæ‹¿åˆ°å‰é¢ç”Ÿæˆçš„<code>Vnode</code>å¯¹è±¡æ‰§è¡ŒçœŸå®èŠ‚ç‚¹åˆ›å»ºçš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ç†Ÿæ‚‰çš„<code>patch</code>è¿‡ç¨‹,<code>patch</code>æ‰§è¡Œé˜¶æ®µä¼šè°ƒç”¨<code>createElm</code>åˆ›å»ºçœŸå®<code>dom</code>ï¼Œåœ¨åˆ›å»ºèŠ‚ç‚¹é€”ä¸­ï¼Œ<code>keep-alive</code>çš„<code>vnode</code>å¯¹è±¡ä¼šè¢«è®¤å®šæ˜¯ä¸€ä¸ªç»„ä»¶<code>Vnode</code>,å› æ­¤é’ˆå¯¹ç»„ä»¶<code>Vnode</code>åˆä¼šæ‰§è¡Œ<code>createComponent</code>å‡½æ•°ï¼Œå®ƒä¼šå¯¹<code>keep-alive</code>ç»„ä»¶è¿›è¡Œåˆå§‹åŒ–å’Œå®ä¾‹åŒ–ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createComponent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> insertedVnodeQueue</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> parentElm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> refElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// isReactivatedç”¨æ¥åˆ¤æ–­ç»„ä»¶æ˜¯å¦ç¼“å­˜ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> isReactivated </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keepAlive</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hook</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">init</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰§è¡Œç»„ä»¶åˆå§‹åŒ–çš„å†…éƒ¨é’©å­ init</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">i</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* hydrating */</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// å…¶ä¸­ä¸€ä¸ªä½œç”¨æ˜¯ä¿ç•™çœŸå®domåˆ°vnodeä¸­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">initComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentElm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">elm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> refElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isTrue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isReactivated</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">reactivateComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> parentElm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> refElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>keep-alive</code>ç»„ä»¶ä¼šå…ˆè°ƒç”¨å†…éƒ¨é’©å­<code>init</code>æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹<code>init</code>è¿‡ç¨‹åšäº†ä»€ä¹ˆæ“ä½œã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ç»„ä»¶å†…éƒ¨é’©å­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> componentVNodeHooks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">init</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> hydrating</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_isDestroyed</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keepAlive</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// kept-alive components, treat as a patch</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> mountedNode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// work around flow</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        componentVNodeHooks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">prepatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mountedNode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mountedNode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// å°†ç»„ä»¶å®ä¾‹èµ‹å€¼ç»™vnodeçš„componentInstanceå±æ€§</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> child </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createComponentInstanceForVnode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          activeInstance</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        child</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$mount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hydrating </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">elm</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hydrating</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// åé¢åˆ†æ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    prepatchï¼š </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç¬¬ä¸€æ¬¡æ‰§è¡Œï¼Œå¾ˆæ˜æ˜¾ç»„ä»¶<code>vnode</code>æ²¡æœ‰<code>componentInstance</code>å±æ€§ï¼Œ<code>vnode.data.keepAlive</code>ä¹Ÿæ²¡æœ‰å€¼ï¼Œæ‰€ä»¥ä¼š<strong>è°ƒç”¨<code>createComponentInstanceForVnode</code>æ–¹æ³•è¿›è¡Œç»„ä»¶å®ä¾‹åŒ–å¹¶å°†ç»„ä»¶å®ä¾‹èµ‹å€¼ç»™<code>vnode</code>çš„<code>componentInstance</code>å±æ€§ï¼Œ</strong> æœ€ç»ˆæ‰§è¡Œç»„ä»¶å®ä¾‹çš„<code>$mount</code>æ–¹æ³•è¿›è¡Œå®ä¾‹æŒ‚è½½ã€‚</p><p><code>createComponentInstanceForVnode</code>å°±æ˜¯ç»„ä»¶å®ä¾‹åŒ–çš„è¿‡ç¨‹ï¼Œè€Œç»„ä»¶å®ä¾‹åŒ–ä»ç³»åˆ—çš„ç¬¬ä¸€ç¯‡å°±å¼€å§‹è¯´äº†ï¼Œæ— éå°±æ˜¯ä¸€ç³»åˆ—é€‰é¡¹åˆå¹¶ï¼Œåˆå§‹åŒ–äº‹ä»¶ï¼Œç”Ÿå‘½å‘¨æœŸç­‰åˆå§‹åŒ–æ“ä½œã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createComponentInstanceForVnode</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> parent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      _isComponent</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      _parentVnode</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      parent</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> parent</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// å†…è”æ¨¡æ¿çš„å¤„ç†ï¼Œå¿½ç•¥è¿™éƒ¨åˆ†ä»£ç </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰§è¡Œvueå­ç»„ä»¶å®ä¾‹åŒ–</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">vnode</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">componentOptions</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">Ctor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1332-å†…ç½®ç»„ä»¶é€‰é¡¹"></a>13.3.2 å†…ç½®ç»„ä»¶é€‰é¡¹<a class="hash-link" href="#1332-å†…ç½®ç»„ä»¶é€‰é¡¹" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬åœ¨ä½¿ç”¨ç»„ä»¶çš„æ—¶å€™ç»å¸¸åˆ©ç”¨å¯¹è±¡çš„å½¢å¼å®šä¹‰ç»„ä»¶é€‰é¡¹ï¼ŒåŒ…æ‹¬<code>data,method,computed</code>ç­‰ï¼Œå¹¶åœ¨çˆ¶ç»„ä»¶æˆ–æ ¹ç»„ä»¶ä¸­æ³¨å†Œã€‚<code>keep-alive</code>åŒæ ·éµå¾ªè¿™ä¸ªé“ç†ï¼Œå†…ç½®ä¸¤å­—ä¹Ÿè¯´æ˜äº†<code>keep-alive</code>æ˜¯åœ¨<code>Vue</code>æºç ä¸­å†…ç½®å¥½çš„é€‰é¡¹é…ç½®ï¼Œå¹¶ä¸”ä¹Ÿå·²ç»æ³¨å†Œåˆ°å…¨å±€ï¼Œè¿™ä¸€éƒ¨åˆ†çš„æºç å¯ä»¥å‚è€ƒç»„æ€ç»„ä»¶å°èŠ‚æœ«å°¾å¯¹å†…ç½®ç»„ä»¶æ„é€ å™¨å’Œæ³¨å†Œè¿‡ç¨‹çš„ä»‹ç»ã€‚è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¸€ä¸‹<code>keep-alive</code>çš„å…·ä½“é€‰é¡¹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// keepaliveç»„ä»¶é€‰é¡¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token maybe-class-name">KeepAlive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;keep-alive&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æŠ½è±¡ç»„ä»¶çš„æ ‡å¿—</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    abstract</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// keep-aliveå…è®¸ä½¿ç”¨çš„props</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    props</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      include</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> patternTypes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      exclude</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> patternTypes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      max</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token known-class-name class-name">Number</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">created</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">created</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ç¼“å­˜ç»„ä»¶vnode</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cache</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ç¼“å­˜ç»„ä»¶å</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keys</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">destroyed</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">destroyed</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> key </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cache</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pruneCacheEntry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cache</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">mounted</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mounted</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain">$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// åŠ¨æ€includeå’Œexclude</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// å¯¹include exclueçš„ç›‘å¬</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$watch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;include&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">val</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pruneCache</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token plain">$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">val</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$watch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;exclude&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">val</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pruneCache</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token plain">$</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">val</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// keep-aliveçš„æ¸²æŸ“å‡½æ•°</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">render</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">render</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æ‹¿åˆ°keep-aliveä¸‹æ’æ§½çš„å€¼</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> slot </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$slots</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword module" style="color:#00009f">default</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ç¬¬ä¸€ä¸ªvnodeèŠ‚ç‚¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vnode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getFirstComponentChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">slot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æ‹¿åˆ°ç¬¬ä¸€ä¸ªç»„ä»¶å®ä¾‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> componentOptions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentOptions</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// keep-aliveçš„ç¬¬ä¸€ä¸ªå­ç»„ä»¶å®ä¾‹å­˜åœ¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// check pattern</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//æ‹¿åˆ°ç¬¬ä¸€ä¸ªvnodeèŠ‚ç‚¹çš„name</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getComponentName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ref </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> include </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">include</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> exclude </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exclude</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// é€šè¿‡åˆ¤æ–­å­ç»„ä»¶æ˜¯å¦æ»¡è¶³ç¼“å­˜åŒ¹é…</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// not included</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">include </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">include</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// excluded</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exclude </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exclude</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vnode</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ref$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cache </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref$</span><span class="token number" style="color:#36acaa">1.</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref$</span><span class="token number" style="color:#36acaa">1.</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> componentOptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Ctor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cid</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentOptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;::&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentOptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// å†æ¬¡å‘½ä¸­ç¼“å­˜</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// make current key freshest</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// åˆæ¬¡æ¸²æŸ“æ—¶ï¼Œå°†vnodeç¼“å­˜</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// prune oldest entry</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">max</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">pruneCacheEntry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ä¸ºç¼“å­˜ç»„ä»¶æ‰“ä¸Šæ ‡å¿—</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keepAlive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// å°†æ¸²æŸ“çš„vnodeè¿”å›</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vnode </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">slot </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> slot</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>keep-alive</code>é€‰é¡¹è·Ÿæˆ‘ä»¬å¹³æ—¶å†™çš„ç»„ä»¶é€‰é¡¹è¿˜æ˜¯åŸºæœ¬ç±»ä¼¼çš„ï¼Œå”¯ä¸€çš„ä¸åŒæ˜¯<code>keep-ailve</code>ç»„ä»¶æ²¡æœ‰ç”¨<code>template</code>è€Œæ˜¯ä½¿ç”¨<code>render</code>å‡½æ•°ã€‚<code>keep-alive</code>æœ¬è´¨ä¸Šåªæ˜¯å­˜ç¼“å­˜å’Œæ‹¿ç¼“å­˜çš„è¿‡ç¨‹ï¼Œå¹¶æ²¡æœ‰å®é™…çš„èŠ‚ç‚¹æ¸²æŸ“ï¼Œæ‰€ä»¥ä½¿ç”¨<code>render</code>å¤„ç†æ˜¯æœ€ä¼˜çš„é€‰æ‹©ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1333-ç¼“å­˜vnode"></a>13.3.3 ç¼“å­˜vnode<a class="hash-link" href="#1333-ç¼“å­˜vnode" title="Direct link to heading">#</a></h3><p>è¿˜æ˜¯å…ˆå›åˆ°æµç¨‹å›¾çš„åˆ†æã€‚ä¸Šé¢è¯´åˆ°<code>keep-alive</code>åœ¨æ‰§è¡Œç»„ä»¶å®ä¾‹åŒ–ä¹‹åä¼šè¿›è¡Œç»„ä»¶çš„æŒ‚è½½ã€‚è€ŒæŒ‚è½½<code>$mount</code>åˆå›åˆ°<code>vm._render(),vm._update()</code>çš„è¿‡ç¨‹ã€‚ç”±äº<code>keep-alive</code>æ‹¥æœ‰<code>render</code>å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†ç„¦ç‚¹æ”¾åœ¨<code>render</code>å‡½æ•°çš„å®ç°ä¸Šã€‚</p><ul><li>é¦–å…ˆæ˜¯è·å–<code>keep-alive</code>ä¸‹æ’æ§½çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯<code>keep-alive</code>éœ€è¦æ¸²æŸ“çš„å­ç»„ä»¶,ä¾‹å­ä¸­æ˜¯<code>chil1 Vnode</code>å¯¹è±¡ï¼Œæºç ä¸­å¯¹åº”<code>getFirstComponentChild</code>å‡½æ•°ã€‚</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getFirstComponentChild</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">children</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">children</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> children</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> children</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ç»„ä»¶å®ä¾‹å­˜åœ¨ï¼Œåˆ™è¿”å›ï¼Œç†è®ºä¸Šè¿”å›ç¬¬ä¸€ä¸ªç»„ä»¶vnode</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isAsyncPlaceholder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> c</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>åˆ¤æ–­ç»„ä»¶æ»¡è¶³ç¼“å­˜çš„åŒ¹é…æ¡ä»¶ï¼Œåœ¨<code>keep-alive</code>ç»„ä»¶çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œ<code>Vue</code>æºç å…è®¸æˆ‘ä»¬æ˜¯ç”¨<code>include, exclude</code>æ¥å®šä¹‰åŒ¹é…æ¡ä»¶ï¼Œ<code>include</code>è§„å®šäº†åªæœ‰åç§°åŒ¹é…çš„ç»„ä»¶æ‰ä¼šè¢«ç¼“å­˜ï¼Œ<code>exclude</code>è§„å®šäº†ä»»ä½•åç§°åŒ¹é…çš„ç»„ä»¶éƒ½ä¸ä¼šè¢«ç¼“å­˜ã€‚æ›´è€…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>max</code>æ¥é™åˆ¶å¯ä»¥ç¼“å­˜å¤šå°‘åŒ¹é…å®ä¾‹ï¼Œè€Œä¸ºä»€ä¹ˆè¦åšæ•°é‡çš„é™åˆ¶å‘¢ï¼Ÿæˆ‘ä»¬åæ–‡ä¼šæåˆ°ã€‚</li></ul><p>æ‹¿åˆ°å­ç»„ä»¶çš„å®ä¾‹åï¼Œæˆ‘ä»¬éœ€è¦å…ˆè¿›è¡Œæ˜¯å¦æ»¡è¶³åŒ¹é…æ¡ä»¶çš„åˆ¤æ–­,<strong>å…¶ä¸­åŒ¹é…çš„è§„åˆ™å…è®¸ä½¿ç”¨æ•°ç»„ï¼Œå­—ç¬¦ä¸²ï¼Œæ­£åˆ™çš„å½¢å¼ã€‚</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> include </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">include</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> exclude </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exclude</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// é€šè¿‡åˆ¤æ–­å­ç»„ä»¶æ˜¯å¦æ»¡è¶³ç¼“å­˜åŒ¹é…</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// not included</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">include </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">include</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// excluded</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exclude </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exclude</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vnode</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// matches</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">matches</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">pattern</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// å…è®¸ä½¿ç”¨æ•°ç»„[&#x27;child1&#x27;, &#x27;child2&#x27;]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pattern</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> pattern</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">indexOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> pattern </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// å…è®¸ä½¿ç”¨å­—ç¬¦ä¸² child1,child2</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> pattern</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">indexOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isRegExp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pattern</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// å…è®¸ä½¿ç”¨æ­£åˆ™ /^child{1,2}$/g</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> pattern</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* istanbul ignore next */</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å¦‚æœç»„ä»¶ä¸æ»¡è¶³ç¼“å­˜çš„è¦æ±‚ï¼Œåˆ™ç›´æ¥è¿”å›ç»„ä»¶çš„<code>vnode</code>,ä¸åšä»»ä½•å¤„ç†,æ­¤æ—¶ç»„ä»¶ä¼šè¿›å…¥æ­£å¸¸çš„æŒ‚è½½ç¯èŠ‚ã€‚</p><ol start="3"><li><code>render</code>å‡½æ•°æ‰§è¡Œçš„å…³é”®ä¸€æ­¥æ˜¯ç¼“å­˜<code>vnode</code>,ç”±äºæ˜¯ç¬¬ä¸€æ¬¡æ‰§è¡Œ<code>render</code>å‡½æ•°ï¼Œé€‰é¡¹ä¸­çš„<code>cache</code>å’Œ<code>keys</code>æ•°æ®éƒ½æ²¡æœ‰å€¼ï¼Œå…¶ä¸­<code>cache</code>æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œæˆ‘ä»¬å°†ç”¨å®ƒæ¥ç¼“å­˜<code>{ name: vnode }</code>æšä¸¾ï¼Œè€Œ<code>keys</code>æˆ‘ä»¬ç”¨æ¥ç¼“å­˜ç»„ä»¶åã€‚
<strong>å› æ­¤æˆ‘ä»¬åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“<code>keep-alive</code>æ—¶ï¼Œä¼šå°†éœ€è¦æ¸²æŸ“çš„å­ç»„ä»¶<code>vnode</code>è¿›è¡Œç¼“å­˜ã€‚</strong></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">    cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="4"><li>å°†å·²ç»ç¼“å­˜çš„<code>vnode</code>æ‰“ä¸Šæ ‡è®°, å¹¶å°†å­ç»„ä»¶çš„<code>Vnode</code>è¿”å›ã€‚
<code>vnode.data.keepAlive = true</code></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1334-çœŸå®èŠ‚ç‚¹çš„ä¿å­˜"></a>13.3.4 çœŸå®èŠ‚ç‚¹çš„ä¿å­˜<a class="hash-link" href="#1334-çœŸå®èŠ‚ç‚¹çš„ä¿å­˜" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬å†å›åˆ°<code>createComponent</code>çš„é€»è¾‘ï¼Œä¹‹å‰æåˆ°<code>createComponent</code>ä¼šå…ˆæ‰§è¡Œ<code>keep-alive</code>ç»„ä»¶çš„åˆå§‹åŒ–æµç¨‹ï¼Œä¹ŸåŒ…æ‹¬äº†å­ç»„ä»¶çš„æŒ‚è½½ã€‚å¹¶ä¸”æˆ‘ä»¬é€šè¿‡<code>componentInstance</code>æ‹¿åˆ°äº†<code>keep-alive</code>ç»„ä»¶çš„å®ä¾‹ï¼Œè€Œæ¥ä¸‹æ¥<strong>é‡è¦çš„ä¸€æ­¥æ˜¯å°†çœŸå®çš„<code>dom</code>ä¿å­˜å†<code>vnode</code>ä¸­</strong>ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// å…¶ä¸­ä¸€ä¸ªä½œç”¨æ˜¯ä¿ç•™çœŸå®domåˆ°vnodeä¸­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">initComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// å°†çœŸå®èŠ‚ç‚¹æ·»åŠ åˆ°çˆ¶èŠ‚ç‚¹ä¸­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentElm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">elm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> refElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isTrue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isReactivated</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">reactivateComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> parentElm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> refElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>insert</code>çš„æºç ä¸åˆ—ä¸¾å‡ºæ¥ï¼Œå®ƒåªæ˜¯ç®€å•çš„è°ƒç”¨æ“ä½œ<code>dom</code>çš„<code>api</code>,å°†å­èŠ‚ç‚¹æ’å…¥åˆ°çˆ¶èŠ‚ç‚¹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é‡ç‚¹çœ‹çœ‹<code>initComponent</code>å…³é”®æ­¥éª¤çš„é€»è¾‘ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// vnodeä¿ç•™çœŸå®èŠ‚ç‚¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">elm</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$el</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>å› æ­¤ï¼Œæˆ‘ä»¬å¾ˆæ¸…æ™°çš„å›åˆ°ä¹‹å‰é—ç•™ä¸‹æ¥çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆ<code>keep-alive</code>éœ€è¦ä¸€ä¸ª<code>max</code>æ¥é™åˆ¶ç¼“å­˜ç»„ä»¶çš„æ•°é‡ã€‚åŸå› å°±æ˜¯<code>keep-alive</code>ç¼“å­˜çš„ç»„ä»¶æ•°æ®é™¤äº†åŒ…æ‹¬<code>vnode</code>è¿™ä¸€æè¿°å¯¹è±¡å¤–ï¼Œè¿˜ä¿ç•™ç€çœŸå®çš„<code>dom</code>èŠ‚ç‚¹,è€Œæˆ‘ä»¬çŸ¥é“çœŸå®èŠ‚ç‚¹å¯¹è±¡æ˜¯åºå¤§çš„ï¼Œæ‰€ä»¥å¤§é‡ä¿ç•™ç¼“å­˜ç»„ä»¶æ˜¯è€—è´¹æ€§èƒ½çš„ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä¸¥æ ¼æ§åˆ¶ç¼“å­˜çš„ç»„ä»¶æ•°é‡ï¼Œè€Œåœ¨ç¼“å­˜ç­–ç•¥ä¸Šä¹Ÿéœ€è¦åšä¼˜åŒ–ï¼Œè¿™ç‚¹æˆ‘ä»¬åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¹Ÿç»§ç»­æåˆ°ã€‚</strong></p><p>ç”±äº<code>isReactivated</code>ä¸º<code>false</code>,<code>reactivateComponent</code>å‡½æ•°ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚è‡³æ­¤<code>keep-alive</code>çš„åˆæ¬¡æ¸²æŸ“æµç¨‹åˆ†æå®Œæ¯•ã€‚</p><p><strong>å¦‚æœå¿½ç•¥æ­¥éª¤çš„åˆ†æï¼Œåªå¯¹åˆæ¬¡æ¸²æŸ“æµç¨‹åšä¸€ä¸ªæ€»ç»“ï¼šå†…ç½®çš„<code>keep-alive</code>ç»„ä»¶ï¼Œè®©å­ç»„ä»¶åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™å°†<code>vnode</code>å’ŒçœŸå®çš„<code>elm</code>è¿›è¡Œäº†ç¼“å­˜ã€‚</strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="134-æŠ½è±¡ç»„ä»¶"></a>13.4 æŠ½è±¡ç»„ä»¶<a class="hash-link" href="#134-æŠ½è±¡ç»„ä»¶" title="Direct link to heading">#</a></h2><p>è¿™ä¸€èŠ‚çš„æœ€åé¡ºä¾¿æä¸€ä¸‹ä¸Šæ–‡æåˆ°çš„æŠ½è±¡ç»„ä»¶çš„æ¦‚å¿µã€‚<code>Vue</code>æä¾›çš„å†…ç½®ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæè¿°ç»„ä»¶ç±»å‹çš„é€‰é¡¹ï¼Œè¿™ä¸ªé€‰é¡¹å°±æ˜¯<code>{ astract: true }</code>,å®ƒè¡¨æ˜äº†è¯¥ç»„ä»¶æ˜¯æŠ½è±¡ç»„ä»¶ã€‚ä»€ä¹ˆæ˜¯æŠ½è±¡ç»„ä»¶ï¼Œä¸ºä»€ä¹ˆè¦æœ‰è¿™ä¸€ç±»å‹çš„åŒºåˆ«å‘¢ï¼Ÿæˆ‘è§‰å¾—å½’æ ¹ç©¶åº•æœ‰ä¸¤ä¸ªæ–¹é¢çš„åŸå› ã€‚</p><ol><li>æŠ½è±¡ç»„ä»¶æ²¡æœ‰çœŸå®çš„èŠ‚ç‚¹ï¼Œå®ƒåœ¨ç»„ä»¶æ¸²æŸ“é˜¶æ®µä¸ä¼šå»è§£ææ¸²æŸ“æˆçœŸå®çš„<code>dom</code>èŠ‚ç‚¹ï¼Œè€Œåªæ˜¯ä½œä¸ºä¸­é—´çš„æ•°æ®è¿‡æ¸¡å±‚å¤„ç†ï¼Œåœ¨<code>keep-alive</code>ä¸­æ˜¯å¯¹ç»„ä»¶ç¼“å­˜çš„å¤„ç†ã€‚</li><li>åœ¨æˆ‘ä»¬ä»‹ç»ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™æ›¾ç»è¯´åˆ°çˆ¶å­ç»„ä»¶ä¼šæ˜¾å¼çš„å»ºç«‹ä¸€å±‚å…³ç³»ï¼Œè¿™å±‚å…³ç³»å¥ å®šäº†çˆ¶å­ç»„ä»¶ä¹‹é—´é€šä¿¡çš„åŸºç¡€ã€‚æˆ‘ä»¬å¯ä»¥å†æ¬¡å›é¡¾ä¸€ä¸‹<code>initLifecycle</code>çš„ä»£ç ã€‚</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">_init</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">initLifecycle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initLifecycle</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$options</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> parent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">parent</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parent </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">abstract</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// å¦‚æœæœ‰abstractå±æ€§ï¼Œä¸€ç›´å¾€ä¸Šå±‚å¯»æ‰¾ï¼Œç›´åˆ°ä¸æ˜¯æŠ½è±¡ç»„ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">abstract</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> parent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$parent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        parent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$parent</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      parent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$children</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å­ç»„ä»¶åœ¨æ³¨å†Œé˜¶æ®µä¼šæŠŠçˆ¶å®ä¾‹æŒ‚è½½åˆ°è‡ªèº«é€‰é¡¹çš„<code>parent</code>å±æ€§ä¸Šï¼Œåœ¨<code>initLifecycle</code>è¿‡ç¨‹ä¸­ï¼Œä¼šåå‘æ‹¿åˆ°<code>parent</code>ä¸Šçš„çˆ¶ç»„ä»¶<code>vnode</code>,å¹¶ä¸ºå…¶<code>$children</code>å±æ€§æ·»åŠ è¯¥å­ç»„ä»¶<code>vnode</code>,å¦‚æœåœ¨åå‘æ‰¾çˆ¶ç»„ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œçˆ¶ç»„ä»¶æ‹¥æœ‰<code>abstract</code>å±æ€§ï¼Œå³å¯åˆ¤å®šè¯¥ç»„ä»¶ä¸ºæŠ½è±¡ç»„ä»¶ï¼Œæ­¤æ—¶åˆ©ç”¨<code>parent</code>çš„é“¾æ¡å¾€ä¸Šå¯»æ‰¾ï¼Œç›´åˆ°ç»„ä»¶ä¸æ˜¯æŠ½è±¡ç»„ä»¶ä¸ºæ­¢ã€‚<code>initLifecycle</code>çš„å¤„ç†ï¼Œè®©æ¯ä¸ªç»„ä»¶éƒ½èƒ½æ‰¾åˆ°ä¸Šå±‚çš„çˆ¶ç»„ä»¶ä»¥åŠä¸‹å±‚çš„å­ç»„ä»¶ï¼Œä½¿å¾—ç»„ä»¶ä¹‹é—´å½¢æˆä¸€ä¸ªç´§å¯†çš„å…³ç³»æ ‘ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="135-å°ç»“"></a>13.5 å°ç»“<a class="hash-link" href="#135-å°ç»“" title="Direct link to heading">#</a></h3><p>è¿™ä¸€èŠ‚ä»‹ç»äº†<code>Vue</code>å†…ç½®ç»„ä»¶ä¸­ä¸€ä¸ªæœ€é‡è¦çš„ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ç»„ä»¶<code>keep-alive</code>ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸å°†<code>keep-alive</code>é…åˆåŠ¨æ€ç»„ä»¶<code>is</code>ä½¿ç”¨ï¼Œè¾¾åˆ°åˆ‡æ¢ç»„ä»¶çš„åŒæ—¶ï¼Œå°†æ—§çš„ç»„ä»¶ç¼“å­˜ã€‚æœ€ç»ˆè¾¾åˆ°ä¿ç•™åˆå§‹çŠ¶æ€çš„ç›®çš„ã€‚åœ¨ç¬¬ä¸€æ¬¡ç»„ä»¶æ¸²æŸ“æ—¶ï¼Œ<code>keep-alive</code>ä¼šå°†ç»„ä»¶<code>Vnode</code>ä»¥åŠå¯¹åº”çš„çœŸå®èŠ‚ç‚¹è¿›è¡Œç¼“å­˜ã€‚è€Œå½“å†æ¬¡æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œ<code>keep-alive</code>æ˜¯å¦‚ä½•åˆ©ç”¨è¿™äº›ç¼“å­˜çš„ï¼Ÿæºç åˆå¯¹ç¼“å­˜è¿›è¡Œäº†ä¼˜åŒ–ï¼Ÿå¹¶ä¸”<code>keep-alive</code>ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸåˆåŒ…æ‹¬å“ªäº›ï¼Œè¿™äº›ç–‘é—®æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸€ä¸€å±•å¼€ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated on <b><time datetime="2021-09-17T09:39:01.000Z">9/17/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/In-depth-analysis-of-Vue/åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹ Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#131-åŸºæœ¬ç”¨æ³•" class="table-of-contents__link">13.1 åŸºæœ¬ç”¨æ³•</a></li><li><a href="#132-ä»æ¨¡æ¿ç¼–è¯‘åˆ°ç”Ÿæˆvnode" class="table-of-contents__link">13.2 ä»æ¨¡æ¿ç¼–è¯‘åˆ°ç”Ÿæˆvnode</a></li><li><a href="#133-åˆæ¬¡æ¸²æŸ“" class="table-of-contents__link">13.3 åˆæ¬¡æ¸²æŸ“</a><ul><li><a href="#1331-æµç¨‹å›¾" class="table-of-contents__link">13.3.1 æµç¨‹å›¾</a></li><li><a href="#1332-å†…ç½®ç»„ä»¶é€‰é¡¹" class="table-of-contents__link">13.3.2 å†…ç½®ç»„ä»¶é€‰é¡¹</a></li><li><a href="#1333-ç¼“å­˜vnode" class="table-of-contents__link">13.3.3 ç¼“å­˜vnode</a></li><li><a href="#1334-çœŸå®èŠ‚ç‚¹çš„ä¿å­˜" class="table-of-contents__link">13.3.4 çœŸå®èŠ‚ç‚¹çš„ä¿å­˜</a></li></ul></li><li><a href="#134-æŠ½è±¡ç»„ä»¶" class="table-of-contents__link">13.4 æŠ½è±¡ç»„ä»¶</a><ul><li><a href="#135-å°ç»“" class="table-of-contents__link">13.5 å°ç»“</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021, Power By <a href="https://www.docusaurus.cn/">Docusaurus</a>.</div></div></div></footer></div>
<script src="/In-depth-analysis-of-Vue/assets/js/runtime~main.df0025c9.js"></script>
<script src="/In-depth-analysis-of-Vue/assets/js/main.fe9c40e7.js"></script>
</body>
</html>