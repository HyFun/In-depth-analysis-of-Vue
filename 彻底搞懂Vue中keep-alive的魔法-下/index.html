<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹ | æ·±å…¥å‰–æVueæºç </title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹ | æ·±å…¥å‰–æVueæºç "><meta data-react-helmet="true" name="description" content="ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬å¯¹`keep-alive`ç»„ä»¶çš„åˆå§‹æ¸²æŸ“æµç¨‹ä»¥åŠç»„ä»¶çš„é…ç½®ä¿¡æ¯è¿›è¡Œäº†æºç åˆ†æã€‚åˆå§‹æ¸²æŸ“æµç¨‹æœ€å…³é”®çš„ä¸€æ­¥æ˜¯å¯¹æ¸²æŸ“çš„ç»„ä»¶`Vnode`è¿›è¡Œç¼“å­˜ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬äº†ç»„ä»¶çš„çœŸå®èŠ‚ç‚¹å­˜å‚¨ã€‚æœ‰äº†ç¬¬ä¸€æ¬¡çš„ç¼“å­˜ï¼Œå½“å†æ¬¡æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œ`keep-alive`åˆæ‹¥æœ‰å“ªäº›é­”æ³•å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å°†å½»åº•æ­å¼€è¿™ä¸€å±‚é¢çº±ã€‚"><meta data-react-helmet="true" property="og:description" content="ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬å¯¹`keep-alive`ç»„ä»¶çš„åˆå§‹æ¸²æŸ“æµç¨‹ä»¥åŠç»„ä»¶çš„é…ç½®ä¿¡æ¯è¿›è¡Œäº†æºç åˆ†æã€‚åˆå§‹æ¸²æŸ“æµç¨‹æœ€å…³é”®çš„ä¸€æ­¥æ˜¯å¯¹æ¸²æŸ“çš„ç»„ä»¶`Vnode`è¿›è¡Œç¼“å­˜ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬äº†ç»„ä»¶çš„çœŸå®èŠ‚ç‚¹å­˜å‚¨ã€‚æœ‰äº†ç¬¬ä¸€æ¬¡çš„ç¼“å­˜ï¼Œå½“å†æ¬¡æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œ`keep-alive`åˆæ‹¥æœ‰å“ªäº›é­”æ³•å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å°†å½»åº•æ­å¼€è¿™ä¸€å±‚é¢çº±ã€‚"><link data-react-helmet="true" rel="shortcut icon" href="/In-depth-analysis-of-Vue/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹" hreflang="x-default"><link rel="stylesheet" href="/In-depth-analysis-of-Vue/assets/css/styles.6d09dbb1.css">
<link rel="preload" href="/In-depth-analysis-of-Vue/assets/js/runtime~main.df0025c9.js" as="script">
<link rel="preload" href="/In-depth-analysis-of-Vue/assets/js/main.fe9c40e7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/In-depth-analysis-of-Vue/"><img src="/In-depth-analysis-of-Vue/img/logo.svg" alt="æ·±å…¥å‰–æVueæºç " class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/In-depth-analysis-of-Vue/img/logo.svg" alt="æ·±å…¥å‰–æVueæºç " class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">æ·±å…¥å‰–æVueæºç </b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Ocean1509/In-depth-analysis-of-Vue" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ç›®å½•">ç›®å½•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ä¸°å¯Œçš„é€‰é¡¹åˆå¹¶ç­–ç•¥">ä¸°å¯Œçš„é€‰é¡¹åˆå¹¶ç­–ç•¥</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/åŸºç¡€çš„æ•°æ®ä»£ç†æ£€æµ‹">åŸºç¡€çš„æ•°æ®ä»£ç†æ£€æµ‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/å®ä¾‹æŒ‚è½½æµç¨‹å’Œæ¨¡æ¿ç¼–è¯‘">å®ä¾‹æŒ‚è½½æµç¨‹å’Œæ¨¡æ¿ç¼–è¯‘</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/å®Œæ•´æ¸²æŸ“æµç¨‹">å®Œæ•´æ¸²æŸ“æµç¨‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ç»„ä»¶åŸºç¡€å‰–æ">ç»„ä»¶åŸºç¡€å‰–æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ç»„ä»¶é«˜çº§ç”¨æ³•">ç»„ä»¶é«˜çº§ç”¨æ³•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸Š</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸‹</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­">æ·±å…¥å“åº”å¼ç³»ç»Ÿæ„å»º-ä¸­</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•">æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶">æ­ç§˜Vueçš„äº‹ä»¶æœºåˆ¶</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ">vueæ’æ§½ï¼Œä½ æƒ³äº†è§£çš„éƒ½åœ¨è¿™é‡Œ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/ä½ çœŸçš„äº†è§£v-modelçš„è¯­æ³•ç³–äº†å—">ä½ çœŸçš„äº†è§£v-modelçš„è¯­æ³•ç³–äº†å—</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ">åŠ¨æ€ç»„ä»¶çš„æ·±å…¥åˆ†æ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹">å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸‹</h1></header><blockquote><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬å¯¹<code>keep-alive</code>ç»„ä»¶çš„åˆå§‹æ¸²æŸ“æµç¨‹ä»¥åŠç»„ä»¶çš„é…ç½®ä¿¡æ¯è¿›è¡Œäº†æºç åˆ†æã€‚åˆå§‹æ¸²æŸ“æµç¨‹æœ€å…³é”®çš„ä¸€æ­¥æ˜¯å¯¹æ¸²æŸ“çš„ç»„ä»¶<code>Vnode</code>è¿›è¡Œç¼“å­˜ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬äº†ç»„ä»¶çš„çœŸå®èŠ‚ç‚¹å­˜å‚¨ã€‚æœ‰äº†ç¬¬ä¸€æ¬¡çš„ç¼“å­˜ï¼Œå½“å†æ¬¡æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œ<code>keep-alive</code>åˆæ‹¥æœ‰å“ªäº›é­”æ³•å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å°†å½»åº•æ­å¼€è¿™ä¸€å±‚é¢çº±ã€‚</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="135-å‡†å¤‡å·¥ä½œ"></a>13.5 å‡†å¤‡å·¥ä½œ<a class="hash-link" href="#135-å‡†å¤‡å·¥ä½œ" title="Direct link to heading">#</a></h2><p>ä¸Šä¸€èŠ‚å¯¹<code>keep-alive</code>ç»„ä»¶çš„åˆ†æï¼Œæ˜¯ä»æˆ‘ç”»çš„ä¸€ä¸ªæµç¨‹å›¾å¼€å§‹çš„ã€‚å¦‚æœä¸æƒ³å›è¿‡å¤´çœ‹ä¸Šä¸€èŠ‚çš„å†…å®¹ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹çš„ç®€å•æ€»ç»“ã€‚</p><ol><li><code>keep-alive</code>æ˜¯æºç å†…éƒ¨å®šä¹‰çš„ç»„ä»¶é€‰é¡¹é…ç½®ï¼Œå®ƒä¼šå…ˆæ³¨å†Œä¸ºå…¨å±€ç»„ä»¶ä¾›å¼€å‘è€…å…¨å±€ä½¿ç”¨ï¼Œå…¶ä¸­<code>render</code>å‡½æ•°å®šä¹‰äº†å®ƒçš„æ¸²æŸ“è¿‡ç¨‹</li><li>å’Œæ™®é€šç»„ä»¶ä¸€è‡´ï¼Œå½“çˆ¶åœ¨åˆ›å»ºçœŸå®èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°<code>keep-alive</code>çš„ç»„ä»¶ä¼šè¿›è¡Œç»„ä»¶çš„åˆå§‹åŒ–å’Œå®ä¾‹åŒ–ã€‚</li><li>å®ä¾‹åŒ–ä¼šæ‰§è¡ŒæŒ‚è½½<code>$mount</code>çš„è¿‡ç¨‹ï¼Œè¿™ä¸€æ­¥ä¼šæ‰§è¡Œ<code>keep-alive</code>é€‰é¡¹ä¸­çš„<code>render</code>å‡½æ•°ã€‚</li><li><code>render</code>å‡½æ•°åœ¨åˆå§‹æ¸²æŸ“æ—¶ï¼Œä¼šå°†æ¸²æŸ“çš„å­<code>Vnode</code>è¿›è¡Œç¼“å­˜ã€‚åŒæ—¶<strong>å¯¹åº”çš„å­çœŸå®èŠ‚ç‚¹ä¹Ÿä¼šè¢«ç¼“å­˜èµ·æ¥</strong>ã€‚</li></ol><p>é‚£ä¹ˆï¼Œå½“å†æ¬¡éœ€è¦æ¸²æŸ“åˆ°å·²ç»è¢«æ¸²æŸ“è¿‡çš„ç»„ä»¶æ—¶ï¼Œ<code>keep-alive</code>çš„å¤„ç†åˆæœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1351-åŸºç¡€ä½¿ç”¨"></a>13.5.1 åŸºç¡€ä½¿ç”¨<a class="hash-link" href="#1351-åŸºç¡€ä½¿ç”¨" title="Direct link to heading">#</a></h3><p>ä¸ºäº†æ–‡ç« çš„å®Œæ•´æ€§ï¼Œæˆ‘ä¾æ—§æŠŠåŸºç¡€çš„ä½¿ç”¨å±•ç¤ºå‡ºæ¥ï¼Œå…¶ä¸­åŠ å…¥äº†ç”Ÿå‘½å‘¨æœŸçš„ä½¿ç”¨ï¼Œæ–¹ä¾¿åç»­å¯¹<code>keep-alive</code>ç”Ÿå‘½å‘¨æœŸçš„åˆ†æã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">app</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">@click</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">changeTabs(</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">child1</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">)</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">child1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">@click</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">changeTabs(</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">child2</span><span class="token tag attr-value punctuation" style="color:#393A34">&#x27;</span><span class="token tag attr-value" style="color:#e3116c">)</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">child2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">keep-alive</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">component</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">:is</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">chooseTabs</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">component</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">keep-alive</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> child1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    template</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;div&gt;&lt;button @click=&quot;add&quot;&gt;add&lt;/button&gt;&lt;p&gt;{{num}}&lt;/p&gt;&lt;/div&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            num</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    methods</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">num</span><span class="token operator" style="color:#393A34">++</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">mounted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;child1 mounted&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">activated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;child1 activated&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">deactivated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;child1 deactivated&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">destoryed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;child1 destoryed&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> child2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    template</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;div&gt;child2&lt;/div&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">mounted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;child2 mounted&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">activated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;child2 activated&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">deactivated</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;child2 deactivated&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">destoryed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;child2 destoryed&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    el</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;#app&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    components</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        child1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        child2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            chooseTabs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;child1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    methods</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">changeTabs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">tab</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">chooseTabs</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tab</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1352-æµç¨‹å›¾"></a>13.5.2 æµç¨‹å›¾<a class="hash-link" href="#1352-æµç¨‹å›¾" title="Direct link to heading">#</a></h3><p>å’Œé¦–æ¬¡æ¸²æŸ“çš„åˆ†æä¸€è‡´ï¼Œå†æ¬¡æ¸²æŸ“çš„è¿‡ç¨‹æˆ‘ä¾æ—§ç”»äº†ä¸€ä¸ªç®€å•çš„æµç¨‹å›¾ã€‚</p><p><img src="data:image/png;base64,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"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="136-æµç¨‹åˆ†æ"></a>13.6 æµç¨‹åˆ†æ<a class="hash-link" href="#136-æµç¨‹åˆ†æ" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1361-é‡æ–°æ¸²æŸ“ç»„ä»¶"></a>13.6.1 é‡æ–°æ¸²æŸ“ç»„ä»¶<a class="hash-link" href="#1361-é‡æ–°æ¸²æŸ“ç»„ä»¶" title="Direct link to heading">#</a></h3><p>å†æ¬¡æ¸²æŸ“çš„æµç¨‹ä»æ•°æ®æ”¹å˜è¯´èµ·ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåŠ¨æ€ç»„ä»¶ä¸­<code>chooseTabs</code>æ•°æ®çš„å˜åŒ–ä¼šå¼•èµ·ä¾èµ–æ´¾å‘æ›´æ–°çš„è¿‡ç¨‹(è¿™ä¸ªç³»åˆ—æœ‰ä¸‰ç¯‡æ–‡ç« è¯¦ç»†ä»‹ç»äº†vueå“åº”å¼ç³»ç»Ÿçš„åº•å±‚å®ç°ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å€Ÿé‰´)ã€‚ç®€å•æ¥è¯´ï¼Œ<code>chooseTabs</code>è¿™ä¸ªæ•°æ®åœ¨åˆå§‹åŒ–é˜¶æ®µä¼šæ”¶é›†ä½¿ç”¨åˆ°è¯¥æ•°æ®çš„ç›¸å…³ä¾èµ–ã€‚å½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ”¶é›†è¿‡çš„ä¾èµ–ä¼šè¿›è¡Œæ´¾å‘æ›´æ–°æ“ä½œã€‚</p><p>å…¶ä¸­ï¼Œçˆ¶ç»„ä»¶ä¸­è´Ÿè´£å®ä¾‹æŒ‚è½½çš„è¿‡ç¨‹ä½œä¸ºä¾èµ–ä¼šè¢«æ‰§è¡Œï¼Œå³æ‰§è¡Œçˆ¶ç»„ä»¶çš„<code>vm._update(vm._render(), hydrating);</code>ã€‚<code>_render</code>å’Œ<code>_update</code>åˆ†åˆ«ä»£è¡¨ä¸¤ä¸ªè¿‡ç¨‹ï¼Œå…¶ä¸­<code>_render</code>å‡½æ•°ä¼šæ ¹æ®æ•°æ®çš„å˜åŒ–ä¸ºç»„ä»¶ç”Ÿæˆæ–°çš„<code>Vnode</code>èŠ‚ç‚¹ï¼Œè€Œ<code>_update</code>æœ€ç»ˆä¼šä¸ºæ–°çš„<code>Vnode</code>ç”ŸæˆçœŸå®çš„èŠ‚ç‚¹ã€‚è€Œåœ¨ç”ŸæˆçœŸå®èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œä¼šåˆ©ç”¨<code>vitrual dom</code>çš„<code>diff</code>ç®—æ³•å¯¹å‰å<code>vnode</code>èŠ‚ç‚¹è¿›è¡Œå¯¹æ¯”ï¼Œä½¿ä¹‹å°½å¯èƒ½å°‘çš„æ›´æ”¹çœŸå®èŠ‚ç‚¹ï¼Œè¿™ä¸€éƒ¨åˆ†å†…å®¹å¯ä»¥å›é¡¾<a href="https://juejin.im/post/5d3967a56fb9a07efc49cca1" target="_blank" rel="noopener noreferrer">æ·±å…¥å‰–æVueæºç  - æ¥ï¼Œè·Ÿæˆ‘ä¸€èµ·å®ç°diffç®—æ³•!</a>ï¼Œé‡Œé¢è¯¦ç»†é˜è¿°äº†åˆ©ç”¨<code>diff</code>ç®—æ³•è¿›è¡ŒèŠ‚ç‚¹å·®å¼‚å¯¹æ¯”çš„æ€è·¯ã€‚</p><p><code>patch</code>æ˜¯æ–°æ—§<code>Vnode</code>èŠ‚ç‚¹å¯¹æ¯”çš„è¿‡ç¨‹ï¼Œè€Œ<code>patchVnode</code>æ˜¯å…¶ä¸­æ ¸å¿ƒçš„æ­¥éª¤ï¼Œæˆ‘ä»¬å¿½ç•¥<code>patchVnode</code>å…¶ä»–çš„æµç¨‹ï¼Œå…³æ³¨åˆ°å…¶ä¸­å¯¹å­ç»„ä»¶æ‰§è¡Œ<code>prepatch</code>é’©å­çš„è¿‡ç¨‹ä¸­ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">patchVnode</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">oldVnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">vnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">insertedVnodeQueue</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">ownerArray</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">index</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">removeOnly</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ–°vnode  æ‰§è¡Œprepatché’©å­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hook</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prepatch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">i</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oldVnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ‰§è¡Œ<code>prepatch</code>é’©å­æ—¶ä¼šæ‹¿åˆ°æ–°æ—§ç»„ä»¶çš„å®ä¾‹å¹¶æ‰§è¡Œ<code>updateChildComponent</code>å‡½æ•°ã€‚è€Œ<code>updateChildComponent</code>ä¼šå¯¹é’ˆå¯¹æ–°çš„ç»„ä»¶å®ä¾‹å¯¹æ—§å®ä¾‹è¿›è¡ŒçŠ¶æ€çš„æ›´æ–°ï¼ŒåŒ…æ‹¬<code>props,listeners</code>ç­‰ï¼Œæœ€ç»ˆä¼š<strong>è°ƒç”¨<code>vue</code>æä¾›çš„å…¨å±€<code>vm.$forceUpdate()</code>æ–¹æ³•è¿›è¡Œå®ä¾‹çš„é‡æ–°æ¸²æŸ“ã€‚</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> componentVNodeHooks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ä¹‹å‰åˆ†æçš„inité’©å­ </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">init</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">prepatch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">prepatch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">oldVnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// æ–°ç»„ä»¶å®ä¾‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentOptions</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æ—§ç»„ä»¶å®ä¾‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> child </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> oldVnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">updateChildComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        child</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">propsData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// updated props</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">listeners</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// updated listeners</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// new parent vnode</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">children</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// new children</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">updateChildComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ›´æ–°æ—§çš„çŠ¶æ€ï¼Œä¸åˆ†æè¿™ä¸ªè¿‡ç¨‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// è¿«ä½¿å®ä¾‹é‡æ–°æ¸²æŸ“ã€‚</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$forceUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å…ˆçœ‹çœ‹<code>$forceUpdate</code>åšäº†ä»€ä¹ˆæ“ä½œã€‚<code>$forceUpdate</code>æ˜¯æºç å¯¹å¤–æš´éœ²çš„ä¸€ä¸ªapiï¼Œä»–ä»¬è¿«ä½¿<code>Vue</code>å®ä¾‹é‡æ–°æ¸²æŸ“ï¼Œæœ¬è´¨ä¸Šæ˜¯æ‰§è¡Œå®ä¾‹æ‰€æ”¶é›†çš„ä¾èµ–ï¼Œåœ¨ä¾‹å­ä¸­<code>watcher</code>å¯¹åº”çš„æ˜¯<code>keep-alive</code>çš„<code>vm._update(vm._render(), hydrating);</code>è¿‡ç¨‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token class-name">Vue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">$forceUpdate</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_watcher</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_watcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1362-é‡ç”¨ç¼“å­˜ç»„ä»¶"></a>13.6.2 é‡ç”¨ç¼“å­˜ç»„ä»¶<a class="hash-link" href="#1362-é‡ç”¨ç¼“å­˜ç»„ä»¶" title="Direct link to heading">#</a></h3><p>ç”±äº<code>vm.$forceUpdate()</code>ä¼šå¼ºè¿«<code>keep-alive</code>ç»„ä»¶è¿›è¡Œé‡æ–°æ¸²æŸ“ï¼Œå› æ­¤<code>keep-alive</code>ç»„ä»¶ä¼šå†ä¸€æ¬¡æ‰§è¡Œ<code>render</code>è¿‡ç¨‹ã€‚è¿™ä¸€æ¬¡ç”±äºç¬¬ä¸€æ¬¡å¯¹<code>vnode</code>çš„ç¼“å­˜ï¼Œ<code>keep-alive</code>åœ¨å®ä¾‹çš„<code>cache</code>å¯¹è±¡ä¸­æ‰¾åˆ°äº†ç¼“å­˜çš„ç»„ä»¶ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// keepaliveç»„ä»¶é€‰é¡¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> keepAlive </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;keep-alive&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    abstract</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">render</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">render</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æ‹¿åˆ°keep-aliveä¸‹æ’æ§½çš„å€¼</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> slot </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$slots</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword module" style="color:#00009f">default</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ç¬¬ä¸€ä¸ªvnodeèŠ‚ç‚¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> vnode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getFirstComponentChild</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">slot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æ‹¿åˆ°ç¬¬ä¸€ä¸ªç»„ä»¶å®ä¾‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> componentOptions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentOptions</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// keep-aliveçš„ç¬¬ä¸€ä¸ªå­ç»„ä»¶å®ä¾‹å­˜åœ¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// check pattern</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//æ‹¿åˆ°ç¬¬ä¸€ä¸ªvnodeèŠ‚ç‚¹çš„name</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getComponentName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ref </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> include </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">include</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> exclude </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exclude</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// é€šè¿‡åˆ¤æ–­å­ç»„ä»¶æ˜¯å¦æ»¡è¶³ç¼“å­˜åŒ¹é…</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// not included</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">include </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">include</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// excluded</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exclude </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">matches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exclude</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vnode</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ref$</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cache </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref$</span><span class="token number" style="color:#36acaa">1.</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref$</span><span class="token number" style="color:#36acaa">1.</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> componentOptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Ctor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cid</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentOptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;::&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentOptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">key</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// ==== å…³æ³¨ç‚¹åœ¨è¿™é‡Œ ====</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// ç›´æ¥å–å‡ºç¼“å­˜ç»„ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// keyså‘½ä¸­çš„ç»„ä»¶åç§»åˆ°æ•°ç»„æœ«ç«¯</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// åˆæ¬¡æ¸²æŸ“æ—¶ï¼Œå°†vnodeç¼“å­˜</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// prune oldest entry</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">max</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">pruneCacheEntry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keepAlive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> vnode </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">slot </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> slot</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>render</code>å‡½æ•°å‰é¢é€»è¾‘å¯ä»¥å‚è€ƒå‰ä¸€ç¯‡æ–‡ç« ï¼Œç”±äº<code>cache</code>å¯¹è±¡ä¸­å­˜å‚¨äº†å†æ¬¡ä½¿ç”¨çš„<code>vnode</code>å¯¹è±¡ï¼Œæ‰€ä»¥ç›´æ¥é€šè¿‡<code>cache[key]</code>å–å‡ºç¼“å­˜çš„ç»„ä»¶å®ä¾‹å¹¶èµ‹å€¼ç»™<code>vnode</code>çš„<code>componentInstance</code>å±æ€§ã€‚å¯èƒ½åœ¨è¯»åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œä¼šå¯¹æºç ä¸­<code>keys</code>è¿™ä¸ªæ•°ç»„çš„ä½œç”¨ï¼Œä»¥åŠ<code>pruneCacheEntry</code>çš„åŠŸèƒ½æœ‰ç–‘æƒ‘ï¼Œè¿™é‡Œæˆ‘ä»¬æ”¾åˆ°æ–‡ç« æœ«å°¾è®²ç¼“å­˜ä¼˜åŒ–ç­–ç•¥æ—¶è§£ç­”ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1363-çœŸå®èŠ‚ç‚¹çš„æ›¿æ¢"></a>13.6.3 çœŸå®èŠ‚ç‚¹çš„æ›¿æ¢<a class="hash-link" href="#1363-çœŸå®èŠ‚ç‚¹çš„æ›¿æ¢" title="Direct link to heading">#</a></h3><p>æ‰§è¡Œäº†<code>keep-alive</code>ç»„ä»¶çš„<code>_render</code>è¿‡ç¨‹ï¼Œæ¥ä¸‹æ¥æ˜¯<code>_update</code>äº§ç”ŸçœŸå®çš„èŠ‚ç‚¹ï¼ŒåŒæ ·çš„ï¼Œ<code>keep-alive</code>ä¸‹æœ‰<code>child1</code>å­ç»„ä»¶ï¼Œæ‰€ä»¥<code>_update</code>è¿‡ç¨‹ä¼šè°ƒç”¨<code>createComponent</code>é€’å½’åˆ›å»ºå­ç»„ä»¶<code>vnode</code>,è¿™ä¸ªè¿‡ç¨‹åœ¨åˆæ¬¡æ¸²æŸ“æ—¶ä¹Ÿæœ‰åˆ†æè¿‡ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸€ä¸‹ï¼Œå†æ¬¡æ¸²æŸ“æ—¶æµç¨‹æœ‰å“ªäº›ä¸åŒã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createComponent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> insertedVnodeQueue</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> parentElm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> refElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// vnodeä¸ºç¼“å­˜çš„vnode</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// æ­¤æ—¶isReactivatedä¸ºtrue</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> isReactivated </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keepAlive</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hook</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">init</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">i</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* hydrating */</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// å…¶ä¸­ä¸€ä¸ªä½œç”¨æ˜¯ä¿ç•™çœŸå®domåˆ°vnodeä¸­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">initComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentElm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">elm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> refElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isTrue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isReactivated</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">reactivateComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> parentElm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> refElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>æ­¤æ—¶çš„<code>vnode</code>æ˜¯ç¼“å­˜å–å‡ºçš„å­ç»„ä»¶<code>vnode</code></strong>ï¼Œå¹¶ä¸”ç”±äºåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶å¯¹ç»„ä»¶è¿›è¡Œäº†æ ‡è®°<code>vnode.data.keepAlive = true;</code>,æ‰€ä»¥<code>isReactivated</code>çš„å€¼ä¸º<code>true</code>,<code>i.init</code>ä¾æ—§ä¼šæ‰§è¡Œå­ç»„ä»¶çš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚ä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹ç”±äºæœ‰ç¼“å­˜ï¼Œæ‰€ä»¥æ‰§è¡Œè¿‡ç¨‹ä¹Ÿä¸å®Œå…¨ç›¸åŒã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> componentVNodeHooks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">init</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> hydrating</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_isDestroyed</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keepAlive</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// å½“æœ‰keepAliveæ ‡å¿—æ—¶ï¼Œæ‰§è¡Œprepatché’©å­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> mountedNode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// work around flow</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        componentVNodeHooks</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">prepatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mountedNode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mountedNode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> child </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createComponentInstanceForVnode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          activeInstance</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        child</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$mount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hydrating </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">elm</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hydrating</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ˜¾ç„¶å› ä¸ºæœ‰<code>keepAlive</code>çš„æ ‡å¿—ï¼Œæ‰€ä»¥å­ç»„ä»¶ä¸å†èµ°æŒ‚è½½æµç¨‹ï¼Œåªæ˜¯æ‰§è¡Œ<code>prepatch</code>é’©å­å¯¹ç»„ä»¶çŠ¶æ€è¿›è¡Œæ›´æ–°ã€‚å¹¶ä¸”å¾ˆå¥½çš„åˆ©ç”¨äº†ç¼“å­˜<code>vnode</code>ä¹‹å‰ä¿ç•™çš„çœŸå®èŠ‚ç‚¹è¿›è¡ŒèŠ‚ç‚¹çš„æ›¿æ¢ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="137-ç”Ÿå‘½å‘¨æœŸ"></a>13.7 ç”Ÿå‘½å‘¨æœŸ<a class="hash-link" href="#137-ç”Ÿå‘½å‘¨æœŸ" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬é€šè¿‡ä¾‹å­æ¥è§‚å¯Ÿ<code>keep-alive</code>ç”Ÿå‘½å‘¨æœŸå’Œæ™®é€šç»„ä»¶çš„ä¸åŒã€‚</p><p><img src="/In-depth-analysis-of-Vue/assets/images/13.4-5477ab10751a5c0f81212980398ce6b9.gif"></p><p>åœ¨æˆ‘ä»¬ä»<code>child1</code>åˆ‡æ¢åˆ°<code>child2</code>,å†åˆ‡å›<code>child1</code>è¿‡ç¨‹ä¸­ï¼Œ<code>chil1</code>ä¸ä¼šå†æ‰§è¡Œ<code>mounted</code>é’©å­ï¼Œåªä¼šæ‰§è¡Œ<code>activated</code>é’©å­ï¼Œè€Œ<code>child2</code>ä¹Ÿä¸ä¼šæ‰§è¡Œ<code>destoryed</code>é’©å­ï¼Œåªä¼šæ‰§è¡Œ<code>deactivated</code>é’©å­ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ<code>child2</code>çš„<code>deactivated</code>é’©å­åˆè¦æ¯”<code>child1</code>çš„<code>activated</code>æå‰æ‰§è¡Œï¼Œè¿™åˆæ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1371-deactivated"></a>13.7.1 deactivated<a class="hash-link" href="#1371-deactivated" title="Direct link to heading">#</a></h3><p>æˆ‘ä»¬å…ˆä»ç»„ä»¶çš„é”€æ¯å¼€å§‹è¯´èµ·ï¼Œå½“<code>child1</code>åˆ‡æ¢åˆ°<code>child2</code>æ—¶ï¼Œ<code>child1</code>ä¼šæ‰§è¡Œ<code>deactivated</code>é’©å­è€Œä¸æ˜¯<code>destoryed</code>é’©å­ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ
å‰é¢åˆ†æ<code>patch</code>è¿‡ç¨‹ä¼šå¯¹æ–°æ—§èŠ‚ç‚¹çš„æ”¹å˜è¿›è¡Œå¯¹æ¯”ï¼Œä»è€Œå°½å¯èƒ½èŒƒå›´å°çš„å»æ“ä½œçœŸå®èŠ‚ç‚¹ï¼Œå½“å®Œæˆ<code>diff</code>ç®—æ³•å¹¶å¯¹èŠ‚ç‚¹æ“ä½œå®Œæ¯•åï¼Œæ¥ä¸‹æ¥è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ­¥éª¤æ˜¯<strong>å¯¹æ—§çš„ç»„ä»¶æ‰§è¡Œé”€æ¯ç§»é™¤æ“ä½œ</strong>ã€‚è¿™ä¸€æ­¥çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">patch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">Â·Â·Â·</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// åˆ†æè¿‡çš„patchVnodeè¿‡ç¨‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// é”€æ¯æ—§èŠ‚ç‚¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">removeVnodes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentElm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">oldVnode</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oldVnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">invokeDestroyHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oldVnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">removeVnodes</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">parentElm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> vnodes</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> startIdx</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> endIdx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// startIdx,endIdxéƒ½ä¸º0</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> startIdx </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> endIdx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">++</span><span class="token plain">startIdx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ch ä¼šæ‹¿åˆ°éœ€è¦é”€æ¯çš„ç»„ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ch </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnodes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">startIdx</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// çœŸå®èŠ‚ç‚¹çš„ç§»é™¤æ“ä½œ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">removeAndInvokeRemoveHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">invokeDestroyHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Text node</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">removeNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">elm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>removeAndInvokeRemoveHook</code>ä¼šå¯¹æ—§çš„èŠ‚ç‚¹è¿›è¡Œç§»é™¤æ“ä½œï¼Œå…¶ä¸­å…³é”®çš„ä¸€æ­¥æ˜¯ä¼šå°†çœŸå®èŠ‚ç‚¹ä»çˆ¶å…ƒç´ ä¸­åˆ é™¤ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹è¿™éƒ¨åˆ†é€»è¾‘ã€‚<code>invokeDestroyHook</code>æ˜¯æ‰§è¡Œé”€æ¯ç»„ä»¶é’©å­çš„æ ¸å¿ƒã€‚å¦‚æœè¯¥ç»„ä»¶ä¸‹å­˜åœ¨å­ç»„ä»¶ï¼Œä¼šé€’å½’å»è°ƒç”¨<code>invokeDestroyHook</code>æ‰§è¡Œé”€æ¯æ“ä½œã€‚é”€æ¯è¿‡ç¨‹ä¼šæ‰§è¡Œç»„ä»¶å†…éƒ¨çš„<code>destory</code>é’©å­ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invokeDestroyHook</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hook</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">destroy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">i</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰§è¡Œç»„ä»¶å†…éƒ¨destroyé’©å­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> cbs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">destroy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">++</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> cbs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">destroy</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// å¦‚æœç»„ä»¶å­˜åœ¨å­ç»„ä»¶ï¼Œåˆ™éå†å­ç»„ä»¶å»é€’å½’è°ƒç”¨invokeDestoryHookæ‰§è¡Œé’©å­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">children</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">children</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">++</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">invokeDestroyHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">children</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç»„ä»¶å†…éƒ¨é’©å­å‰é¢å·²ç»ä»‹ç»äº†<code>init</code>å’Œ<code>prepatch</code>é’©å­ï¼Œè€Œ<code>destroy</code>é’©å­çš„é€»è¾‘æ›´åŠ ç®€å•ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> componentVNodeHooks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">destroy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">destroy</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ç»„ä»¶å®ä¾‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> componentInstance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// å¦‚æœå®ä¾‹è¿˜æœªè¢«é”€æ¯</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">componentInstance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_isDestroyed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ä¸æ˜¯keep-aliveç»„ä»¶åˆ™æ‰§è¡Œé”€æ¯æ“ä½œ</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keepAlive</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        componentInstance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$destroy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// å¦‚æœæ˜¯å·²ç»ç¼“å­˜çš„ç»„ä»¶</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">deactivateChildComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentInstance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* direct */</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å½“ç»„ä»¶æ˜¯<code>keep-alive</code>ç¼“å­˜è¿‡çš„ç»„ä»¶ï¼Œå³å·²ç»ç”¨<code>keepAlive</code>æ ‡è®°è¿‡ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œå®ä¾‹çš„é”€æ¯ï¼Œå³<code>componentInstance.$destroy()</code>çš„è¿‡ç¨‹ã€‚<code>$destroy</code>è¿‡ç¨‹ä¼šåšä¸€ç³»åˆ—çš„ç»„ä»¶é”€æ¯æ“ä½œï¼Œå…¶ä¸­çš„<code>beforeDestroy,destoryed</code>é’©å­ä¹Ÿæ˜¯åœ¨<code>$destory</code>è¿‡ç¨‹ä¸­è°ƒç”¨ï¼Œè€Œ<code>deactivateChildComponent</code>çš„å¤„ç†è¿‡ç¨‹å´å®Œå…¨ä¸åŒã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">deactivateChildComponent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> direct</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direct</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_directInactive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isInInactiveTree</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_inactive</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// å·²ç»è¢«åœç”¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_inactive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// å¯¹å­ç»„ä»¶åŒæ ·ä¼šæ‰§è¡Œåœç”¨å¤„ç†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$children</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">deactivateChildComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$children</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æœ€ç»ˆè°ƒç”¨deactivatedé’©å­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">callHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;deactivated&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>_directInactive</code>æ˜¯ç”¨æ¥æ ‡è®°è¿™ä¸ªè¢«æ‰“ä¸Šåœç”¨æ ‡ç­¾çš„ç»„ä»¶æ˜¯å¦æ˜¯æœ€é¡¶å±‚çš„ç»„ä»¶ã€‚è€Œ<code>_inactive</code>æ˜¯åœç”¨çš„æ ‡å¿—ï¼ŒåŒæ ·çš„å­ç»„ä»¶ä¹Ÿéœ€è¦é€’å½’å»è°ƒç”¨<code>deactivateChildComponent</code>,æ‰“ä¸Šåœç”¨çš„æ ‡è®°ã€‚<strong>æœ€ç»ˆä¼šæ‰§è¡Œç”¨æˆ·å®šä¹‰çš„<code>deactivated</code>é’©å­ã€‚</strong></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="1372-activated"></a>13.7.2 activated<a class="hash-link" href="#1372-activated" title="Direct link to heading">#</a></h3><p>ç°åœ¨å›è¿‡å¤´çœ‹çœ‹<code>activated</code>çš„æ‰§è¡Œæ—¶æœºï¼ŒåŒæ ·æ˜¯<code>patch</code>è¿‡ç¨‹ï¼Œåœ¨å¯¹æ—§èŠ‚ç‚¹ç§»é™¤å¹¶æ‰§è¡Œé”€æ¯æˆ–è€…åœç”¨çš„é’©å­åï¼Œå¯¹æ–°èŠ‚ç‚¹ä¹Ÿä¼šæ‰§è¡Œç›¸åº”çš„é’©å­ã€‚<strong>è¿™ä¹Ÿæ˜¯åœç”¨çš„é’©å­æ¯”å¯ç”¨çš„é’©å­å…ˆæ‰§è¡Œçš„åŸå› ã€‚</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">patch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">Â·Â·Â·</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// patchVnodeè¿‡ç¨‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// é”€æ¯æ—§èŠ‚ç‚¹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentElm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">removeVnodes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentElm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">oldVnode</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oldVnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">invokeDestroyHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oldVnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰§è¡Œç»„ä»¶å†…éƒ¨çš„inserté’©å­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">invokeInsertHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> insertedVnodeQueue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> isInitialPatch</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invokeInsertHook</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> queue</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> initial</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// delay insert hooks for component root nodes, invoke them after the</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å½“èŠ‚ç‚¹å·²ç»è¢«æ’å…¥æ—¶ï¼Œä¼šå»¶è¿Ÿæ‰§è¡Œinserté’©å­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isTrue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initial</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isDef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">parent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">parent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pendingInsert</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">++</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      queue</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hook</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">queue</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>åŒæ ·çš„ç»„ä»¶å†…éƒ¨çš„<code>insert</code>é’©å­é€»è¾‘å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ç»„ä»¶å†…éƒ¨è‡ªå¸¦é’©å­</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> componentVNodeHooks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">insert</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">insert</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> context </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">context</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> componentInstance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// å®ä¾‹å·²ç»è¢«æŒ‚è½½</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">componentInstance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_isMounted</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        componentInstance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_isMounted</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">callHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentInstance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;mounted&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keepAlive</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_isMounted</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// vue-router#1212</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// During updates, a kept-alive component&#x27;s child components may</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// change, so directly walking the tree here may call activated hooks</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// on incorrect children. Instead we push them into a queue which will</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// be processed after the whole patch process ended.</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">queueActivatedComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentInstance</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token function" style="color:#d73a49">activateChildComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">componentInstance</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* direct */</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å½“ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–ç»„ä»¶æ—¶ï¼Œç”±äºå®ä¾‹çš„<code>_isMounted</code>ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨<code>mounted</code>é’©å­ï¼Œå½“æˆ‘ä»¬ä»<code>child2</code>å†æ¬¡åˆ‡å›<code>child1</code>æ—¶ï¼Œç”±äº<code>child1</code>åªæ˜¯è¢«åœç”¨è€Œæ²¡æœ‰è¢«é”€æ¯ï¼Œæ‰€ä»¥ä¸ä¼šå†è°ƒç”¨<code>mounted</code>é’©å­ï¼Œæ­¤æ—¶ä¼šæ‰§è¡Œ<code>activateChildComponent</code>å‡½æ•°å¯¹ç»„ä»¶çš„çŠ¶æ€è¿›è¡Œå¤„ç†ã€‚æœ‰äº†åˆ†æ<code>deactivateChildComponent</code>çš„åŸºç¡€ï¼Œ<code>activateChildComponent</code>çš„é€»è¾‘ä¹Ÿå¾ˆå¥½ç†è§£ï¼ŒåŒæ ·çš„<code>_inactive</code>æ ‡è®°ä¸ºå·²å¯ç”¨ï¼Œå¹¶ä¸”å¯¹å­ç»„ä»¶é€’å½’è°ƒç”¨<code>activateChildComponent</code>åšçŠ¶æ€å¤„ç†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">activateChildComponent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">vm</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> direct</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direct</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_directInactive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isInInactiveTree</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_directInactive</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_inactive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_inactive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_inactive</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$children</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">activateChildComponent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">$children</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">callHook</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;activated&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="138-ç¼“å­˜ä¼˜åŒ–---lru"></a>13.8 ç¼“å­˜ä¼˜åŒ– - LRU<a class="hash-link" href="#138-ç¼“å­˜ä¼˜åŒ–---lru" title="Direct link to heading">#</a></h2><p>ç¨‹åºçš„å†…å­˜ç©ºé—´æ˜¯æœ‰é™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•æ— èŠ‚åˆ¶çš„å¯¹æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ—¶å€™éœ€è¦æœ‰ç­–ç•¥å»æ·˜æ±°ä¸é‚£ä¹ˆé‡è¦çš„æ•°æ®ï¼Œä¿æŒæœ€å¤§æ•°æ®å­˜å‚¨é‡çš„ä¸€è‡´ã€‚è¿™ç§ç±»å‹çš„ç­–ç•¥ç§°ä¸ºç¼“å­˜ä¼˜åŒ–ç­–ç•¥ï¼Œæ ¹æ®æ·˜æ±°çš„æœºåˆ¶ä¸åŒï¼Œå¸¸ç”¨çš„æœ‰ä»¥ä¸‹ä¸‰ç±»ã€‚</p><p><strong>1.FIFOï¼š å…ˆè¿›å…ˆå‡ºç­–ç•¥ï¼Œæˆ‘ä»¬é€šè¿‡è®°å½•æ•°æ®ä½¿ç”¨çš„æ—¶é—´ï¼Œå½“ç¼“å­˜å¤§å°å³å°†æº¢å‡ºæ—¶ï¼Œä¼˜å…ˆæ¸…é™¤ç¦»å½“å‰æ—¶é—´æœ€è¿œçš„æ•°æ®ã€‚</strong></p><p><strong>2.LRUï¼š æœ€è¿‘æœ€å°‘ä½¿ç”¨ã€‚LRUç­–ç•¥éµå¾ªçš„åŸåˆ™æ˜¯ï¼Œå¦‚æœæ•°æ®æœ€è¿‘è¢«è®¿é—®(ä½¿ç”¨)è¿‡ï¼Œé‚£ä¹ˆå°†æ¥è¢«è®¿é—®çš„å‡ ç‡ä¼šæ›´é«˜ï¼Œå¦‚æœä»¥ä¸€ä¸ªæ•°ç»„å»è®°å½•æ•°æ®ï¼Œå½“æœ‰ä¸€æ•°æ®è¢«è®¿é—®æ—¶ï¼Œè¯¥æ•°æ®ä¼šè¢«ç§»åŠ¨åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œè¡¨æ˜æœ€è¿‘è¢«ä½¿ç”¨è¿‡ï¼Œå½“ç¼“å­˜æº¢å‡ºæ—¶ï¼Œä¼šåˆ é™¤æ•°ç»„çš„å¤´éƒ¨æ•°æ®ï¼Œå³å°†æœ€ä¸é¢‘ç¹ä½¿ç”¨çš„æ•°æ®ç§»é™¤ã€‚</strong></p><p><strong>3.LFU: è®¡æ•°æœ€å°‘ç­–ç•¥ã€‚ç”¨æ¬¡æ•°å»æ ‡è®°æ•°æ®ä½¿ç”¨é¢‘ç‡ï¼Œæ¬¡æ•°æœ€å°‘çš„ä¼šåœ¨ç¼“å­˜æº¢å‡ºæ—¶è¢«æ·˜æ±°ã€‚</strong></p><p>è¿™ä¸‰ç§ç¼“å­˜ç®—æ³•å„æœ‰ä¼˜åŠ£ï¼Œå„è‡ªé€‚ç”¨ä¸åŒåœºæ™¯ï¼Œè€Œæˆ‘ä»¬çœ‹<code>keep-alive</code>åœ¨ç¼“å­˜æ—¶çš„ä¼˜åŒ–å¤„ç†ï¼Œå¾ˆæ˜æ˜¾åˆ©ç”¨äº†<code>LRU</code>çš„ç¼“å­˜ç­–ç•¥ã€‚æˆ‘ä»¬çœ‹å…³é”®çš„ä»£ç </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> keepAlive </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">render</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Â·Â·Â·</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      vnode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">componentInstance</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vnode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">max</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pruneCacheEntry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cache</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_vnode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">remove</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">arr</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> arr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">indexOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> arr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">splice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç»“åˆä¸€ä¸ªå®é™…çš„ä¾‹å­åˆ†æç¼“å­˜é€»è¾‘çš„å®ç°ã€‚
1.æœ‰ä¸‰ä¸ªç»„ä»¶<code>child1,child2,child3</code>,<code>keep-alive</code>çš„æœ€å¤§ç¼“å­˜ä¸ªæ•°è®¾ç½®ä¸º2
2.ç”¨<code>cache</code>å¯¹è±¡å»å­˜å‚¨ç»„ä»¶<code>vnode</code>,<code>key</code>ä¸ºç»„ä»¶åå­—ï¼Œ<code>value</code>ä¸ºç»„ä»¶<code>vnode</code>å¯¹è±¡ï¼Œç”¨<code>keys</code>æ•°ç»„å»è®°å½•ç»„ä»¶åå­—ï¼Œç”±äºæ˜¯æ•°ç»„ï¼Œæ‰€ä»¥<code>keys</code>ä¸ºæœ‰åºã€‚
3.<code>child1,child2</code>ç»„ä»¶ä¾æ¬¡è®¿é—®ï¼Œç¼“å­˜ç»“æœä¸º</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;child1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;child2&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">cache </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  child1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> child1Vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  child2</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> child2Vnode</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>4.å†æ¬¡è®¿é—®åˆ°<code>child1</code>ç»„ä»¶ï¼Œç”±äºå‘½ä¸­äº†ç¼“å­˜ï¼Œä¼šè°ƒç”¨<code>remove</code>æ–¹æ³•æŠŠ<code>keys</code>ä¸­çš„<code>child1</code>åˆ é™¤ï¼Œå¹¶é€šè¿‡æ•°ç»„çš„<code>push</code>æ–¹æ³•å°†<code>child1</code>æ¨åˆ°å°¾éƒ¨ã€‚ç¼“å­˜ç»“æœä¿®æ”¹ä¸º</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;child2&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;child1&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">cache </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  child1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> child1Vnode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  child2</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> child2Vnode</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>5.è®¿é—®åˆ°<code>child3</code>æ—¶ï¼Œç”±äºç¼“å­˜ä¸ªæ•°é™åˆ¶ï¼Œåˆæ¬¡ç¼“å­˜ä¼šæ‰§è¡Œ<code>pruneCacheEntry</code>æ–¹æ³•å¯¹æœ€å°‘è®¿é—®åˆ°çš„æ•°æ®è¿›è¡Œåˆ é™¤ã€‚<code>pruneCacheEntry</code>çš„å®šä¹‰å¦‚ä¸‹</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pruneCacheEntry</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">cache</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">key</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">keys</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter">current</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cached###</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// é”€æ¯å®ä¾‹</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cached###</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">current </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> cached###</span><span class="token number" style="color:#36acaa">1.</span><span class="token plain">tag </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> current</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      cached###</span><span class="token number" style="color:#36acaa">1.</span><span class="token plain">componentInstance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">$destroy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    cache</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>åˆ é™¤ç¼“å­˜æ—¶ä¼šæŠŠ<code>keys[0]</code>ä»£è¡¨çš„ç»„ä»¶åˆ é™¤ï¼Œç”±äºä¹‹å‰çš„å¤„ç†ï¼Œæœ€è¿‘è¢«è®¿é—®åˆ°çš„å…ƒç´ ä¼šä½äºæ•°ç»„çš„å°¾éƒ¨ï¼Œæ‰€ä»¥å¤´éƒ¨çš„æ•°æ®å¾€å¾€æ˜¯æœ€å°‘è®¿é—®çš„ï¼Œå› æ­¤ä¼šä¼˜å…ˆåˆ é™¤å¤´éƒ¨çš„å…ƒç´ ã€‚å¹¶ä¸”ä¼šå†æ¬¡è°ƒç”¨<code>remove</code>æ–¹æ³•ï¼Œå°†<code>keys</code>çš„é¦–ä¸ªå…ƒç´ åˆ é™¤ã€‚</p><p>è¿™å°±æ˜¯<code>vue</code>ä¸­å¯¹<code>keep-alive</code>ç¼“å­˜å¤„ç†çš„ä¼˜åŒ–è¿‡ç¨‹ã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated on <b><time datetime="2021-09-17T09:39:01.000Z">9/17/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/In-depth-analysis-of-Vue/å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« å½»åº•ææ‡‚Vueä¸­keep-aliveçš„é­”æ³•-ä¸Š</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#135-å‡†å¤‡å·¥ä½œ" class="table-of-contents__link">13.5 å‡†å¤‡å·¥ä½œ</a><ul><li><a href="#1351-åŸºç¡€ä½¿ç”¨" class="table-of-contents__link">13.5.1 åŸºç¡€ä½¿ç”¨</a></li><li><a href="#1352-æµç¨‹å›¾" class="table-of-contents__link">13.5.2 æµç¨‹å›¾</a></li></ul></li><li><a href="#136-æµç¨‹åˆ†æ" class="table-of-contents__link">13.6 æµç¨‹åˆ†æ</a><ul><li><a href="#1361-é‡æ–°æ¸²æŸ“ç»„ä»¶" class="table-of-contents__link">13.6.1 é‡æ–°æ¸²æŸ“ç»„ä»¶</a></li><li><a href="#1362-é‡ç”¨ç¼“å­˜ç»„ä»¶" class="table-of-contents__link">13.6.2 é‡ç”¨ç¼“å­˜ç»„ä»¶</a></li><li><a href="#1363-çœŸå®èŠ‚ç‚¹çš„æ›¿æ¢" class="table-of-contents__link">13.6.3 çœŸå®èŠ‚ç‚¹çš„æ›¿æ¢</a></li></ul></li><li><a href="#137-ç”Ÿå‘½å‘¨æœŸ" class="table-of-contents__link">13.7 ç”Ÿå‘½å‘¨æœŸ</a><ul><li><a href="#1371-deactivated" class="table-of-contents__link">13.7.1 deactivated</a></li><li><a href="#1372-activated" class="table-of-contents__link">13.7.2 activated</a></li></ul></li><li><a href="#138-ç¼“å­˜ä¼˜åŒ–---lru" class="table-of-contents__link">13.8 ç¼“å­˜ä¼˜åŒ– - LRU</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021, Power By <a href="https://www.docusaurus.cn/">Docusaurus</a>.</div></div></div></footer></div>
<script src="/In-depth-analysis-of-Vue/assets/js/runtime~main.df0025c9.js"></script>
<script src="/In-depth-analysis-of-Vue/assets/js/main.fe9c40e7.js"></script>
</body>
</html>